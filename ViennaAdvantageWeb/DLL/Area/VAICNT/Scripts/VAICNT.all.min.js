VAICNT = window.VAICNT || {}, function (n, t) { n.InventoryCount = function () { function we() { ft = []; gr = function () { ft[0] = l.keyboard().getkeyboard() }; et = []; nu = function () { et[0] = s.keyboard().getkeyboard() } } function be() { ci = t('<div class="vaicnt-inventory-main-wrap"><\/div>'); at = t('<div class="vaicnt-inventory-content-wrap"><\/div>'); li = t('<div class="vaicnt-inventory-inner-space"><\/div>'); ai = t('<div class="vaicnt-inventory-step1"><\/div>'); rr = t('<div class="vaicnt-inventory-step1-data"><\/div>'); vt = t('<div class="vaicnt-inventory-fields"><\/div>'); vi = t('<div class="vaicnt-inventory-field-data"><\/div>'); gt = t('<div class="vaicnt-inventory-field-data"><\/div>'); ni = t('<div class="vaicnt-inventory-field-data"><\/div>'); ur = t('<div class="vaicnt-inventory-step1-btn"><\/div>'); fr = t('<span class="vaicnt-scanner-icon"><\/span>'); dr = t("<p>Step: 1 of 2<\/p>"); br = t("<label>" + VIS.Msg.getMsg("VAICNT_TransactionType") + " <\/label>"); i = t('<select tabindex="0"><select>'); i.append(vr); vi.append(br); vi.append(i); it = t("<label>" + VIS.Msg.getMsg("VAICNT_ReferenceNo") + " <\/label>"); s = t('<input tabindex="1" type="text" maxlength="22" ><\/input>'); yt = t('<span class="vaicnt-key-pan-icon-ref"><\/span>'); gt.append(it); gt.append(s); gt.append(yt); kr = t("<label>" + VIS.Msg.getMsg("VAICNT_ScanName") + " <\/label>"); l = t('<input tabindex="2" type="text" maxlength="50"><\/input>'); yi = t('<span class="vaicnt-key-pan-icon-name"><\/span>'); ni.append(kr); ni.append(l); ni.append(yi); ut = t('<button tabindex="3" class="vaicnt-inventory-btn next-btn">' + VIS.Msg.getMsg("VAICNT_Next") + "<\/button>"); ur.append(ut); vt.append(vi); vt.append(gt); vt.append(ni); vt.append(ur); rr.append(vt); ai.append(dr); ai.append(rr); li.append(fr); li.append(ai); at.append(li); ci.append(at); ir.append(ci) } function ke() { ru = t('<span class="vaicnt-scanner-icon"><\/span>'); hr = t('<div class="vaicnt-inventory-step2-top">'); iu = t("<p>Step: 2 of 2<\/p>"); hr.append(iu); st = t('<div class="vaicnt-inventory-content-wrap2"><\/div>'); pi = t('<div class="vaicnt-inventory-inner-space"><\/div>'); wi = t('<div class="vaicnt-inventory-step2"><\/div>'); pt = t('<div class="vaicnt-inventory-step2-data"><\/div>'); ri = t('<div class="vaicnt-inventory-step2-labels"><\/div>'); fi = t('<div class="vaicnt-inventory-step2-button"><\/div>'); ui = t('<div class="vaicnt-inventory-fields"><\/div>'); ei = t('<div class="vaicnt-inventory-step2-btn">'); bi = t('<div class="vaicnt-inventory-step2-bottom"><\/div>'); pf = t('<div class="vaicnt-inventory-bottom-field"><\/div>'); er = t('<div class="vaicnt-inventory-table-wrap">'); bt = t('<div class="vaicnt-inventory-field-data2"><\/div>'); wf = t('<div class="vaicnt-divfield" style="margin-right:10px"><\/div>'); bf = t('<div class="vaicnt-divfield"><\/div>'); kf = t('<div class="vaicnt-inventory-field-data2"><\/div>'); v = t('<div class="vaicnt-inventory-field-data2"><\/div>'); ki = t('<div class="vaicnt-inventory-bottom-field"><\/div>'); oi = i.val() != "-1" ? t('<p class="vaicnt-inventory-transaction">' + VIS.Msg.getMsg("VAICNT_TransactionType") + ": <span>" + i.find("option:selected").text() + "<\/span><\/p>") : t('<p class="vaicnt-inventory-transaction">' + VIS.Msg.getMsg("VAICNT_TransactionType") + ": <span><\/span><\/p>"); var r = null; r = i.val() == "CR" ? VIS.Msg.getMsg("VAICNT_CustomerRMA") : i.val() == "IM" ? VIS.Msg.getMsg("VAICNT_ReferenceNo") : i.val() == "IU" ? VIS.Msg.getMsg("VAICNT_ReferenceNo") : i.val() == "MR" ? VIS.Msg.getMsg("VAICNT_PurchaseOrder") : i.val() == "PI" ? VIS.Msg.getMsg("VAICNT_LocatorCode") : i.val() == "SH" ? VIS.Msg.getMsg("VAICNT_SalesOrder") : i.val() == "VR" ? VIS.Msg.getMsg("VAICNT_VendorRMA") : VIS.Msg.getMsg("VAICNT_ReferenceNo"); or = t('<p class="vaicnt-inventory-ref">' + r + ": <span>" + s.val() + "<\/span><\/p>"); sr = t('<p class="vaicnt-inventory-scan">' + VIS.Msg.getMsg("VAICNT_ScanName") + ": <span>" + l.val() + "<\/span><\/p>"); ri.append(oi); ri.append(or); ri.append(sr); kt = t("<p>" + VIS.Msg.getMsg("VAICNT_ScanNo") + " <\/p>"); n = t('<input type="text" maxlength="50"><\/input>'); cr = t('<span class="vaicnt-key-pan-icon-scan"><\/span>'); bt.append(kt); bt.append(n); bt.append(cr); sf = t("<p>" + VIS.Msg.getMsg("VAICNT_ScanAttributeNo") + " <\/p>"); f = t('<input type="text" maxlength="50"><\/input>'); lr = t('<span class="vaicnt-key-pan-icon-att"><\/span>'); v.append(sf); v.append(f); v.append(lr); a = t('<button class="vaicnt-inventory-btn1 add-btn">' + VIS.Msg.getMsg("VAICNT_AddAttribute") + "<\/button>"); h = t('<button class="vaicnt-inventory-btn1 create-btn">' + VIS.Msg.getMsg("VAICNT_CreateNewLines") + "<\/button>"); w = t('<button class="vaicnt-inventory-btn1 scanAtt-btn">' + VIS.Msg.getMsg("VAICNT_ScanWithAttribute") + "<\/button>"); fi.append(a); fi.append(h); fi.append(w); ui.append(bt); ui.append(v); ui.append(fi); k = t('<table class="table-bordered vaicnt-inventory-table"><\/table>'); ht = t('<tr class="vaicnt-inventory-table-head"><\/tr>'); cf = t("<th>" + VIS.Msg.getMsg("VAICNT_ScannedNo") + "<\/th>"); lf = t("<th>" + VIS.Msg.getMsg("VAICNT_AttributeNo") + "<\/th>"); af = t("<th>" + VIS.Msg.getMsg("VAICNT_Qty") + "<\/th>"); vf = t("<th>" + VIS.Msg.getMsg("VAICNT_Action") + "<\/th>"); ht.append(cf); ht.append(lf); ht.append(af); ht.append(vf); k.append(ht); er.append(k); hf = t("<p>" + VIS.Msg.getMsg("VAICNT_ScannedQuantity") + " <\/p>"); g = t('<input  type="text" maxlength="10"><\/input>'); g.attr("disabled", "disabled"); g.val(c); ki.append(hf); ki.append(g); ot = t('<button class="vaicnt-inventory-btn create-btn">' + VIS.Msg.getMsg("VAICNT_Save") + "<\/button>"); di = t('<button class="vaicnt-inventory-btn add-btn">' + VIS.Msg.getMsg("VAICNT_Reset") + "<\/button>"); ar = t('<button class="vaicnt-inventory-btn add-btn">' + VIS.Msg.getMsg("VAICNT_Back") + "<\/button>"); wt = t('<div class="vaicnt-scan-no" style="display: none"><div class="line"><\/div><div class="calculator"> <div id="VAICNT_ScanNo7_' + u.windowNo + '" class="left">7<\/div><div id="VAICNT_ScanNo8_' + u.windowNo + '" class="left">8<\/div><div id="VAICNT_ScanNo9_' + u.windowNo + '" class="left">9<\/div><\/div><div class="calculator"> <div id="VAICNT_ScanNo4_' + u.windowNo + '" class="left">4<\/div>  <div id="VAICNT_ScanNo5_' + u.windowNo + '" class="left">5<\/div>   <div id="VAICNT_ScanNo6_' + u.windowNo + '" class="left">6<\/div> <\/div> <div class="calculator"> <div id="VAICNT_ScanNo1_' + u.windowNo + '" class="left">1<\/div>  <div id="VAICNT_ScanNo2_' + u.windowNo + '" class="left">2<\/div> <div id="VAICNT_ScanNo3_' + u.windowNo + '" class="left">3<\/div> <\/div> <div class="calculator"> <div id="VAICNT_ScanNo00_' + u.windowNo + '" class="left">Enter<\/div> <div id="VAICNT_ScanNo0_' + u.windowNo + '" class="left">0<\/div>  <div id="VAICNT_ScanNoDel_' + u.windowNo + '" class="left">   <img class=".arrow_imgCashCount" src="' + VIS.Application.contextUrl + 'Areas/VAICNT/Images/arrow.png"> <\/div> <\/div>  <\/div>'); rt = t('<div class="vaicnt-scan-no" style="display: none"><div class="line"><\/div><div class="calculator"> <div id="VAICNT_ScanAttributeNo7_' + u.windowNo + '" class="left">7<\/div><div id="VAICNT_ScanAttributeNo8_' + u.windowNo + '" class="left">8<\/div><div id="VAICNT_ScanAttributeNo9" class="left">9<\/div><\/div><div class="calculator"> <div id="VAICNT_ScanAttributeNo4_' + u.windowNo + '" class="left">4<\/div>  <div id="VAICNT_ScanAttributeNo5_' + u.windowNo + '" class="left">5<\/div>   <div id="VAICNT_ScanAttributeNo6_' + u.windowNo + '" class="left">6<\/div> <\/div> <div class="calculator"> <div id="VAICNT_ScanAttributeNo1_' + u.windowNo + '" class="left">1<\/div>  <div id="VAICNT_ScanAttributeNo2_' + u.windowNo + '" class="left">2<\/div> <div id="VAICNT_ScanAttributeNo3_' + u.windowNo + '" class="left">3<\/div> <\/div> <div class="calculator"> <div id="VAICNT_ScanAttributeNo00_' + u.windowNo + '" class="left">Enter<\/div> <div id="VAICNT_ScanAttributeNo0_' + u.windowNo + '" class="left">0<\/div>  <div id="VAICNT_ScanAttributeNoDel_' + u.windowNo + '" class="left">   <img class=".arrow_imgCashCount" src="' + VIS.Application.contextUrl + 'Areas/VAICNT/Images/arrow.png"> <\/div> <\/div>  <\/div>'); ei.append(ar); ei.append(di); ei.append(ot); bi.append(ki); bi.append(ei); pt.append(ri); pt.append(ui); bt.append(wt); v.append(rt); pt.append(er); pt.append(bi); wi.append(hr); wi.append(pt); pi.append(ru); pi.append(wi); st.append(pi); ci.append(st); st.css("display", "none"); v.css("display", "none"); ir.append(ci); y(!1); tt(!1); nt(!1); df && (t(window).height() > t(window).width() ? t(".vaicnt-inventory-table").css("height", "360px") : t(".vaicnt-inventory-table").css("height", "160px")) } function de() { function i(i, u) { if (u.toString() == "Enter") si = !si, si ? (wt.css("display", "block"), t(".vaicnt-key-pan-icon-scan").css("background-image", "url('Areas/VAICNT/Images/key-pan.png')")) : (wt.css("display", "none"), t(".vaicnt-key-pan-icon-scan").css("background-image", "url('Areas/VAICNT/Images/down-keypan.png')"), n.val().trim().length > 0 ? (n.css("background-color", "white"), y(!0), p(!0), tt(!0)) : n.css("background-color", "pink"), o || yr(), lt(), r.length > 0 && nt(!0), b ? (h.text(VIS.Msg.getMsg("VAICNT_Cancel")), y(!1), p(!1)) : h.text(VIS.Msg.getMsg("VAICNT_CreateNewLines")), o ? f.focus() : n.focus()); else if (u == "del") { if (i.val().length > 0) { var e = i.val().toString(); i.val(e.substring(0, e.length - 1)) } } else i.val() != "" ? i.val(i.val() + u) : i.val(u) } uu = t("#VAICNT_ScanNo7_" + u.windowNo + ""); fu = t("#VAICNT_ScanNo8_" + u.windowNo + ""); eu = t("#VAICNT_ScanNo9_" + u.windowNo + ""); ou = t("#VAICNT_ScanNo4_" + u.windowNo + ""); su = t("#VAICNT_ScanNo5_" + u.windowNo + ""); hu = t("#VAICNT_ScanNo6_" + u.windowNo + ""); cu = t("#VAICNT_ScanNo1_" + u.windowNo + ""); lu = t("#VAICNT_ScanNo2_" + u.windowNo + ""); au = t("#VAICNT_ScanNo3_" + u.windowNo + ""); yu = t("#VAICNT_ScanNo00_" + u.windowNo + ""); vu = t("#VAICNT_ScanNo0_" + u.windowNo + ""); pu = t("#VAICNT_ScanNoDel_" + u.windowNo + ""); uu.on("click", function () { i(n, 7) }); fu.on("click", function () { i(n, 8) }); eu.on("click", function () { i(n, 9) }); ou.on("click", function () { i(n, 4) }); su.on("click", function () { i(n, 5) }); hu.on("click", function () { i(n, 6) }); cu.on("click", function () { i(n, 1) }); lu.on("click", function () { i(n, 2) }); au.on("click", function () { i(n, 3) }); vu.on("click", function () { i(n, 0) }); yu.on("click", function () { i(n, "Enter") }); pu.on("click", function () { i(n, "del") }) } function ge() { function i(i, r) { if (r.toString() == "Enter") hi = !hi, hi ? (rt.css("display", "block"), t(".vaicnt-key-pan-icon-att").css("background-image", "url('Areas/VAICNT/Images/key-pan.png')")) : (rt.css("display", "none"), t(".vaicnt-key-pan-icon-att").css("background-image", "url('Areas/VAICNT/Images/down-keypan.png')"), f.val().trim().length > 0 ? (f.css("background-color", "white"), o && pr(), f.val(""), v.css("display", "none"), o = !o, o ? (a.css("display", "none"), v.css("display", "inline-block"), w.text(VIS.Msg.getMsg("VAICNT_Cancel"))) : (a.css("display", "inline-block"), v.css("display", "none"), w.text(VIS.Msg.getMsg("VAICNT_ScanWithAttribute")), n.focus())) : f.css("background-color", "pink"), b ? (h.text(VIS.Msg.getMsg("VAICNT_Cancel")), y(!1), p(!1)) : (h.text(VIS.Msg.getMsg("VAICNT_CreateNewLines")), y(!0), p(!0)), rt.css("display", "none"), t(".vaicnt-key-pan-icon-att").css("background-image", "url('Areas/VAICNT/Images/down-keypan.png')"), f.val("")); else if (r == "del") { if (i.val().length > 0) { var u = i.val().toString(); i.val(u.substring(0, u.length - 1)) } } else i.val() != "" ? i.val(i.val() + r) : i.val(r) } wu = t("#VAICNT_ScanAttributeNo7_" + u.windowNo + ""); bu = t("#VAICNT_ScanAttributeNo8_" + u.windowNo + ""); ku = t("#VAICNT_ScanAttributeNo9_" + u.windowNo + ""); du = t("#VAICNT_ScanAttributeNo4_" + u.windowNo + ""); gu = t("#VAICNT_ScanAttributeNo5_" + u.windowNo + ""); nf = t("#VAICNT_ScanAttributeNo6_" + u.windowNo + ""); tf = t("#VAICNT_ScanAttributeNo1_" + u.windowNo + ""); rf = t("#VAICNT_ScanAttributeNo2_" + u.windowNo + ""); uf = t("#VAICNT_ScanAttributeNo3_" + u.windowNo + ""); ef = t("#VAICNT_ScanAttributeNo00_" + u.windowNo + ""); ff = t("#VAICNT_ScanAttributeNo0_" + u.windowNo + ""); of = t("#VAICNT_ScanAttributeNoDel_" + u.windowNo + ""); wu.on("click", function () { i(f, 7) }); bu.on("click", function () { i(f, 8) }); ku.on("click", function () { i(f, 9) }); du.on("click", function () { i(f, 4) }); gu.on("click", function () { i(f, 5) }); nf.on("click", function () { i(f, 6) }); tf.on("click", function () { i(f, 1) }); rf.on("click", function () { i(f, 2) }); uf.on("click", function () { i(f, 3) }); ff.on("click", function () { i(f, 0) }); ef.on("click", function () { i(f, "Enter") }); of.on("click", function () { i(f, "del") }) } function lt() { l.val().trim().length > 0 ? (l.css("background-color", "white"), (i.val() == "SH" || i.val() == "MR" || i.val() == "CR" || i.val() == "VR" || i.val() == "PI") && s.val().trim().length == 0 ? s.val().trim().length <= 0 && tr(!1) : i.val() == "-1" || i.val() == null ? tr(!1) : tr(!0)) : (l.css("background-color", "pink"), tr(!1)) } function no() { t.ajax({ url: VIS.Application.contextUrl + "VAICNT/InventoryCount/GetTransactionType", type: "GET", dataType: "json", async: !1, success: function (n) { var i = JSON.parse(n), t; for (vr += "<option value='-1'  selected='selected'>" + VIS.Msg.getMsg("VAICNT_SelectTransactionType") + "<\/option>", t = 0; t < i.length; t++) vr += "<option value='" + i[t].Value + "'>" + i[t].Name + "<\/option>" }, error: function (n) { console.log(n) } }) } function dt(n, i, r, u, f) { var e = t('<tr class="vaicnt-inventory-table-row" val=' + i + " index=" + f + "><\/tr>"), h = t('<td class="vaicnt-inventory-td">' + i + "<\/td>"), c = t('<td class="vaicnt-inventory-td">' + r + "<\/td>"), o = t('<td class="vaicnt-inventory-td"><input type="number" min="1"><\/input><\/td>'), s; o.children().val(u); s = t('<td class="vaicnt-action-colstyle"><a><img class="vaicnt-deleterow" src= "' + VIS.Application.contextUrl + 'Areas/VAICNT/Images/del.png"><\/a><\/td>'); e.append(h); e.append(c); e.append(o); e.append(s); e.insertAfter(ht); gi = e } function to() { ut.on("click", function () { if (tu) ke(), io(), de(), ge(), tu = !1; else { i.val() != "-1" ? t(oi).children().text(i.find("option:selected").text()) : t(oi).children().text(""); var r = null; r = i.val() == "CR" ? VIS.Msg.getMsg("VAICNT_CustomerRMA") : i.val() == "IM" ? VIS.Msg.getMsg("VAICNT_ReferenceNo") : i.val() == "IU" ? VIS.Msg.getMsg("VAICNT_ReferenceNo") : i.val() == "MR" ? VIS.Msg.getMsg("VAICNT_PurchaseOrder") : i.val() == "PI" ? VIS.Msg.getMsg("VAICNT_LocatorCode") : i.val() == "SH" ? VIS.Msg.getMsg("VAICNT_SalesOrder") : i.val() == "VR" ? VIS.Msg.getMsg("VAICNT_VendorRMA") : VIS.Msg.getMsg("VAICNT_ReferenceNo"); t(or).text(r + ":" + s.val()); t(sr).children().text(l.val()) } at.css("display", "none"); st.css("display", "block"); n.focus() }); s.on("focus", function () { ii = !1; ft != null && ft.length > 0 && (t(".vaicnt-key-pan-icon-name").css("background-image", "url('Areas/VAICNT/Images/down-keypan.png')"), t(".vaicnt-key-pan-icon-name").css("margin-top", "5px"), ft[0].destroy()); s.css("background-color", "white") }); s.on("blur", function () { (i.val() == "SH" || i.val() == "MR" || i.val() == "CR" || i.val() == "VR" || i.val() == "PI") && s.val().trim().length == 0 && s.css("background-color", "pink"); i.val() != "-1" ? s.val().trim().length > 0 ? l.val(i.find("option:selected").text() + "_" + s.val()) : l.val(i.find("option:selected").text()) : l.val(s.val()); lt() }); s.on("change", function () { }); i.on("change", function () { i.val() == "CR" ? it.text(VIS.Msg.getMsg("VAICNT_CustomerRMA")) : i.val() == "IM" ? it.text(VIS.Msg.getMsg("VAICNT_ReferenceNo")) : i.val() == "IU" ? it.text(VIS.Msg.getMsg("VAICNT_ReferenceNo")) : i.val() == "MR" ? it.text(VIS.Msg.getMsg("VAICNT_PurchaseOrder")) : i.val() == "PI" ? it.text(VIS.Msg.getMsg("VAICNT_LocatorCode")) : i.val() == "SH" ? it.text(VIS.Msg.getMsg("VAICNT_SalesOrder")) : i.val() == "VR" ? it.text(VIS.Msg.getMsg("VAICNT_VendorRMA")) : it.text(VIS.Msg.getMsg("VAICNT_ReferenceNo")); ti = !1; et != null && et.length > 0 && (t(".vaicnt-key-pan-icon-ref").css("background-image", "url('Areas/VAICNT/Images/down-keypan.png')"), t(".vaicnt-key-pan-icon-ref").css("margin-top", "5px"), et[0].destroy()); ii = !1; ft != null && ft.length > 0 && (t(".vaicnt-key-pan-icon-name").css("background-image", "url('Areas/VAICNT/Images/down-keypan.png')"), t(".vaicnt-key-pan-icon-name").css("margin-top", "5px"), ft[0].destroy()); i.val() != "-1" && (s.val().trim().length > 0 ? l.val(i.find("option:selected").text() + "_" + s.val()) : l.val(i.find("option:selected").text())); i.val() == "SH" || i.val() == "MR" || i.val() == "CR" || i.val() == "VR" || i.val() == "PI" ? s.val().trim().length <= 0 && s.css("background-color", "pink") : s.css("background-color", "white"); lt(); s.focus() }); l.on("focus", function () { ti = !1; et != null && et.length > 0 && (t(".vaicnt-key-pan-icon-ref").css("background-image", "url('Areas/VAICNT/Images/down-keypan.png')"), t(".vaicnt-key-pan-icon-ref").css("margin-top", "5px"), et[0].destroy()); l.css("background-color", "white") }); l.on("blur", function () { lt(); ut.focus() }); yi.on("click", function () { if (ii = !ii, ii) { t(".vaicnt-key-pan-icon-name").css("background-image", "url('Areas/VAICNT/Images/key-pan.png')"); t(".vaicnt-key-pan-icon-name").css("margin-top", "0px"); yi.css("opacity", "1"); gr(); l.focus(); return } t(".vaicnt-key-pan-icon-name").css("background-image", "url('Areas/VAICNT/Images/down-keypan.png')"); t(".vaicnt-key-pan-icon-name").css("margin-top", "5px"); ft[0].destroy() }); yt.on("click", function () { if (ti = !ti, ti) { t(".vaicnt-key-pan-icon-ref").css("background-image", "url('Areas/VAICNT/Images/key-pan.png')"); t(".vaicnt-key-pan-icon-ref").css("margin-top", "0px"); yt.css("opacity", "1"); nu(); s.focus(); return } t(".vaicnt-key-pan-icon-ref").css("background-image", "url('Areas/VAICNT/Images/down-keypan.png')"); t(".vaicnt-key-pan-icon-ref").css("margin-top", "5px"); et[0].destroy() }) } function io() { function it() { n.val().trim().length > 0 ? (n.css("background-color", "white"), p(!0), o || (y(!0), tt(!0))) : n.css("background-color", "pink"); o || yr(); o && f.focus(); lt(); r.length > 0 && nt(!0); b ? (h.text(VIS.Msg.getMsg("VAICNT_Cancel")), y(!1), p(!1)) : h.text(VIS.Msg.getMsg("VAICNT_CreateNewLines")); u() } function u() { var n = n, o, u; if (n != null && n.length > 0 && jQuery(n, "input").children().prop("tagName").toLowerCase() == "input") { var s = t(t(e.originalEvent.toElement).parent()).parent(), f = s.attr("index"), i = parseInt(n.children().val()); for (i > 0 ? r[f].Qty = i : (n.children().val(1), i = parseInt(n.children().val()), i > 0 && (r[f].Qty = i)), o = 0, u = 0; u < r.length; u++) o += parseInt(r[u].Qty); c = o; g.val(c); t(n.children()).on("blur", function () { var h = t(t(e.originalEvent.toElement).parent()).parent(), l = h.attr("index"), s = parseInt(n.children().val()), o, u; for (s > 0 ? r[l].Qty = s : (n.children().val(1), i = parseInt(n.children().val()), i > 0 && (r[f].Qty = i)), o = 0, u = 0; u < r.length; u++) o += parseInt(r[u].Qty); c = o; g.val(c) }) } } function ut() { f.val().trim().length > 0 ? (f.css("background-color", "white"), o && pr(), f.val(""), v.css("display", "none"), o ? (a.css("display", "none"), v.css("display", "inline-block"), w.text(VIS.Msg.getMsg("VAICNT_Cancel"))) : (a.css("display", "inline-block"), v.css("display", "none"), w.text(VIS.Msg.getMsg("VAICNT_ScanWithAttribute")), n.focus())) : f.css("background-color", "pink"); b ? (h.text(VIS.Msg.getMsg("VAICNT_Cancel")), y(!1), p(!1)) : (h.text(VIS.Msg.getMsg("VAICNT_CreateNewLines")), tt(!0), y(!0), p(!0)); rt.css("display", "none"); t(".vaicnt-key-pan-icon-att").css("background-image", "url('Areas/VAICNT/Images/down-keypan.png')"); f.val(""); nt(!0) } function d() { n.val(""); tr(!1); f.val(""); t(k.find(t("tr[val]"))).remove(); r = []; g.val(0); c = 0; ct = !1; b = !1; o = !1; v.css("display", "none"); y(!1); a.css("display", "inline-block"); tt(!1); nt(!1); w.text(VIS.Msg.getMsg("VAICNT_ScanWithAttribute")); kt.text(VIS.Msg.getMsg("VAICNT_ScanNo")); a.text(VIS.Msg.getMsg("VAICNT_AddAttribute")); n.focus(); rt.css("display", "none"); t(".vaicnt-key-pan-icon-att").css("background-image", "url('Areas/VAICNT/Images/down-keypan.png')"); wt.css("display", "none"); t(".vaicnt-key-pan-icon-scan").css("background-image", "url('Areas/VAICNT/Images/down-keypan.png')") } ar.on("click", function () { at.css("display", "block"); st.css("display", "none") }); ot.on("click", function () { t.ajax({ url: VIS.Application.contextUrl + "VAICNT/InventoryCount/SaveInventoryCountDetail", type: "POST", dataType: "json", async: !1, data: { transactionType: i.val(), refNo: s.val(), scanName: l.val(), lstScanDetail: JSON.stringify(r) }, success: function (n) { JSON.parse(n) ? (d(), s.val(""), l.val(""), i.val("-1"), at.css("display", "block"), st.css("display", "none")) : alert(VIS.Msg.getMsg("VAICNT_RecordNotSaved")) }, error: function () { } }) }); n.on("focus", function () { }); n.on("keypress", function (n) { if (n.keyCode == 13) { it(); return } if (!(n.keyCode >= 48 && n.keyCode <= 57)) return !1 }); n.on("change", function () { n.val().trim().length > 0 ? (n.css("background-color", "white"), p(!0), o || (y(!0), tt(!0))) : n.css("background-color", "pink"); o || yr(); lt(); r.length > 0 && nt(!0); b ? (h.text(VIS.Msg.getMsg("VAICNT_Cancel")), y(!1), p(!1)) : h.text(VIS.Msg.getMsg("VAICNT_CreateNewLines")); u() }); f.on("focus", function () { }); f.on("keypress", function (n) { if (n.keyCode == 13) { ut(); return } if (!(n.keyCode >= 48 && n.keyCode <= 57)) return !1 }); f.on("change", function () { f.val().trim().length > 0 ? (f.css("background-color", "white"), o && pr(), f.val(""), v.css("display", "none"), o = !o, o ? (a.css("display", "none"), v.css("display", "inline-block"), w.text(VIS.Msg.getMsg("VAICNT_Cancel"))) : (a.css("display", "inline-block"), v.css("display", "none"), w.text(VIS.Msg.getMsg("VAICNT_ScanWithAttribute")), n.focus())) : f.css("background-color", "pink"); b ? (h.text(VIS.Msg.getMsg("VAICNT_Cancel")), y(!1), p(!1)) : (h.text(VIS.Msg.getMsg("VAICNT_CreateNewLines")), tt(!0), y(!0), p(!0)); rt.css("display", "none"); t(".vaicnt-key-pan-icon-att").css("background-image", "url('Areas/VAICNT/Images/down-keypan.png')"); f.val(""); nt(!0) }); a.on("click", function () { nr(); yf() }); k.on("click", function (i) { var u, d, it, s, l, f; if (u = t(i.originalEvent.toElement).parent(), jQuery(u, "a").prop("tagName").toLowerCase() == "a") { for (d = t(t(u).parent()).parent(), it = t(t(t(u).parent()).parent()).attr("index"), f = 0; f < r.length; f++) if (r[f].Index == it) { r.splice(f, 1); break } for (d.remove(), s = 0, f = 0; f < r.length; f++) s += parseInt(r[f].Qty); c = s; g.val(c); u = t(t(k.children()).children()[1]); r.length <= 0 && (g.val(0), c = 0, ct = !1, b = !1, o = !1, v.css("display", "none"), y(!1), p(!1), tt(!1), nt(!1), a.css("display", "inline-block"), w.text(VIS.Msg.getMsg("VAICNT_ScanWithAttribute")), kt.text(VIS.Msg.getMsg("VAICNT_ScanNo")), a.text(VIS.Msg.getMsg("VAICNT_AddAttribute")), n.focus()) } if (u != null && u.length > 0 && jQuery(u, "input").children().prop("tagName").toLowerCase() == "input") { var rt = t(t(i.originalEvent.toElement).parent()).parent(), h = rt.attr("index"), e = parseInt(u.children().val()); for (e > 0 ? r[h].Qty = e : (u.children().val(1), e = parseInt(u.children().val()), e > 0 && (r[h].Qty = e)), l = 0, f = 0; f < r.length; f++) l += parseInt(r[f].Qty); c = l; g.val(c); t(u.children()).on("blur", function () { var s = t(t(i.originalEvent.toElement).parent()).parent(), l = s.attr("index"), o = parseInt(u.children().val()), f, n; for (o > 0 ? r[l].Qty = o : (u.children().val(1), e = parseInt(u.children().val()), e > 0 && (r[h].Qty = e)), f = 0, n = 0; n < r.length; n++) f += parseInt(r[n].Qty); c = f; g.val(c) }) } }); k.on("focus", function () { }); di.on("click", function () { d() }); h.on("click", function () { b = !b; yf(); b ? (h.text(VIS.Msg.getMsg("VAICNT_Cancel")), y(!1), p(!1)) : (h.text(VIS.Msg.getMsg("VAICNT_CreateNewLines")), y(!0), p(!0)); n.val(""); n.focus() }); w.on("click", function () { o = !o; yf(); o ? (a.css("display", "none"), v.css("display", "inline-block"), w.text(VIS.Msg.getMsg("VAICNT_Cancel"))) : (a.css("display", "inline-block"), v.css("display", "none"), w.text(VIS.Msg.getMsg("VAICNT_ScanWithAttribute"))); n.val().trim().length <= 0 && n.css("background-color", "pink"); f.val().trim().length <= 0 && f.css("background-color", "pink"); n.focus() }); cr.on("click", function () { si = !si; si ? (wt.css("display", "block"), t(".vaicnt-key-pan-icon-scan").css("background-image", "url('Areas/VAICNT/Images/key-pan.png')")) : (wt.css("display", "none"), t(".vaicnt-key-pan-icon-scan").css("background-image", "url('Areas/VAICNT/Images/down-keypan.png')"), n.val().trim().length > 0 ? (n.css("background-color", "white"), y(!0), p(!0), tt(!0)) : n.css("background-color", "pink"), o || yr(), lt(), r.length > 0 && nt(!0), b ? (h.text(VIS.Msg.getMsg("VAICNT_Cancel")), y(!1), p(!1)) : h.text(VIS.Msg.getMsg("VAICNT_CreateNewLines"))) }); lr.on("click", function () { hi = !hi; hi ? (rt.css("display", "block"), t(".vaicnt-key-pan-icon-att").css("background-image", "url('Areas/VAICNT/Images/key-pan.png')")) : (rt.css("display", "none"), t(".vaicnt-key-pan-icon-att").css("background-image", "url('Areas/VAICNT/Images/down-keypan.png')"), f.val().trim().length > 0 ? (f.css("background-color", "white"), o && pr(), f.val(""), v.css("display", "none"), o = !o, o ? (a.css("display", "none"), v.css("display", "inline-block"), w.text(VIS.Msg.getMsg("VAICNT_Cancel"))) : (a.css("display", "inline-block"), v.css("display", "none"), w.text(VIS.Msg.getMsg("VAICNT_ScanWithAttribute")), n.focus())) : f.css("background-color", "pink"), b ? (h.text(VIS.Msg.getMsg("VAICNT_Cancel")), y(!1), p(!1)) : (h.text(VIS.Msg.getMsg("VAICNT_CreateNewLines")), y(!0), p(!0)), rt.css("display", "none"), t(".vaicnt-key-pan-icon-att").css("background-image", "url('Areas/VAICNT/Images/down-keypan.png')"), f.val("")) }) } function nr() { ct ? (kt.text(VIS.Msg.getMsg("VAICNT_ScanNo")), a.text(VIS.Msg.getMsg("VAICNT_AddAttribute"))) : (kt.text(VIS.Msg.getMsg("VAICNT_ScanAttributeNo")), a.text(VIS.Msg.getMsg("VAICNT_Cancel"))); ct = !ct; n.val(""); n.focus() } function yr() { var f, e, s; if (n.val().trim().length > 0) { var i = n.val(), o = r.length, u = 1; if (b) { dt(k, i, "", u, o); r.push({ Index: o, ScannedNo: i, AttributeNo: "", Qty: u }); c += 1; g.val(c); d = []; d.push({ ScannedNo: i, AttributeNo: "", Qty: u, isFirstTime: !0 }); b = !b; n.val(""); n.focus(); return } if (ct) { if (f = k.find(t('tr[val="' + d[0].ScannedNo + '"]')), f.length > 0) { for (e = f.length - 1; e >= 0; e--) if (existingScannedNo = t(t(f[e]).find(t("td"))[0]).text(), existingAttributeNo = t(t(f[e]).find(t("td"))[1]).text(), existingScannedNo == d[0].ScannedNo && existingAttributeNo == i) { u += 1; break } if (existingAttributeNo != i && existingAttributeNo != "") { dt(k, d[0].ScannedNo, i, u, o); r.push({ Index: o, ScannedNo: d[0].ScannedNo, AttributeNo: i, Qty: u }); s = d[0].ScannedNo; c += 1; g.val(c); d = []; d.push({ ScannedNo: s, AttributeNo: i, Qty: u, isFirstTime: !0 }); n.val(""); n.focus(); nr(); return } } wr(d[0].ScannedNo, i, 1); nr() } else wr(i, "", 1); n.val(""); n.focus() } } function pr() { var s, h, a; if (n.val().trim().length > 0) { var u = n.val(), i = f.val(), l = r.length, e = 1; if (b) { dt(k, u, i, e, l); r.push({ Index: l, ScannedNo: u, AttributeNo: i, Qty: e }); c += 1; g.val(c); d = []; d.push({ ScannedNo: u, AttributeNo: i, Qty: e, isFirstTime: !0 }); b = !b; n.val(""); n.focus(); return } if (o) wr(u, i, 1); else { if (s = k.find(t('tr[val="' + u + '"]')), s.length > 0) { for (h = s.length - 1; h >= 0; h--) if (existingScannedNo = t(t(s[h]).find(t("td"))[0]).text(), existingAttributeNo = t(t(s[h]).find(t("td"))[1]).text(), existingScannedNo == u && existingAttributeNo == i) { e += 1; break } if (existingAttributeNo != i && existingAttributeNo != "") { dt(k, u, i, e, l); r.push({ Index: l, ScannedNo: u, AttributeNo: i, Qty: e }); a = d[0].ScannedNo; c += 1; g.val(c); d = []; d.push({ ScannedNo: u, AttributeNo: i, Qty: e, isFirstTime: !0 }); n.val(""); n.focus(); nr(); return } } wr("", i, 1); nr() } n.val(""); n.focus() } } function yf() { b ? (h.text(VIS.Msg.getMsg("VAICNT_Cancel")), y(!1), p(!1)) : ct ? (tt(!1), p(!1)) : o ? (tt(!1), y(!1)) : (y(!0), tt(!0), p(!0)) } function wr(i, u, f) { var h, s; if (n.val().trim().length > 0 && (u == "" || u.trim().length == 0)) { var v = r.length, y = "", l = "", p = "", a = !1, w = !0, e = k.find(t('tr[val="' + i + '"]')); if (e.length > 0) { for (a = !0, e = t(e[0]), h = e.length - 1; h >= 0; h--) if (y = t(t(e[h]).find(t("td"))[0]).text(), l = t(t(e[h]).find(t("td"))[1]).text(), y == i && l == u) { w = !1; e = t(e[h]); break } a ? (f == 1 && (f = parseInt(t(t(e).find(t("td"))[2]).children().val()) + 1), t(t(e).find(t("td"))[2]).children().val(f), s = t.grep(r, function (n) { return n.ScannedNo == i }).map(function (n) { return n.Index }), s.length > 1 && (s = t.grep(r, function (n) { return n.ScannedNo == i && n.AttributeNo == u }).map(function (n) { return n.Index }), s.length <= 0 && (s = t.grep(r, function (n) { return n.ScannedNo == i && n.AttributeNo == "" }).map(function (n) { return n.Index })), s.length > 0 && (s = s[s.length - 1])), r[s].Qty = f, gi = e) : (dt(k, i, u, f, v), r.push({ Index: v, ScannedNo: i, AttributeNo: "", Qty: f })) } else dt(k, i, u, f, v), r.push({ Index: v, ScannedNo: i, AttributeNo: "", Qty: f }); c += 1; g.val(c); d = []; d.push({ ScannedNo: i, AttributeNo: u, Qty: f, isFirstTime: !0 }) } else if (n.val().trim().length > 0 && u.trim().length > 0) { var v = r.length, y = "", l = "", p = "", a = !1, e = k.find(t('tr[val="' + i + '"]')); for (h = 0; h < e.length; h++) if (y = t(t(e[h]).find(t("td"))[0]).text(), l = t(t(e[h]).find(t("td"))[1]).text(), o) { if (y == i && l == u) { a = !0; e = t(e[h]); break } } else if (y == i && (l == u || l == "")) { a = !0; e = t(e[h]); break } o || a || (e = gi); a ? e.length > 0 && (a && l != "" && l != "1" && (f = parseInt(t(t(e).find(t("td"))[2]).children().val()) + 1, c += 1, g.val(c)), t(t(e).find(t("td"))[2]).children().val(f), t(t(e).find(t("td"))[1]).text(u), s = t.grep(r, function (n) { return n.ScannedNo == i }).map(function (n) { return n.Index }), s.length > 1 && (s = t.grep(r, function (n) { return n.ScannedNo == i && n.AttributeNo == u }).map(function (n) { return n.Index }), s.length <= 0 && (s = t.grep(r, function (n) { return n.ScannedNo == i && n.AttributeNo == "" }).map(function (n) { return n.Index })), s.length > 0 && (s = s[s.length - 1])), r[s].Qty = f, r[s].AttributeNo = u, gi = e) : (dt(k, i, u, f, v), r.push({ Index: v, ScannedNo: i, AttributeNo: u, Qty: f }), c += 1, g.val(c)); d = []; d.push({ ScannedNo: i, AttributeNo: u, Qty: f, isFirstTime: !1 }) } } function tr(n) { n ? (ut.removeAttr("disabled"), ut.css("background", " #626365")) : (ut.attr("disabled", "disabled"), ut.css("background", "lightgray")) } function y(n) { n ? (a.removeAttr("disabled"), a.css("background", " #626365")) : (a.attr("disabled", "disabled"), a.css("background", "lightgray")) } function tt(n) { n ? (h.removeAttr("disabled"), h.css("background", " #626365")) : (h.attr("disabled", "disabled"), h.css("background", "lightgray")) } function p(n) { n ? (w.removeAttr("disabled"), w.css("background", " #626365")) : (w.attr("disabled", "disabled"), w.css("background", "lightgray")) } function nt(n) { n ? (ot.removeAttr("disabled"), ot.css("background", " #626365")) : (ot.attr("disabled", "disabled"), ot.css("background", "lightgray")) } var u = this, ir = null, at = null, li = null, ai = null, rr = null, vt = null, ur = null, gt = null, ni = null, vi = null, br = null, it = null, kr = null, i = null, s = null, l = null, ut = null, gf = null, dr = null, yt = null, yi = null, ti = !1, ii = !1, fr = null, gr = null, ft = null, nu = null, et = null, tu = !0, st = null, pi = null, wi = null, pt = null, ri = null, ui = null, fi = null, bi = null, ei = null, pf = null, er = null, oi = null, or = null, sr = null, hr = null, iu = null, ru = null, cr = null, lr = null, ar = null, wt = null, rt = null, si = !1, hi = !1, uu = null, fu = null, eu = null, ou = null, su = null, hu = null, cu = null, lu = null, au = null, vu = null, yu = null, pu = null, wu = null, bu = null, ku = null, du = null, gu = null, nf = null, tf = null, rf = null, uf = null, ff = null, ef = null, of = null, ci = null, bt = null, ne = null, te = null, ie = null, v = null, re = null, ue = null, fe = null, ee = null, oe = null, wf = null, bf = null, kf = null, ki = null, kt = null, sf = null, se = null, he = null, ce = null, le = null, hf = null, n = null, f = null, ae = null, ve = null, ye = null, pe = null, g = null, h = null, a = null, w = null, ot = null, di = null, k = null, ht = null, cf = null, lf = null, af = null, vf = null, gi = null, vr = "", r = [], d = [], ct = !1, b = !1, o = !1, c = 0, df = /ipad|iphone|ipod|mobile|android|blackberry|webos|windows phone/i.test(navigator.userAgent.toLowerCase()); this.initialize = function () { no(); be(); lt(); to(); we() }; t(window).on("resize", function () { df && (t(window).height() > t(window).width() ? t(".vaicnt-inventory-table").css("height", "360px") : t(".vaicnt-inventory-table").css("height", "160px")) }); this.getRoot = function () { return ir = t("<div id='mainroot_" + u.windowNo + "' style='overflow:auto;height:100%;background-color:white;'> <\/div>") }; this.disposeComponent = function () { ut.off("click"); s.off("blur"); s.off("focus"); i.off("change"); n.off("change"); f.off("change"); k.off("click"); l.off("focus"); l.off("blur"); ot.off("click"); a.off("click"); w.off("click"); h.off("click"); di.off("click"); a.off("click"); yt; at = null; li = null; ai = null; rr = null; vt = null; ur = null; gt = null; ni = null; vi = null; br = null; it = null; kr = null; i = null; s = null; l = null; ut = null; gf = null; dr = null; yt = null; fr = null; tu = !0; st = null; pi = null; wi = null; pt = null; ri = null; ui = null; fi = null; bi = null; ei = null; pf = null; er = null; oi = null; or = null; sr = null; hr = null; iu = null; ru = null; cr = null; lr = null; ar = null; ci = null; bt = null; ne = null; te = null; ie = null; v = null; re = null; ue = null; fe = null; ee = null; oe = null; wf = null; bf = null; kf = null; ki = null; kt = null; sf = null; se = null; he = null; ce = null; le = null; hf = null; n = null; f = null; ae = null; ve = null; ye = null; pe = null; g = null; h = null; a = null; w = null; ot = null; di = null; k = null; ht = null; cf = null; lf = null; af = null; vf = null; gi = null; vr = ""; r = []; d = []; ct = !1; b = !1; o = !1; yt = null; yi = null; ti = !1; ii = !1; fr = null; gr = null; ft = null; nu = null; et = null; c = 0; uu = null; fu = null; eu = null; ou = null; su = null; hu = null; cu = null; lu = null; au = null; vu = null; yu = null; pu = null; wu = null; bu = null; ku = null; du = null; gu = null; nf = null; tf = null; rf = null; uf = null; ff = null; ef = null; of = null } }; n.InventoryCount.prototype.init = function (n, t) { this.frame = t; this.windowNo = n; this.frame.getContentGrid().append(this.getRoot()); this.initialize() }; n.InventoryCount.prototype.dispose = function () { this.disposeComponent(); this.frame && this.frame.dispose(); this.frame = null } }(VAICNT, jQuery), function (n) { "use strict"; n.keyboard = function (t, i) { var r = this, u; r.version = "1.18.12"; r.$el = n(t); r.el = t; r.$el.data("keyboard", r); r.init = function () { r.options = u = n.extend(!0, {}, n.keyboard.defaultOptions, i); r.shiftActive = r.altActive = r.metaActive = r.sets = r.capsLock = !1; r.lastKeyset = [!1, !1, !1]; r.rows = ["", "-shift", "-alt", "-alt-shift"]; n('<!--[if lte IE 8]><script>jQuery("body").addClass("oldie");<\/script><![endif]--><!--[if IE]><script>jQuery("body").addClass("ie");<\/script><![endif]-->').appendTo("body").remove(); r.msie = n("body").hasClass("oldie"); r.allie = n("body").hasClass("ie"); r.inPlaceholder = r.$el.attr("placeholder") || ""; r.watermark = typeof document.createElement("input").placeholder != "undefined" && r.inPlaceholder !== ""; r.regex = n.keyboard.comboRegex; r.decimal = /^\./.test(u.display.dec) ? !0 : !1; r.repeatTime = 1e3 / (u.repeatRate || 20); u.preventDoubleEventTime = u.preventDoubleEventTime || 100; r.isOpen = !1; r.wheel = n.isFunction(n.fn.mousewheel); r.alwaysAllowed = [20, 33, 34, 35, 36, 37, 38, 39, 40, 45, 46]; r.$keyboard = []; r.temp = n('<input style="position:absolute;left:-9999em;top:-9999em;" type="text" value="testing">').appendTo("body").caret(3, 3); r.checkCaret = u.lockInput || r.temp.hide().show().caret().start !== 3 ? !0 : !1; r.temp.remove(); r.lastCaret = { start: 0, end: 0 }; r.temp = ["", 0, 0]; n.each("initialized beforeVisible visible hidden canceled accepted beforeClose".split(" "), function (t, i) { n.isFunction(u[i]) && r.$el.bind(i + ".keyboard", u[i]) }); u.alwaysOpen && (u.stayOpen = !0); n(document).bind("mousedown keyup touchstart checkkeyboard ".split(" ").join(".keyboard "), function (t) { if (!r.opening && (r.escClose(t), t.target && n(t.target).hasClass("ui-keyboard-input"))) { var i = n(t.target).data("keyboard"); i === r && i.options.openOn && i.focusOn() } }); r.$el.addClass("ui-keyboard-input " + u.css.input).attr({ "aria-haspopup": "true", role: "textbox" }); (r.$el.is(":disabled") || r.$el.attr("readonly") && !r.$el.hasClass("ui-keyboard-lockedinput")) && r.$el.addClass("ui-keyboard-nokeyboard"); u.openOn && r.$el.bind(u.openOn + ".keyboard", function () { r.focusOn() }); r.watermark || r.$el.val() !== "" || r.inPlaceholder === "" || r.$el.attr("placeholder") === "" || r.$el.addClass("ui-keyboard-placeholder").val(r.inPlaceholder); r.$el.trigger("initialized.keyboard", [r, r.el]); u.alwaysOpen && r.reveal() }; r.setCurrent = function () { n(".ui-keyboard-has-focus").removeClass("ui-keyboard-has-focus"); n(".ui-keyboard-input-current").removeClass("ui-keyboard-input-current"); r.$el.addClass("ui-keyboard-input-current"); r.$keyboard.addClass("ui-keyboard-has-focus"); r.isCurrent(!0); r.isOpen = !0 }; r.isCurrent = function (t) { var i = n.keyboard.currentKeyboard || !1; return t ? i = n.keyboard.currentKeyboard = r.el : t === !1 && i === r.el && (i = n.keyboard.currentKeyboard = ""), i === r.el }; r.isVisible = function () { return r.$keyboard && r.$keyboard.length ? r.$keyboard.is(":visible") : !1 }; r.focusOn = function () { r.$el.is(":visible") && setTimeout(function () { r.$el.attr("type") != "number" && (r.lastCaret = r.$el.caret()) }, 20); r.isVisible() || (clearTimeout(r.timer), r.reveal()); u.alwaysOpen && r.setCurrent() }; r.reveal = function () { var i, t; if (r.opening = !0, n(".ui-keyboard").not(".ui-keyboard-always-open").remove(), r.$el.is(":disabled") || r.$el.attr("readonly") && !r.$el.hasClass("ui-keyboard-lockedinput")) { r.$el.addClass("ui-keyboard-nokeyboard"); return } return r.$el.removeClass("ui-keyboard-nokeyboard"), u.openOn && r.$el.unbind(u.openOn + ".keyboard"), (!r.$keyboard || r.$keyboard && (!r.$keyboard.length || n.contains(document.body, r.$keyboard[0]))) && r.startup(), r.watermark || r.el.value !== r.inPlaceholder || r.$el.removeClass("ui-keyboard-placeholder").val(""), r.originalContent = r.$el.val(), r.$preview.val(r.originalContent), u.acceptValid && r.checkValid(), u.resetDefault && (r.shiftActive = r.altActive = r.metaActive = !1, r.showKeySet()), u.appendLocally || u.appendTo !== "body" || r.$keyboard.css({ position: "absolute" }), r.$el.trigger("beforeVisible.keyboard", [r, r.el]), r.setCurrent(), r.$keyboard.show(), u.usePreview && r.msie && (typeof r.width == "undefined" && (r.$preview.hide(), r.width = Math.ceil(r.$keyboard.width()), r.$preview.show()), r.$preview.width(r.width)), r.position = u.position, n.ui && n.ui.position && !n.isEmptyObject(r.position) && (r.position.of = r.position.of || r.$el.data("keyboardPosition") || r.$el, r.position.collision = r.position.collision || "flipfit flipfit", r.$keyboard.position(r.position)), r.checkDecimal(), r.lineHeight = parseInt(r.$preview.css("lineHeight"), 10) || parseInt(r.$preview.css("font-size"), 10) + 4, u.caretToEnd && (t = r.originalContent.length, r.lastCaret = { start: t, end: t }), r.allie && (t = r.lastCaret.start || r.originalContent.length, i = { start: t, end: t }, r.lastCaret || (r.lastCaret = i), r.lastCaret.end === 0 && r.lastCaret.start > 0 && (r.lastCaret.end = r.lastCaret.start), r.lastCaret.start < 0 && (r.lastCaret = i)), setTimeout(function () { r.opening = !1; u.initialFocus && r.$preview.focus().caret(r.lastCaret); r.$el.trigger("visible.keyboard", [r, r.el]) }, 10), r }; r.startup = function () { r.$keyboard && r.$keyboard.length || (u.layout === "custom" && (u.layoutHash = "custom" + r.customHash()), r.layout = u.layout === "custom" ? u.layoutHash : u.layout, typeof n.keyboard.builtLayouts[r.layout] == "undefined" && (n.isFunction(u.create) && u.create(r), r.$keyboard.length || r.buildKeyboard()), r.$keyboard = n.keyboard.builtLayouts[r.layout].$keyboard.clone(), u.usePreview ? (r.$preview = r.$el.clone(!1).removeAttr("id").removeClass("ui-keyboard-placeholder ui-keyboard-input").addClass("ui-keyboard-preview " + u.css.input).removeAttr("aria-haspopup").attr("tabindex", "-1").show(), r.$preview.attr("type") == "number" && r.$preview.attr("type", "text"), n("<div />").addClass("ui-keyboard-preview-wrapper").append(r.$preview).prependTo(r.$keyboard)) : (r.$preview = r.$el, n.isEmptyObject(r.position) || (u.position.at = u.position.at2))); r.preview = r.$preview[0]; r.$decBtn = r.$keyboard.find(".ui-keyboard-dec"); (u.enterNavigation || r.el.tagName === "TEXTAREA") && r.alwaysAllowed.push(13); u.lockInput && r.$preview.addClass("ui-keyboard-lockedinput").attr({ readonly: "readonly" }); r.bindKeyboard(); r.$keyboard.appendTo(u.appendLocally ? r.$el.parent() : u.appendTo || "body"); r.bindKeys(); n.ui && n.ui.position && !n.isEmptyObject(r.position) && n(window).bind("resize.keyboard", function () { r.isVisible() && r.$keyboard.position(r.position) }) }; r.bindKeyboard = function () { var t = n.keyboard.builtLayouts[r.layout]; r.$preview.unbind("keypress keyup keydown mouseup touchend ".split(" ").join(".keyboard ")).bind("keypress.keyboard", function (i) { var f = r.lastKey = String.fromCharCode(i.charCode || i.which); if (r.$lastKey = [], r.checkCaret && (r.lastCaret = r.$preview.caret()), r.capsLock = f >= 65 && f <= 90 && !i.shiftKey || f >= 97 && f <= 122 && i.shiftKey ? !0 : !1, u.restrictInput) { if ((i.which === 8 || i.which === 0) && n.inArray(i.keyCode, r.alwaysAllowed)) return; n.inArray(f, t.acceptedKeys) === -1 && i.preventDefault() } else if ((i.ctrlKey || i.metaKey) && (i.which === 97 || i.which === 99 || i.which === 118 || i.which >= 120 && i.which <= 122)) return; t.hasMappedKeys && t.mappedKeys.hasOwnProperty(f) && (r.lastKey = t.mappedKeys[f], r.insertText(r.lastKey), i.preventDefault()); r.checkMaxLength() }).bind("keyup.keyboard", function (t) { switch (t.which) { case 9: if (r.tab && u.tabNavigation && !u.lockInput) { r.shiftActive = t.shiftKey; var i = n.keyboard.keyaction.tab(r); if (r.tab = !1, !i) return !1 } else t.preventDefault(); break; case 27: return r.close(), !1 } clearTimeout(r.throttled); r.throttled = setTimeout(function () { r.isVisible() && r.checkCombos() }, 100); r.checkMaxLength(); n.isFunction(u.change) && u.change(n.Event("change"), r, r.el); r.$el.trigger("change.keyboard", [r, r.el]) }).bind("keydown.keyboard", function (t) { switch (t.which) { case 8: n.keyboard.keyaction.bksp(r, null, t); t.preventDefault(); break; case 9: return u.tabNavigation ? (r.tab = !0, !1) : (r.tab = !0, !1); case 13: n.keyboard.keyaction.enter(r, null, t); break; case 20: r.shiftActive = r.capsLock = !r.capsLock; r.showKeySet(this); break; case 86: if (t.ctrlKey || t.metaKey) { if (u.preventPaste) { t.preventDefault(); return } r.checkCombos() } } }).bind("mouseup.keyboard touchend.keyboard", function () { r.checkCaret && (r.lastCaret = r.$preview.caret()) }); r.$keyboard.bind("mousedown.keyboard click.keyboard touchstart.keyboard", function (t) { t.stopPropagation(); r.isCurrent() || (r.reveal(), n(document).trigger("checkkeyboard.keyboard")) }); u.preventPaste && (r.$preview.bind("contextmenu.keyboard", function (n) { n.preventDefault() }), r.$el.bind("contextmenu.keyboard", function (n) { n.preventDefault() })) }; r.bindKeys = function () { var t = (u.keyBinding + " repeater mouseenter mouseleave touchstart mousewheel mouseup click ").split(" ").join(".keyboard ") + "mouseleave mousedown touchstart touchend touchmove touchcancel ".split(" ").join(".kb "); r.$allKeys = r.$keyboard.find("button.ui-keyboard-button").unbind(t).bind(u.keyBinding.split(" ").join(".keyboard ") + ".keyboard repeater.keyboard", function (t) { if (!r.$keyboard.is(":visible")) return !1; var e, f = n(this), i = f.attr("data-action"), o = (new Date).getTime(); if (i = i === ":" ? ":" : i.split(":")[0], !(o - (r.lastEventTime || 0) < u.preventDoubleEventTime)) { if (r.lastEventTime = o, r.$preview.focus(), r.$lastKey = f, r.lastKey = f.attr("data-curtxt"), r.checkCaret && r.$preview.caret(r.lastCaret), i.match("meta") && (i = "meta"), n.keyboard.keyaction.hasOwnProperty(i) && n(this).hasClass("ui-keyboard-actionkey")) { if (n.keyboard.keyaction[i](r, this, t) === !1) return !1 } else typeof i != "undefined" && (e = r.lastKey = r.wheel && !n(this).hasClass("ui-keyboard-actionkey") ? r.lastKey : i, r.insertText(e), r.capsLock || u.stickyShift || t.shiftKey || (r.shiftActive = !1, r.showKeySet(this))); r.$preview.focus().caret(r.lastCaret); r.checkCombos(); r.checkMaxLength(); n.isFunction(u.change) && u.change(n.Event("change"), r, r.el); r.$el.trigger("change.keyboard", [r, r.el]); t.preventDefault() } }).bind("mouseenter.keyboard mouseleave.keyboard touchstart.keyboard", function (t) { if (r.isCurrent()) { var i = n(this), f = i.data("layers") || r.getLayers(i); i.data("layers", f = n.grep(f, function (t, i) { return n.inArray(t, f) === i })); t.type !== "mouseenter" && t.type !== "touchstart" || r.el.type === "password" || i.hasClass(u.css.buttonDisabled) || i.addClass(u.css.buttonHover).attr("title", function (n, i) { return r.wheel && i === "" && r.sets && f.length > 1 && t.type !== "touchstart" ? u.wheelMessage : i }); t.type === "mouseleave" && (i.data({ curtxt: i.data("original"), curnum: 0 }), i.removeClass(r.el.type === "password" ? "" : u.css.buttonHover).attr("title", function (n, t) { return t === u.wheelMessage ? "" : t }).find("span").html(i.data("original"))) } }).bind("mousewheel.keyboard", function (t, i) { if (r.wheel) { i = i || t.deltaY; var u, f, e = n(this); return f = e.data("layers") || r.getLayers(e), f.length > 1 ? (u = e.data("curnum") + (i > 0 ? -1 : 1), u > f.length - 1 && (u = 0), u < 0 && (u = f.length - 1)) : u = 0, e.data({ curnum: u, layers: f, curtxt: f[u] }), e.find("span").html(f[u]), !1 } }).bind("mouseup.keyboard mouseleave.kb touchend.kb touchmove.kb touchcancel.kb", function (t) { return /(mouseleave|touchend|touchcancel)/.test(t.type) ? n(this).removeClass(u.css.buttonHover) : (r.isVisible() && r.isCurrent() && r.$preview.focus(), r.checkCaret && r.$preview.caret(r.lastCaret)), r.mouseRepeat = [!1, ""], clearTimeout(r.repeater), !1 }).bind("click.keyboard", function () { return !1 }).not(".ui-keyboard-actionkey").add(".ui-keyboard-tab, .ui-keyboard-bksp, .ui-keyboard-space, .ui-keyboard-enter", r.$keyboard).bind("mousedown.kb touchstart.kb", function () { if (u.repeatRate !== 0) { var t = n(this); r.mouseRepeat = [!0, t]; setTimeout(function () { r.mouseRepeat[0] && r.mouseRepeat[1] === t && r.repeatKey(t) }, u.repeatDelay) } return !1 }) }; r.insertText = function (n) { var u, i, f, e = r.$preview.val(), t = r.$preview.caret(), o = r.$preview.scrollLeft(), h = r.$preview.scrollTop(), s = e.length; t.end < t.start && (t.end = t.start); t.start > s && (t.end = t.start = s); r.preview.tagName === "TEXTAREA" && (r.msie && e.substr(t.start, 1) === "\n" && (t.start += 1, t.end += 1), f = e.split("\n").length - 1, r.preview.scrollTop = f > 0 ? r.lineHeight * f : h); u = n === "bksp" && t.start === t.end ? !0 : !1; n = n === "bksp" ? "" : n; i = t.start + (u ? -1 : n.length); o += parseInt(r.$preview.css("fontSize"), 10) * (n === "bksp" ? -1 : 1); r.$preview.val(r.$preview.val().substr(0, t.start - (u ? 1 : 0)) + n + r.$preview.val().substr(t.end)).scrollLeft(o).caret(i, i); r.lastCaret = { start: i, end: i } }; r.checkMaxLength = function () { var n, t = r.$preview.val(); u.maxLength !== !1 && t.length > u.maxLength && (n = Math.min(r.$preview.caret().start, u.maxLength), r.$preview.val(t.substring(0, u.maxLength)), r.$preview.caret(n, n), r.lastCaret = { start: n, end: n }); r.$decBtn.length && r.checkDecimal() }; r.repeatKey = function (n) { n.trigger("repeater.keyboard"); r.mouseRepeat[0] && (r.repeater = setTimeout(function () { r.repeatKey(n) }, r.repeatTime)) }; r.showKeySet = function (n) { var t = "", i = (r.shiftActive ? 1 : 0) + (r.altActive ? 2 : 0); if (r.shiftActive || (r.capsLock = !1), r.metaActive ? (t = n && n.name && /meta/.test(n.name) ? n.name : "", t === "" ? t = r.metaActive === !0 ? "" : r.metaActive : r.metaActive = t, (u.stickyShift || r.lastKeyset[2] === r.metaActive) && (!(r.shiftActive || r.altActive) || r.$keyboard.find(".ui-keyboard-keyset-" + t + r.rows[i]).length) || (r.shiftActive = r.altActive = !1)) : !u.stickyShift && r.lastKeyset[2] !== r.metaActive && r.shiftActive && (r.shiftActive = r.altActive = !1), i = (r.shiftActive ? 1 : 0) + (r.altActive ? 2 : 0), t = i === 0 && !r.metaActive ? "-default" : t === "" ? "" : "-" + t, !r.$keyboard.find(".ui-keyboard-keyset" + t + r.rows[i]).length) { r.shiftActive = r.lastKeyset[0]; r.altActive = r.lastKeyset[1]; r.metaActive = r.lastKeyset[2]; return } r.$keyboard.find(".ui-keyboard-alt, .ui-keyboard-shift, .ui-keyboard-actionkey[class*=meta]").removeClass(u.css.buttonAction).end().find(".ui-keyboard-alt")[r.altActive ? "addClass" : "removeClass"](u.css.buttonAction).end().find(".ui-keyboard-shift")[r.shiftActive ? "addClass" : "removeClass"](u.css.buttonAction).end().find(".ui-keyboard-lock")[r.capsLock ? "addClass" : "removeClass"](u.css.buttonAction).end().find(".ui-keyboard-keyset").hide().end().find(".ui-keyboard-keyset" + t + r.rows[i]).show().end().find(".ui-keyboard-actionkey.ui-keyboard" + t).addClass(u.css.buttonAction); r.lastKeyset = [r.shiftActive, r.altActive, r.metaActive] }; r.checkCombos = function () { if (!r.isVisible()) return r.$preview.val(); var o, h, f, e, i = r.$preview.val(), t = r.$preview.caret(), c = n.keyboard.builtLayouts[r.layout], s = i.length; if (t.end < t.start && (t.end = t.start), t.start > s && (t.end = t.start = s), r.msie && i.substr(t.start, 1) === "\n" && (t.start += 1, t.end += 1), u.useCombos && (r.msie ? i = i.replace(r.regex, function (n, t, i) { return u.combos.hasOwnProperty(t) ? u.combos[t][i] || n : n }) : r.$preview.length && (f = t.start - (t.start - 2 >= 0 ? 2 : 0), r.$preview.caret(f, t.end), e = (r.$preview.caret().text || "").replace(r.regex, function (n, t, i) { return u.combos.hasOwnProperty(t) ? u.combos[t][i] || n : n }), r.$preview.val(r.$preview.caret().replace(e)), i = r.$preview.val())), u.restrictInput && i !== "") { for (f = i, h = c.acceptedKeys.length, o = 0; o < h; o++) f !== "" && (e = c.acceptedKeys[o], i.indexOf(e) >= 0 && (/[\[|\]|\\|\^|\$|\.|\||\?|\*|\+|\(|\)|\{|\}]/g.test(e) && (e = "\\" + e), f = f.replace(new RegExp(e, "g"), ""))); f !== "" && (i = i.replace(f, "")) } return t.start += i.length - s, t.end += i.length - s, r.$preview.val(i), r.$preview.caret(t.start, t.end), r.preview.scrollTop = r.lineHeight * (i.substring(0, t.start).split("\n").length - 1), r.lastCaret = { start: t.start, end: t.end }, u.acceptValid && r.checkValid(), i }; r.checkValid = function () { var n = !0; u.validate && typeof u.validate == "function" && (n = u.validate(r, r.$preview.val(), !1)); r.$keyboard.find(".ui-keyboard-accept")[n ? "removeClass" : "addClass"]("ui-keyboard-invalid-input")[n ? "addClass" : "removeClass"]("ui-keyboard-valid-input") }; r.checkDecimal = function () { r.decimal && /\./g.test(r.preview.value) || !r.decimal && /\,/g.test(r.preview.value) ? r.$decBtn.attr({ disabled: "disabled", "aria-disabled": "true" }).removeClass(u.css.buttonDefault + " " + u.css.buttonHover).addClass(u.css.buttonDisabled) : r.$decBtn.removeAttr("disabled").attr({ "aria-disabled": "false" }).addClass(u.css.buttonDefault).removeClass(u.css.buttonDisabled) }; r.getLayers = function (t) { var i; return i = t.attr("data-pos"), t.closest(".ui-keyboard").find('button[data-pos="' + i + '"]').map(function () { return n(this).find("> span").html() }).get() }; r.switchInput = function (t, i) { if (typeof u.switchInput == "function") u.switchInput(r, t, i); else { r.$keyboard.hide(); var o, s = !1, e = n("button, input, textarea, a").filter(":visible"), f = e.index(r.$el) + (t ? 1 : -1); if (r.$keyboard.show(), f > e.length - 1 && (s = u.stopAtEnd, f = 0), f < 0 && (s = u.stopAtEnd, f = e.length - 1), !s) { if (i = r.close(i), !i) return; o = e.eq(f).data("keyboard"); o && o.options.openOn.length ? o.focusOn() : e.eq(f).focus() } } return !1 }; r.close = function (t) { if (r.isOpen) { clearTimeout(r.throttled); var i = t ? r.checkCombos() : r.originalContent; if (t && u.validate && typeof u.validate == "function" && !u.validate(r, i, !0) && (i = r.originalContent, t = !1, u.cancelClose)) return; r.isCurrent(!1); r.isOpen = !1; r.$preview.val(i); r.$el.removeClass("ui-keyboard-input-current ui-keyboard-autoaccepted").addClass(t || !1 ? t === !0 ? "" : "ui-keyboard-autoaccepted" : "").trigger(u.alwaysOpen ? "" : "beforeClose.keyboard", [r, r.el, t || !1]).val(i).scrollTop(r.el.scrollHeight).trigger(t || !1 ? "accepted.keyboard" : "canceled.keyboard", [r, r.el]).trigger(u.alwaysOpen ? "inactive.keyboard" : "hidden.keyboard", [r, r.el]).blur(); u.openOn && (r.timer = setTimeout(function () { r.$el.bind(u.openOn + ".keyboard", function () { r.focusOn() }); n(":focus")[0] === r.el && r.$el.blur() }, 500)); !u.alwaysOpen && r.$keyboard && (r.$keyboard.remove(), r.$keyboard = []); r.watermark || r.el.value !== "" || r.inPlaceholder === "" || r.$el.addClass("ui-keyboard-placeholder").val(r.inPlaceholder); r.$el.trigger("change") } return !!t }; r.accept = function () { return r.close(!0) }; r.escClose = function (n) { if (n && n.type === "keyup") return n.which === 27 ? r.close() : ""; r.isOpen && (!r.isCurrent() && r.isOpen || r.isOpen && n.target !== r.el && !u.stayOpen) && (r.allie && n.preventDefault(), r.close(u.autoAccept ? "true" : !1)) }; r.keyBtn = n("<button />").attr({ role: "button", type: "button", "aria-disabled": "false", tabindex: "-1" }).addClass("ui-keyboard-button"); r.addKey = function (t, i, f) { var l, h, a, s, o, e = f === !0 ? t : u.display[i] || t, c = f === !0 ? t.charCodeAt(0) : t; return /\(.+\)/.test(e) && (s = e.replace(/\(([^()]+)\)/, ""), a = e.match(/\(([^()]+)\)/)[1], e = s, o = s.split(":"), s = o[0] !== "" && o.length > 1 ? o[0] : s, n.keyboard.builtLayouts[r.layout].mappedKeys[a] = s), o = e.split(":"), o[0] === "" && o[1] === "" && (e = ":"), e = o[0] !== "" && o.length > 1 ? n.trim(o[0]) : e, l = o.length > 1 ? n.trim(o[1]).replace(/_/g, " ") || "" : "", h = e.length > 1 ? " ui-keyboard-widekey" : "", h += f ? "" : " ui-keyboard-actionkey", r.keyBtn.clone().attr({ "data-value": e, name: c, "data-pos": r.temp[1] + "," + r.temp[2], title: l, "data-action": t, "data-original": e, "data-curtxt": e, "data-curnum": 0 }).addClass((c === "" ? "" : "ui-keyboard-" + c + h + " ") + u.css.buttonDefault).html("<span>" + e + "<\/span>").appendTo(r.temp[0]) }; r.customHash = function () { var i, r, n, o, f, e = u.customLayout, s = [], t = []; for (r in e) e.hasOwnProperty(r) && s.push(e[r]); if (t = t.concat.apply(t, s).join(" "), n = 0, f = t.length, f === 0) return n; for (i = 0; i < f; i++) o = t.charCodeAt(i), n = (n << 5) - n + o, n = n & n; return n }; r.buildKeyboard = function () { var e, t, s, h, a, y, i, o, f, p = 0, c = n.keyboard.builtLayouts[r.layout] = { mappedKeys: {}, acceptedKeys: [] }, l = c.acceptedKeys = [], v = n("<div />").addClass("ui-keyboard " + u.css.container + (u.alwaysOpen ? " ui-keyboard-always-open" : "")).attr({ role: "textbox" }).hide(); return u.layout !== "custom" && n.keyboard.layouts.hasOwnProperty(u.layout) || (u.layout = "custom", n.keyboard.layouts.custom = u.customLayout || { "default": ["{cancel}"] }), n.each(n.keyboard.layouts[u.layout], function (c, w) { if (c !== "") for (p++, h = n("<div />").attr("name", c).addClass("ui-keyboard-keyset ui-keyboard-keyset-" + c).appendTo(v)[c === "default" ? "show" : "hide"](), s = 0; s < w.length; s++) { for (y = n.trim(w[s]).replace(/\{(\.?)[\s+]?:[\s+]?(\.?)\}/g, "{$1:$2}"), o = y.split(/\s+/), i = 0; i < o.length; i++) if (r.temp = [h, s, i], a = !1, o[i].length !== 0) if (/^\{\S+\}$/.test(o[i])) { if (t = o[i].match(/^\{(\S+)\}$/)[1].toLowerCase(), /\!\!/.test(t) && (t = t.replace("!!", ""), a = !0), /^sp:((\d+)?([\.|,]\d+)?)(em|px)?$/.test(t) && (f = parseFloat(t.replace(/,/, ".").match(/^sp:((\d+)?([\.|,]\d+)?)(em|px)?$/)[1] || 0), n("<span>&nbsp;<\/span>").width(t.match("px") ? f + "px" : f * 2 + "em").addClass("ui-keyboard-button ui-keyboard-spacer").appendTo(h)), /^empty(:((\d+)?([\.|,]\d+)?)(em|px)?)?$/.test(t) && (f = /:/.test(t) ? parseFloat(t.replace(/,/, ".").match(/^empty:((\d+)?([\.|,]\d+)?)(em|px)?$/)[1] || 0) : "", r.addKey("", " ").addClass(u.css.buttonDisabled + " " + u.css.buttonEmpty).attr("aria-disabled", !0).width(f ? t.match("px") ? f + "px" : f * 2 + "em" : "")), /^meta\d+\:?(\w+)?/.test(t)) { r.addKey(t, t); continue } switch (t) { case "a": case "accept": r.addKey("accept", t).addClass(u.css.buttonAction); break; case "alt": case "altgr": r.addKey("alt", "alt"); break; case "b": case "bksp": r.addKey("bksp", t); break; case "c": case "cancel": r.addKey("cancel", t).addClass(u.css.buttonAction); break; case "combo": r.addKey("combo", "combo").addClass(u.css.buttonAction); break; case "dec": l.push(r.decimal ? "." : ","); r.addKey("dec", "dec"); break; case "e": case "enter": r.addKey("enter", t).addClass(u.css.buttonAction); break; case "s": case "shift": r.addKey("shift", t); break; case "sign": l.push("-"); r.addKey("sign", "sign"); break; case "space": l.push(" "); r.addKey("space", "space"); break; case "t": case "tab": r.addKey("tab", t); break; default: n.keyboard.keyaction.hasOwnProperty(t) && r.addKey(t, t)[a ? "addClass" : "removeClass"](u.css.buttonAction) } } else e = o[i], l.push(e === ":" ? e : e.split(":")[0]), r.addKey(e, e, !0); h.find(".ui-keyboard-button:last").after('<br class="ui-keyboard-button-endrow">') } }), p > 1 && (r.sets = !0), c.hasMappedKeys = !n.isEmptyObject(c.mappedKeys), c.$keyboard = v, v }; r.destroy = function () { n(document).unbind("mousedown.keyboard keyup.keyboard touchstart.keyboard"); r.$keyboard.length && r.$keyboard.remove(); var t = n.trim(u.openOn + " accepted beforeClose canceled change contextmenu hidden initialized keydown keypress keyup visible ").split(" ").join(".keyboard "); r.$el.removeClass("ui-keyboard-input ui-keyboard-lockedinput ui-keyboard-placeholder ui-keyboard-notallowed ui-keyboard-always-open " + u.css.input).removeAttr("aria-haspopup").removeAttr("role").unbind(t + ".keyboard").removeData("keyboard") }; r.init() }; n.keyboard.keyaction = { accept: function (n) { return n.close(!0), !1 }, alt: function (n, t) { n.altActive = !n.altActive; n.showKeySet(t) }, bksp: function (n) { n.insertText("bksp") }, cancel: function (n) { return n.close(), !1 }, clear: function (n) { n.$preview.val("") }, combo: function (n) { var t = !n.options.useCombos; return n.options.useCombos = t, n.$keyboard.find(".ui-keyboard-combo").toggleClass(n.options.css.buttonAction, t), t && n.checkCombos(), !1 }, dec: function (n) { n.insertText(n.decimal ? "." : ",") }, "default": function (n, t) { n.shiftActive = n.altActive = n.metaActive = !1; n.showKeySet(t) }, enter: function (t, i, r) { var f = t.el.tagName, u = t.options; if (r.shiftKey) return u.enterNavigation ? t.switchInput(!r[u.enterMod], !0) : t.close(!0); if (u.enterNavigation && (f !== "TEXTAREA" || r[u.enterMod])) return t.switchInput(!r[u.enterMod], u.autoAccept ? "true" : !1); f === "TEXTAREA" && n(r.target).closest("button").length && t.insertText(" \n") }, lock: function (n, t) { n.lastKeyset[0] = n.shiftActive = n.capsLock = !n.capsLock; n.showKeySet(t) }, left: function (n) { var t = n.$preview.caret(); t.start - 1 >= 0 && (n.lastCaret = { start: t.start - 1, end: t.start - 1 }) }, meta: function (t, i) { t.metaActive = n(i).hasClass(t.options.css.buttonAction) ? !1 : !0; t.showKeySet(i) }, next: function (n) { return n.switchInput(!0, n.options.autoAccept), !1 }, prev: function (n) { return n.switchInput(!1, n.options.autoAccept), !1 }, right: function (n) { var t = n.$preview.caret(); t.start + 1 <= n.$preview.val().length && (n.lastCaret = { start: t.start + 1, end: t.start + 1 }) }, shift: function (n, t) { n.lastKeyset[0] = n.shiftActive = !n.shiftActive; n.showKeySet(t) }, sign: function (n) { /^\-?\d*\.?\d*$/.test(n.$preview.val()) && n.$preview.val(n.$preview.val() * -1) }, space: function (n) { n.insertText(" ") }, tab: function (n) { var t = n.el.tagName, i = n.options; if (t === "INPUT") return i.tabNavigation ? n.switchInput(!n.shiftActive, !0) : !1; n.insertText("\t") } }; n.keyboard.builtLayouts = {}; n.keyboard.layouts = { alpha: { "default": ["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}", "{tab} a b c d e f g h i j [ ] \\", "k l m n o p q r s ; ' {enter}", "{shift} t u v w x y z , . / {shift}", "{accept} {space} {cancel}"], shift: ["~ ! @ # $ % ^ & * ( ) _ + {bksp}", "{tab} A B C D E F G H I J { } |", 'K L M N O P Q R S : " {enter}', "{shift} T U V W X Y Z < > ? {shift}", "{accept} {space} {cancel}"] }, qwerty: { "default": ["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}", "{tab} q w e r t y u i o p [ ] \\", "a s d f g h j k l ; ' {enter}", "{shift} z x c v b n m , . / {shift}", "{accept} {space} {cancel}"], shift: ["~ ! @ # $ % ^ & * ( ) _ + {bksp}", "{tab} Q W E R T Y U I O P { } |", 'A S D F G H J K L : " {enter}', "{shift} Z X C V B N M < > ? {shift}", "{accept} {space} {cancel}"] }, international: { "default": ["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}", "{tab} q w e r t y u i o p [ ] \\", "a s d f g h j k l ; ' {enter}", "{shift} z x c v b n m , . / {shift}", "{accept} {alt} {space} {alt} {cancel}"], shift: ["~ ! @ # $ % ^ & * ( ) _ + {bksp}", "{tab} Q W E R T Y U I O P { } |", 'A S D F G H J K L : " {enter}', "{shift} Z X C V B N M < > ? {shift}", "{accept} {alt} {space} {alt} {cancel}"], alt: ["~ ¡ ² ³ ¤ € ¼ ½ ¾ ‘ ’ ¥ × {bksp}", "{tab} ä å é ® þ ü ú í ó ö « » ¬", "á ß ð f g h j k ø ¶ ´ {enter}", "{shift} æ x © v b ñ µ ç > ¿ {shift}", "{accept} {alt} {space} {alt} {cancel}"], "alt-shift": ["~ ¹ ² ³ £ € ¼ ½ ¾ ‘ ’ ¥ ÷ {bksp}", "{tab} Ä Å É ® Þ Ü Ú Í Ó Ö « » ¦", "Ä § Ð F G H J K Ø ° ¨ {enter}", "{shift} Æ X ¢ V B Ñ µ Ç . ¿ {shift}", "{accept} {alt} {space} {alt} {cancel}"] }, colemak: { "default": ["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}", "{tab} q w f p g j l u y ; [ ] \\", "{bksp} a r s t d h n e i o ' {enter}", "{shift} z x c v b k m , . / {shift}", "{accept} {space} {cancel}"], shift: ["~ ! @ # $ % ^ & * ( ) _ + {bksp}", "{tab} Q W F P G J L U Y : { } |", '{bksp} A R S T D H N E I O " {enter}', "{shift} Z X C V B K M < > ? {shift}", "{accept} {space} {cancel}"] }, dvorak: { "default": ["` 1 2 3 4 5 6 7 8 9 0 [ ] {bksp}", "{tab} ' , . p y f g c r l / = \\", "a o e u i d h t n s - {enter}", "{shift} ; q j k x b m w v z {shift}", "{accept} {space} {cancel}"], shift: ["~ ! @ # $ % ^ & * ( ) { } {bksp}", '{tab} " < > P Y F G C R L ? + |', "A O E U I D H T N S _ {enter}", "{shift} : Q J K X B M W V Z {shift}", "{accept} {space} {cancel}"] }, num: { "default": ["= ( ) {b}", "{clear} / * -", "7 8 9 +", "4 5 6 {sign}", "1 2 3 %", "0 . {a} {c}"] } }; n.keyboard.defaultOptions = { layout: "qwerty", customLayout: null, position: { of: null, my: "center top", at: "center top", at2: "center bottom" }, usePreview: !0, alwaysOpen: !1, initialFocus: !0, stayOpen: !1, display: { a: "✔:Accept (Shift-Enter)", accept: "Accept:Accept (Shift-Enter)", alt: "Alt:⌥ AltGr", b: "⌫:Backspace", bksp: "Bksp:Backspace", c: "✖:Cancel (Esc)", cancel: "Cancel:Cancel (Esc)", clear: "C:Clear", combo: "ö:Toggle Combo Keys", dec: ".:Decimal", e: "⏎:Enter", empty: " ", enter: "Enter:Enter ⏎", left: "←", lock: "Lock:⇪ Caps Lock", next: "Next ⇨", prev: "⇦ Prev", right: "→", s: "⇧:Shift", shift: "Shift:Shift", sign: "±:Change Sign", space: "&nbsp;:Space", t: "⇥:Tab", tab: "⇥ Tab:Tab" }, wheelMessage: "Use mousewheel to see other keys", css: { input: "ui-widget-content ui-corner-all", container: "ui-widget-content ui-widget ui-corner-all ui-helper-clearfix", buttonDefault: "ui-state-default ui-corner-all", buttonHover: "ui-state-hover", buttonAction: "ui-state-active", buttonDisabled: "ui-state-disabled", buttonEmpty: "ui-keyboard-empty" }, autoAccept: !1, lockInput: !1, restrictInput: !1, acceptValid: !1, cancelClose: !0, tabNavigation: !1, enterNavigation: !1, enterMod: "altKey", stopAtEnd: !0, appendLocally: !1, appendTo: "body", stickyShift: !0, preventPaste: !1, caretToEnd: !1, maxLength: !1, repeatDelay: 500, repeatRate: 20, resetDefault: !1, openOn: "focus", keyBinding: "mousedown touchstart", useCombos: !0, combos: { "`": { a: "à", A: "À", e: "è", E: "È", i: "ì", I: "Ì", o: "ò", O: "Ò", u: "ù", U: "Ù", y: "ỳ", Y: "Ỳ" }, "'": { a: "á", A: "Á", e: "é", E: "É", i: "í", I: "Í", o: "ó", O: "Ó", u: "ú", U: "Ú", y: "ý", Y: "Ý" }, '"': { a: "ä", A: "Ä", e: "ë", E: "Ë", i: "ï", I: "Ï", o: "ö", O: "Ö", u: "ü", U: "Ü", y: "ÿ", Y: "Ÿ" }, "^": { a: "â", A: "Â", e: "ê", E: "Ê", i: "î", I: "Î", o: "ô", O: "Ô", u: "û", U: "Û", y: "ŷ", Y: "Ŷ" }, "~": { a: "ã", A: "Ã", e: "ẽ", E: "Ẽ", i: "ĩ", I: "Ĩ", o: "õ", O: "Õ", u: "ũ", U: "Ũ", y: "ỹ", Y: "Ỹ", n: "ñ", N: "Ñ" } }, validate: function () { return !0 } }; n.keyboard.comboRegex = /([`\'~\^\"ao])([a-z])/mig; n.keyboard.currentKeyboard = ""; n.fn.keyboard = function (t) { return this.each(function () { n(this).data("keyboard") || new n.keyboard(this, t) }) }; n.fn.getkeyboard = function () { return this.data("keyboard") } }(jQuery), function (n, t, i, r) { "use strict"; n.fn.caret = function (n, u) { if (typeof this[0] == "undefined" || this.is(":hidden") || this.css("visibility") === "hidden") return this; var o, h, s, a, l, e, v, w, c, y = document.selection, f = this[0], k = f.scrollTop, p = !1, b = !0; try { p = typeof f.selectionStart != "undefined" } catch (d) { b = !1 } return typeof n == "object" && n.start && n.end ? (h = n.start, a = n.end) : typeof n == "number" && typeof u == "number" && (h = n, a = u), b && typeof h != "undefined" ? (p ? (f.selectionStart = h, f.selectionEnd = a) : (l = f.createTextRange(), l.collapse(!0), l.moveStart("character", h), l.moveEnd("character", a - h), l.select()), (this.is(":visible") || this.css("visibility") !== "hidden") && this.focus(), f.scrollTop = k, this) : (p ? (o = f.selectionStart, s = f.selectionEnd) : y ? f.tagName === "TEXTAREA" ? (c = this.val(), e = y[i](), v = e[r](), v.moveToElementText(f), v.setEndPoint("EndToEnd", e), o = v.text.replace(/\r/g, "\n")[t], s = o + e.text.replace(/\r/g, "\n")[t]) : (c = this.val().replace(/\r/g, "\n"), e = y[i]()[r](), e.moveEnd("character", c[t]), o = e.text === "" ? c[t] : c.lastIndexOf(e.text), e = y[i]()[r](), e.moveStart("character", -c[t]), s = e.text[t]) : (o = 0, s = (f.value || "").length), w = (f.value || "").substring(o, s), { start: o, end: s, text: w, replace: function (n) { return f.value.substring(0, o) + n + f.value.substring(s, f.value[t]) } }) } }(jQuery, "length", "createRange", "duplicate")