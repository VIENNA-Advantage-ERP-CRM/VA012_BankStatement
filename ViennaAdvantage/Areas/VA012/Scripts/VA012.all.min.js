/*Version 1.0.29.0*/VA012=window.VA012||{},function(n,t){function i(){function ae(n){n!=null&&n!=""&&(o=t(n),e.getControls(),e.setBankAndAccount(),f.newRecord(),e.getBaseCurrency(),e.loadPayments("0","0","PY",rt.val()),ve(),e.dragPayments(),e.dropPayments())}function ve(){ef.on(VIS.Events.onTouchStartOrClick,function(n){n.stopPropagation();var i=cu.width();i>50&&t(".va012-left-content").hide();cu.animate({width:i>50?40:200},300,"swing",function(){i<50&&t(".va012-left-content").show()})});fi.on("change",function(){s.val("0");e.loadBankAccount()});s.on("change",function(){f.loadPayment();f.loadCurrency();f.loadCashLine();gt.html("");f.scheduleRefresh();f.prepayRefresh();f.refreshForm();ei=1;storepaymentdata=[];e.loadPayments(s.val()==null?0:s.val(),ut.val(),b.val(),rt.val());st=[];nt.html("");ii=1;a.loadStatement(ni)});ut.on("change",function(){gt.html("");ei=1;storepaymentdata=[];e.loadPayments(s.val()==null?0:s.val(),ut.val(),b.val(),rt.val())});b.on("change",function(){b.val()=="CO"?(ut.prop("selectedIndex",0),ut.prop("disabled",!0)):(ut.prop("selectedIndex",0),ut.prop("disabled",!1));gt.html("");f.scheduleRefresh();f.prepayRefresh();f.refreshForm();ei=1;bu=0;df=50;ee=1;storepaymentdata=[];e.loadPayments(s.val()==null?0:s.val(),ut.val(),b.val(),rt.val())});tf.on(VIS.Events.onTouchStartOrClick,function(){rt.val()==""?VIS.ADialog.info(VIS.Msg.getMsg("VA012_PleaseEnterStatementDate"),null,"",""):a.statementDialog()});rf.on(VIS.Events.onTouchStartOrClick,function(){a.matchStatementDialog()});wr.on(VIS.Events.onTouchStartOrClick,function(){a.paymentScheduleDialog()});hf.on(VIS.Events.onTouchStartOrClick,function(){a.prepayOrderDialog()});vf.on(VIS.Events.onTouchStartOrClick,function(){bt.val()!=null&&bt.val()!=""?(oi=!0,st=[],nt.html(""),ii=1,a.loadStatement(ni)):(st=[],nt.html(""),ii=1,a.loadStatement(ni))});bt.keypress(function(n){n.which==13&&(bt.val()!=null&&bt.val()!=""?(oi=!0,st=[],nt.html(""),ii=1,a.loadStatement(ni)):(st=[],nt.html(""),ii=1,a.loadStatement(ni)))});uf.on(VIS.Events.onTouchStartOrClick,function(){st.length>0?t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA012/BankStatement/UnmatchStatement",contentType:"application/json; charset=utf-8",data:JSON.stringify({_statementLinesList:st.toString()}),success:function(n){n!=null&&n!=""&&(n=t.parseJSON(n),n[0]._status=="Success"&&n[0]._statementOk!=null&&VIS.ADialog.info(n[0]._statementOk+" "+VIS.Msg.getMsg("VA012_StatementsUnmatched"),null,"",""),n[0]._error!=null&&VIS.ADialog.info(n[0]._error,null,"",""),n[0]._statementNo!=null&&VIS.ADialog.info(n[0]._statementNo+" "+VIS.Msg.getMsg("VA012_CompletedRecord"),null,"",""),n[0]._statementNoNotUpdate!=null&&VIS.ADialog.info(n[0]._statementNoNotUpdate+" "+VIS.Msg.getMsg("VA012_ErrorSaving"),null,"",""),f.scheduleRefresh(),f.prepayRefresh(),f.refreshForm(),st=[],storepaymentdata=[],nt.html(""),ii=1,a.loadStatement(ni),gt.html(""),f.scheduleRefresh(),f.prepayRefresh(),ei=1,e.loadPayments(s.val(),ut.val(),b.val(),rt.val()))},error:function(n){VIS.ADialog.info(n,null,"","")}}):VIS.ADialog.info(VIS.Msg.getMsg("VA012_NoRecordSelected"),null,"","")});ff.on(VIS.Events.onTouchStartOrClick,function(){if(s.val()==null||s.val()==""||s.val()=="0"){VIS.ADialog.info(VIS.Msg.getMsg("VA012_SelectBankAccountFirst"),null,"","");return}t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA012/BankStatement/ProcessStatement",contentType:"application/json; charset=utf-8",data:JSON.stringify({_statementLinesList:st.toString(),_accountID:s.val()}),success:function(n){n!=null&&n!=""&&(n=t.parseJSON(n),n[0]._statementProcessed!=null&&VIS.ADialog.info(n[0]._statementProcessed+" "+VIS.Msg.getMsg("VA012_StatementsProcessed"),null,"",""),n[0]._error!=null&&VIS.ADialog.info(n[0]._error,null,"",""),n[0]._statementNotProcessed!=null&&VIS.ADialog.info(n[0]._statementNotProcessed+" "+VIS.Msg.getMsg("VA012_StatementsNotProcessed"),null,"",""),n[0]._statementUnmatchedLines!=null&&VIS.ADialog.info(n[0]._statementUnmatchedLines+" "+VIS.Msg.getMsg("VA012_ExistsUnmatched"),null,"",""),f.scheduleRefresh(),f.prepayRefresh(),f.refreshForm(),storepaymentdata=[],st=[],nt.html(""),ii=1,a.loadStatement(ni),gt.html(""),f.scheduleRefresh(),f.prepayRefresh(),ei=1,e.loadPayments(s.val(),ut.val(),b.val(),rt.val()))},error:function(n){VIS.ADialog.info(n,null,"","")}})});lf.on(VIS.Events.onTouchStartOrClick,function(){st.length>0||parseInt(h.attr("data-uid"))>0?VIS.ADialog.ask(VIS.Msg.getMsg("VA012_WantToDelete"))&&t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA012/BankStatement/DeleteStatement",contentType:"application/json; charset=utf-8",data:JSON.stringify({_statementLinesList:st.toString(),_statementLineID:h.attr("data-uid")}),success:function(n){n!=null&&n!=""&&(n=t.parseJSON(n),n[0]._status=="Success"&&n[0]._statementProcessed!=null&&VIS.ADialog.info(n[0]._statementProcessed+" "+VIS.Msg.getMsg("VA012_StatementsDeleted"),null,"",""),n[0]._statementNotProcessed!=null&&VIS.ADialog.info(n[0]._statementNotProcessed+" "+VIS.Msg.getMsg("VA012_StatementsNotDeleted"),null,"",""),n[0]._error!=null&&VIS.ADialog.info(n[0]._error,null,"",""),f.scheduleRefresh(),f.prepayRefresh(),f.refreshForm(),st=[],storepaymentdata=[],nt.html(""),ii=1,a.loadStatement(ni),gt.html(""),f.scheduleRefresh(),f.prepayRefresh(),ei=1,e.loadPayments(s.val(),ut.val(),b.val(),rt.val()))},error:function(n){VIS.ADialog.info(n,null,"","")}}):VIS.ADialog.info(VIS.Msg.getMsg("VA012_NoRecordSelected"),null,"","")});gt.on("scroll",e.paymentScroll);nt.on("scroll",e.statementScroll);nt.on(VIS.Events.onTouchStartOrClick,a.statementListEdit);nt.on(VIS.Events.onTouchStartOrClick,a.openStatement);nt.on(VIS.Events.onTouchStartOrClick,a.selectedStatementLinesList);gt.on(VIS.Events.onTouchStartOrClick,a.selectedScheduleList);gt.on(VIS.Events.onTouchStartOrClick,function(n){n.target.type!="checkbox"&&(t(n.target).closest(".row").find(":checkbox").is(":checked")?t(n.target).closest(".row").find(":checkbox").prop("checked",!1):t(n.target).closest(".row").find(":checkbox").prop("checked",!0));i.getControl().trigger("blur")});rt.addClass("va012-mandatory");rt.on("change",function(){if(rt.val()=="")rt.addClass("va012-mandatory");else{if(new Date(rt.val())>new Date)return VIS.ADialog.info(VIS.Msg.getMsg("VA012_StatementDateToday"),null,"",""),rt.val(""),!1;rt.removeClass("va012-mandatory")}storepaymentdata=[];e.loadPayments(s.val()==null?0:s.val(),ut.val(),b.val(),rt.val())})}function ye(n){t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA012/BankStatement/getMatchRecData",contentType:"application/json; charset=utf-8",success:function(t){if(n.html(""),n.append("<option value=0 >-<\/option>"),t=JSON.parse(t),t!=null&&t.length>0)for(var i=0;i<t.length;i++)n.append("<option value="+t[i].Value+">"+t[i].Name+"<\/option>")},error:function(n){VIS.ADialog.info(n,null,"","")}})}function fe(n,t){w2ui["VA012_gridPayment_"+$self.windowNo]!=null&&w2ui["VA012_gridPayment_"+$self.windowNo].destroy();var i=null;i=n.w2grid({name:"VA012_gridPayment_"+$self.windowNo,recordHeight:25,show:{toolbar:!1,selectColumn:!1,toolbarReload:!1,toolbarColumns:!1,toolbarSearch:!1,toolbarAdd:!1,toolbarDelete:!1,toolbarSave:!1},records:[],columns:[{field:"_trxDate",caption:"Tran. Date",sortable:!1,size:"80px",display:!1},{field:"_trxNo",caption:"Auth Code/ Trx no.",sortable:!1,size:"30%",hidden:!1},{field:"_salesAmt",caption:"Trx Amount",sortable:!1,size:"15%",hidden:!1,style:"text-align: right"},{field:"_netAmt",caption:"Statement Amount",sortable:!1,size:"15%",hidden:!1,style:"text-align: right"},{field:"_difference",caption:"Difference",sortable:!1,size:"15%",hidden:!1,style:"text-align: right"},{field:"_chargeType",caption:"Charge Type",sortable:!1,size:"80px",display:!0},{field:"_taxRate",caption:"Tax Rate",sortable:!1,size:"80px",display:!0},{field:"_taxAmt",caption:"Tax Amt",sortable:!1,size:"15%",hidden:!1,style:"text-align: right"},],onChange:function(){},onClick:function(){},onDelete:function(){},onSubmit:function(){}});i.add(t)}function nf(n,t){return t.indexOf(n)>-1}function ht(n,i,r){if(ou=t("<div class='vis-apanel-busy va012-busy-bank-statement'>"),ou.css({position:r,width:"95%",height:"95%","text-align":"center",visibility:"hidden"}),i)ou.css({visibility:"visible"});else{n.find(".va012-busy-bank-statement").remove();return}n.append(ou)}var o,e,a,f;this.windowNo;$self=this;o=t("<div/>");this.frame;var ou=null,fi=null,s=null,su=null,rt=null,tf=null,rf=null,ut=null,b=null,nt=null,gt=null,hu=null,ni="",ar=null,vr=null,dr=null,kf=null,oi=!1,st=[],tt=[],ri=[],d=[],rr=[],hr=[],uf=null,ff=null,ef=null,cu=null,lu=null,ui=0,c=2,ti=!1,si=!1,ei=1,ee=1,ii=1,of=50,df=50,au=0,vu=0,gf=null,h=null,yu=null,at=null,sf=null,ur=null,hi=null,ft=null,yi=null,ot=null,vi=null,pi=null,yr=null,w=null,i=null,l=null,p=null,ct=null,gr=null,fr=null,wi=null,v=null,k=null,et=null,pr=null,nu=null,er=null,tu=null,iu=null,ru=null,uu=null,wr=null,hf=null,ci=null,pu=null,it=null,cf=null,lf=null,oe=null,se=null,bi=null,or=null,ki=null,sr=null,vt=null,ne=null,br=null,li=null,yt=null,af=null,pt=null,wt=null,di=null,gi=null,nr=null,tr=null,ir=null,bt=null,vf=null,ai=null,te=null,wu=null,r=null,u=null,yf=0,bu=0,ie=null,kt=null,kr=null,pf=null,dt=null,ku=null,wf=null,g=null,cr=null,he=null,du=null,y=null,fu=null,bf=null,lt=null,lr=null;storepaymentdata=[];var gu=new Date,re=gu.getFullYear()+"-"+("0"+(gu.getMonth()+1)).slice(-2)+"-"+("0"+gu.getDate()).slice(-2),eu,ce,ue,le;this.Initialize=function(){ae(e.loadFormDesign());l.addVetoableChangeListener(this);et.addVetoableChangeListener(this);i.addVetoableChangeListener(this);p.addVetoableChangeListener(this)};e={loadFormDesign:function(){return _formDesign=t('<div class="va012-assign-content">'),divContainer=t('  <div id="VA012_mainContainer_'+$self.windowNo+'" class="va012-main-container">'),divTable=t('<table id="VA012_table_'+$self.windowNo+'" style="width: 100%;">'),tableTr=t("<tr>"),tableTd=t('<td id="VA012_tdLeft_'+$self.windowNo+'" style="width: 200px;position: relative;">   <div class="va012-left-part">              <div class="va012-left-title">                  <h4>    <i id="VA012_btnHide_'+$self.windowNo+'" class="fa fa-bars" alt="lines" style="cursor: pointer;background: rgba(var(--v-c-primary),1);"><\/i> <\/h4>              <\/div>              <div class="va012-left-content">                  <div class="va012-left-data">                      <label  id="VA012_lblBank_'+$self.windowNo+'" >'+VIS.Msg.getMsg("VA012_Bank")+'<sup style="color: red;">*<\/sup><\/label>                      <select id="VA012_cmbBank_'+$self.windowNo+'" ><\/select>                  <\/div>                  <!-- end of left-data -->                    <div class="va012-left-data">                      <label  id="VA012_lblBankAccount_'+$self.windowNo+'" >'+VIS.Msg.getMsg("VA012_BankAccount")+'<sup style="color: red;">*<\/sup><\/label>                      <select id="VA012_cmbBankAccount_'+$self.windowNo+'"   ><\/select>                  <\/div>                  <!-- end of left-data -->                  <div class="va012-left-data">                      <label  id="VA012_lblStatementDate_'+$self.windowNo+'" >'+VIS.Msg.getMsg("VA012_StatementDate")+'<sup style="color: red;">*<\/sup><\/label>                      <input type="date" max="9999-12-31" id="VA012_statementDate_'+$self.windowNo+'"   >                  <\/div>                  <!-- end of left-data -->                    <div class="va012-left-data">                      <a id="VA012_btnLoadStatement_'+$self.windowNo+'">'+VIS.Msg.getMsg("VA012_LoadStatement")+'<\/a>                      <a id="VA012_btnMatchStatement_'+$self.windowNo+'">'+VIS.Msg.getMsg("VA012_MatchStatement")+"<\/a>                  <\/div>                  <!-- end of left-data -->              <\/div>              <!-- end of left-content -->          <\/div>          <!-- end of left-part --> <\/td>"),tableTd1=t('<td style="position: relative;">'),contentDiv=t('<div id="VA012_contentArea_'+$self.windowNo+'" class="va012-content-area" style="position: absolute;" >'),divMidWrap=t('<div id="VA012_middleWrap_'+$self.windowNo+'" class="va012-middle-wrap">'),divtopWrap=t('<div class="va012-mid-top-wrap" id="VA012_formBtnNewRecord_'+$self.windowNo+'">                      <div class="va012-icons-wrap">                          <span>                              <i class="va012-undo vis vis-ignore" alt="undo" title="Undo" id="VA012_btnUndo_'+$self.windowNo+'"><\/i><\/span>                          <span>                              <i class="va012-hide-show-newform vis vis-plus" activestatus="0" alt="add" title = "Expand" id="VA012_btnNewRecord_'+$self.windowNo+'"><\/i><\/span>                      <\/div>                      <!-- end of icons-wrap -->                  <\/div>'),divformWrap=t('<div class="va012-form-wrap va012-newform" id="VA012_formNewRecord_'+$self.windowNo+'" data-uid="0" style="height:55%;overflow-y:auto;width:101%;">'),divRow1=t('<div class="row va012-fl-padd" style="width:102%">                          <div class="col-md-4 col-sm-4 va012-padd-0">                              <div class="va012-form-group va012-form-data">                                  <label>'+VIS.Msg.getMsg("VA012_StatementNumber")+' <sup style="color: red;">*<\/sup><\/label>                                  <input  tabindex="1" id="VA012_txtStatementNo_'+$self.windowNo+'" type="text" class="va012-input-size">                                  <i  id="VA012_btnStatementNo_'+$self.windowNo+'" class="fa fa-plus va012-add-icon"><\/i>                              <\/div>                              <!-- end of form-group -->                          <\/div>                          <!-- end of col -->                          <div class="col-md-4 col-sm-4 va012-padd-0">                              <div class="va012-form-group va012-form-data">                                  <label>'+VIS.Msg.getMsg("VA012_StatementPage")+'<\/label>                                  <input tabindex="2" value="1" id="VA012_txtStatementPage_'+$self.windowNo+'" type="text">                              <\/div>                              <!-- end of form-group -->                          <\/div>                          <!-- end of col -->                          <div class="col-md-4 col-sm-4 va012-padd-0">                              <div class="va012-form-group va012-form-data">                                  <label>'+VIS.Msg.getMsg("VA012_StatementLine")+'<\/label>                                  <input tabindex="3" value="10" id="VA012_txtStatementLine_'+$self.windowNo+'" type="text">                              <\/div>                              <!-- end of form-group -->                          <\/div>                          <!-- end of col -->                      <\/div>                      <!-- end of row -->  '),divRow2=t('<div class="row va012-fl-padd" style="width:102%">'),row2Col1=t('<div class="col-md-4 col-sm-4 va012-padd-0">                              <div class="va012-form-group va012-form-data">                                  <label>'+VIS.Msg.getMsg("VA012_StatementDate")+'<sup style="color: red;">*<\/sup><\/label>                                  <input tabindex="4" id="VA012_dtStatementDate_'+$self.windowNo+'" type="date" max="9999-12-31">                              <\/div>                              <!-- end of form-group -->                          <\/div>                          <!-- end of col -->'),row2Col2=t('<div class="col-md-4 col-sm-4 va012-padd-0">'),row2Col2divAmt=t('<div class="va012-form-group va012-form-data" >'),row2Col2Lble=t("<label>"+VIS.Msg.getMsg("VA012_Amount")+'<sup style="color: red;">*<\/sup><\/label>'),row2Col2btnIn=t('<a tabindex="5" id="VA012_btnIn_'+$self.windowNo+'" v_active="1" class="va012-inout-icon va012-active">In<\/a>'),row2Col2btnOut=t('<a tabindex="6" id="VA012_btnOut_'+$self.windowNo+'" v_active="0" class="va012-inout-icon va012-inactive">Out<\/a>'),i=new VIS.Controls.VAmountTextBox("VA012_txtAmount_"+$self.windowNo+"",!1,!1,!0,50,100,VIS.DisplayType.Amount,VIS.Msg.getMsg("Amount")),i.setValue(0),i.getControl().addClass("va012-input-size-amt va012-right-align va012-txtamount"),row2Col2btnIcon=t('<a id="VA012_btnAmount_'+$self.windowNo+'" class="va012-info-icon"><\/a>'),row2Col3=t('<div class="col-md-4 col-sm-4 va012-padd-0">                              <div class="va012-form-group va012-form-data">                                  <label>'+VIS.Msg.getMsg("VA012_VoucherMatch")+'<sup style="color: red;">*<\/sup><\/label>                                  <select tabindex="8" id="VA012_cmbVoucherMatch_'+$self.windowNo+'">                                  <\/select>                              <\/div>                              <!-- end of form-group -->                          <\/div>                          <!-- end of col -->                      <\/div>                      <!-- end of row -->  '),divRow3=t('                      <div class="row va012-fl-padd" style="width:102%">                          <div class="col-md-8 col-sm-8 va012-padd-0">                              <div class="va012-form-group va012-form-data">                                  <label>'+VIS.Msg.getMsg("VA012_Description")+'<\/label>                                  <input tabindex="9" id="VA012_txtDescription_'+$self.windowNo+'" type="text">                              <\/div>                              <!-- end of form-group -->                          <\/div>                          <!-- end of col -->                          <div class="col-md-4 col-sm-4 va012-padd-0">                              <div id="VA012_divVoucherNo_'+$self.windowNo+'" class="va012-form-group va012-form-data">                                  <label>'+VIS.Msg.getMsg("VA012_VoucherNo")+'<\/label>                                  <input tabindex="9" id="VA012_txtVoucherNo_'+$self.windowNo+'" type="text">                              <\/div>                              <!-- end of form-group -->                          <\/div>                          <!-- end of col -->                      <\/div>                      <!-- end of row -->  '),divRow4=t('<div class="row va012-fl-padd" style="width:102%">'),divRow4Col1=t('<div class="col-md-4 col-sm-4 va012-padd-0">'),divRow4Col1TrxAmt=t('<div id="VA012_divTrxAmt_'+$self.windowNo+'" class="va012-form-group va012-form-data">'),divRow4Col1Lbl=t("<label>"+VIS.Msg.getMsg("VA012_TrxAmt")+"<\/label>"),l=new VIS.Controls.VAmountTextBox("VA012_txtTrxAmt_"+$self.windowNo+"",!1,!0,!0,50,100,VIS.DisplayType.Amount,VIS.Msg.getMsg("Amount")),l.getControl().addClass("va012-right-align"),l.setValue(0..toFixed(c)),divRow4Col1TrxAmt.append(divRow4Col1Lbl).append(l.getControl()),divRow4Col1.append(divRow4Col1TrxAmt),divRow4Col2=t('<div class="col-md-4 col-sm-4 va012-padd-0">'),divRow4Col2Diff=t('<div id="VA012_divDifference_'+$self.windowNo+'" class="va012-form-group va012-form-data">'),divRow4Col2DiffLbl=t("<label>"+VIS.Msg.getMsg("VA012_Difference")+"<\/label>"),p=new VIS.Controls.VAmountTextBox("VA012_txtDifference_"+$self.windowNo+"",!1,!0,!0,50,100,VIS.DisplayType.Amount,VIS.Msg.getMsg("Amount")),p.getControl().addClass("va012-right-align"),p.setValue(0),divRow4Col2Diff.append(divRow4Col2DiffLbl).append(p.getControl()),divRow4Col2.append(divRow4Col2Diff),divRow4Col3=t('<div class="col-md-4 col-sm-4 va012-padd-0">'),divRow4Col3DiffType=t('<div id="VA012_divDifferenceType_'+$self.windowNo+'" class="va012-form-group va012-form-data">                                  <label>'+VIS.Msg.getMsg("VA012_DifferenceType")+'<\/label>                                  <select tabindex="9" id="VA012_cmbDifferenceType_'+$self.windowNo+'">                                  <\/select>                              <\/div>                              <!-- end of form-group -->'),divRow4Col3.append(divRow4Col3DiffType),divRow4.append(divRow4Col1).append(divRow4Col2).append(divRow4Col3),divRow5=t('<div class="row va012-fl-padd" style="width:102%">                              <div class="col-md-4 col-sm-4 va012-padd-0">                                  <div id="VA012_divContraType_'+$self.windowNo+'" class="va012-form-group va012-form-data">                                      <label>'+VIS.Msg.getMsg("VA012_ContraType")+'<\/label>                                      <select tabindex="10" id="VA012_cmbContraType_'+$self.windowNo+'">                                      <\/select>                                  <\/div>                                  <!-- end of form-group -->                              <\/div>                              <!-- end of col -->                              <div class="col-md-4 col-sm-4 va012-padd-0">                                  <div id="VA012_divCashBook_'+$self.windowNo+'" class="va012-form-group va012-form-data">                                      <label>'+VIS.Msg.getMsg("VA012_CashBook")+'<\/label>                                      <select tabindex="10" id="VA012_cmbCashBook_'+$self.windowNo+'">                                      <\/select>                                  <\/div>                                  <div id="VA012_divCtrlCashLine_'+$self.windowNo+'" class="va012-form-group va012-form-data">                                      <label>'+VIS.Msg.getMsg("VA012_CashJournalLine")+'<\/label>                                      <div id="VA012_ctrlCashLine_'+$self.windowNo+'" ><\/div>                                  <\/div>                                  <!-- end of form-group -->                              <\/div>                              <!-- end of col -->                              <div class="col-md-4 col-sm-4 va012-padd-0">                                  <div id="VA012_divCheckNo_'+$self.windowNo+'" class="va012-form-group va012-form-data">                                      <label>'+VIS.Msg.getMsg("VA012_CheckNo")+'<\/label>                                      <input  disabled tabindex="12" id="VA012_txtCheckNo_'+$self.windowNo+'" type="text">                                  <\/div>                                  <!-- end of form-group -->                              <\/div>                              <!-- end of col -->                          <\/div>                      <!-- end of row -->  '),divRow6=t('<div class="row va012-fl-padd" style="width:102%">'),divRow6Col1=t('<div class="col-md-4 col-sm-4 va012-padd-0">                                  <div id="VA012_divCharge_'+$self.windowNo+'" class="va012-form-group va012-form-data">                                      <label>'+VIS.Msg.getMsg("VA012_Charge")+'<\/label>                                      <div style=" position: relative; float: left; width: 100%; ">                                      <input tabindex="10" chargeid="" type="text" id="VA012_txtCharge_'+$self.windowNo+'" style=" width: 100%; ">                                      <img id="VA012_btnCharge_'+$self.windowNo+'" class="VA012-img-combo" alt="">                                     <\/div>                                  <\/div>                                  <!-- end of form-group -->                              <\/div>                              <!-- end of col -->'),divRow6Col2=t('<div class="col-md-4 col-sm-4 va012-padd-0">                                  <div id="VA012_divTaxRate_'+$self.windowNo+'" class="va012-form-group va012-form-data">                                      <label>'+VIS.Msg.getMsg("VA012_TaxRate")+'<\/label>                                      <select tabindex="11" id="VA012_cmbTaxRate_'+$self.windowNo+'">                                      <\/select>                                  <\/div>                                  <!-- end of form-group -->                              <\/div>                              <!-- end of col -->'),divRow6Col3=t('<div class="col-md-4 col-sm-4 va012-padd-0">'),divRow6Col3divTax=t('<div id="VA012_divTaxAmount_'+$self.windowNo+'" class="va012-form-group va012-form-data">'),divRow6Col3divTaxLbl=t("<label>"+VIS.Msg.getMsg("VA012_TaxAmount")+"<\/label>"),et=new VIS.Controls.VAmountTextBox("VA012_txtTaxAmount_"+$self.windowNo+"",!1,!1,!0,50,100,VIS.DisplayType.Amount,VIS.Msg.getMsg("Amount")),et.setValue(0),et.getControl().addClass("va012-right-align"),divRow6Col3divTax.append(divRow6Col3divTaxLbl).append(et.getControl()),divRow6Col3.append(divRow6Col3divTax),divRow6.append(divRow6Col1).append(divRow6Col2).append(divRow6Col3),divRow7=t('<div class="row va012-fl-padd" style="width:102%">                              <div class="col-md-4 col-sm-4 va012-padd-0">                                  <div id="VA012_divCtrlPayment_'+$self.windowNo+'" class="va012-form-group va012-form-data">                                      <label>'+VIS.Msg.getMsg("VA012_Payment")+'<\/label>                                      <div id="VA012_ctrlPayment_'+$self.windowNo+'" ><\/div>                                  <\/div>                                  <!-- end of form-group -->                              <\/div>                              <!-- end of col -->                              <div class="col-md-4 col-sm-4 va012-padd-0">                                  <div id="VA012_divCtrlInvoice_'+$self.windowNo+'" class="va012-form-group va012-form-data">                                      <label>'+VIS.Msg.getMsg("VA012_Invoice")+'<\/label>                                      <div id="VA012_ctrlInvoice_'+$self.windowNo+'" ><\/div>                                  <\/div>                                  <!-- end of form-group -->                              <\/div>                              <!-- end of col -->                              <div class="col-md-4 col-sm-4 va012-padd-0">                                  <div id="VA012_divCtrlBusinessPartner_'+$self.windowNo+'" class="va012-form-group va012-form-data">                                      <label>'+VIS.Msg.getMsg("VA012_BusinessPartner")+'<\/label>                                      <div id="VA012_ctrlBusinessPartner_'+$self.windowNo+'" ><\/div>                                  <\/div>                                  <!-- end of form-group -->                              <\/div>                              <!-- end of col -->                          <\/div>                      <!-- end of row -->  '),divRow8=t('<div class="row va012-fl-padd" style="width:102%">                          <div class="col-md-4 col-sm-4 va012-padd-0">                              <div id="VA012_divPaymentSchedule_'+$self.windowNo+'" class="va012-form-data" >                              <label>'+VIS.Msg.getMsg("VA012_PaymentSchedules")+'<\/label>                              <input disabled id="VA012_txtPaymentSchedule_'+$self.windowNo+'" type="text" class="va012-input-size">                              <a tabindex="13"  id="VA012_btnPaymentSchedule_'+$self.windowNo+'" class="va012-edit-icon"><\/a>                              <\/div>                              <!-- end of form-data -->                          <\/div>                          <!-- end of col -->                          <div class="col-md-4 col-sm-4 va012-padd-0">                              <div id="VA012_divPrepayOrder_'+$self.windowNo+'" class="va012-form-data" >                              <label>'+VIS.Msg.getMsg("VA012_PrepayOrders")+'<\/label>                              <div id="VA012_ctrlOrder_'+$self.windowNo+'" ><\/div>                              <\/div>                              <!-- end of form-data -->                          <\/div>                          <!-- end of col -->                      <\/div>                      <!-- end of row -->  '),divRow9=t('<div class="row va012-fl-padd" style="width:102%">                       <div class="col-md-4 col-sm-4 va012-padd-0">                              <div class="va012-form-group va012-form-check">                                  <input tabindex="13" id="VA012_chkUseNextTime_'+$self.windowNo+'" type="checkbox">                                  <label style="position: absolute;">'+VIS.Msg.getMsg("VA012_UseNextTime")+'<\/label>                              <\/div>                              <!-- end of form-group -->                          <\/div>                          <!-- end of col -->                          <div class="col-md-2 col-sm-2 va012-padd-0" >                              <div class="va012-form-data" id="VA012_divMore_'+$self.windowNo+'">                                  <a tabindex="14" visiblestatus="0" class="va012-more" id="VA012_btnMore_'+$self.windowNo+'" href="#">'+VIS.Msg.getMsg("VA012_More")+'<\/a>                              <\/div>                              <!-- end of form-data -->                          <\/div>                          <!-- end of col -->                          <div class="col-md-6 col-sm-6 va012-padd-0" >                          <div style="float:right;">                              <a tabindex="15" title="Save Record" id="VA012_btnSave_'+$self.windowNo+'" class="va012-frm-btn va012-btn-blue" style=" float: left;">'+VIS.Msg.getMsg("VA012_SaveandNew")+"<\/a>                          <\/div>                          <\/div>                          <!-- end of col -->                      <\/div>                      <!-- end of row -->"),payHeaderWrap=t('<div id="VA012_paymentHeaderWrap_'+$self.windowNo+'" class="va012-payment-header-wrap">                          <div class="pull-left">                              <a class="va012-frm-btn va012-btn-gray" style="cursor: default;">'+VIS.Msg.getMsg("VA012_UpcomingTransactions")+'<\/a>                          <\/div>                      <div style=" float: right; width: 60%; ">                           <div class="va012-width-30" style=" float: left; width: 49%; ">                              <select id="VA012_cmbTransactionType_'+$self.windowNo+'">                             <option value="PY">'+VIS.Msg.getMsg("VA012_Payments")+'<\/option>                             <option value="PO">'+VIS.Msg.getMsg("VA012_PrepayOrders")+'<\/option>                              <option value="IS">'+VIS.Msg.getMsg("VA012_InvoiceSchedule")+'<\/option>                              <option value="CO">'+VIS.Msg.getMsg("VA012_Contra")+'<\/option>                              <\/select>                          <\/div>                          <div class="va012-width-30" style=" float: right; width: 49%; ">                              <select id="VA012_cmbSearchPaymentMethod_'+$self.windowNo+'">                              <\/select>                          <\/div>                          <\/div>                      <\/div>                      <!-- end of payment-header-wrap -->                  <div id="VA012_paymentList_'+$self.windowNo+'" class="va012-payment-list">                                           <div class="va012-payment-content" id="VA012_lstPayments_'+$self.windowNo+'">                   <\/div>                  <\/div>                  <!-- end of payment-list -->                <\/div>'),rightWrap=t('<div id="VA012_rightWrap_'+$self.windowNo+'" class="va012-right-wrap">                  <div id="VA012_rightTop_'+$self.windowNo+'" class="va012-right-top">                      <div class="row">                          <div class="col-md-3 col-sm-3" style=" padding-right: 5px; ">                              <div class="va012-pay-text" id="VA012_secReconciled_'+$self.windowNo+'" >                                <p>'+VIS.Msg.getMsg("VA012_Reconciled")+'<\/p>                                <p style="margin-top: 4px;">'+VIS.Msg.getMsg("VA012_Unreconciled")+'<\/p>                              <\/div>                          <\/div>                          <!-- end of col -->                          <div class="col-md-9 col-sm-9" style=" padding-left: 5px; ">                              <div class="va012-pay-text" id="VA012_secUnreconciled_'+$self.windowNo+'">                                <span style="padding-bottom: 2px;" class="va012-amount va012-font-green"><span class="va012-base-curr"><\/span> 0<\/span>                                <span style="padding-bottom: 2px;" class="va012-amount va012-font-red"><span class="va012-base-curr"><\/span> 0<\/span>                              <\/div>                          <\/div>                          <!-- end of col -->                      <\/div>                      <!-- end of row -->                      <div class="row">                          <div class="col-md-12 col-sm-12" style=" padding-left: 5px; ">                      <div style=" /* float: right; */ padding-left: 10px;">                               <a id="VA012_btnUnmatch_'+$self.windowNo+'" class="va012-frm-btn va012-btn-blue" title="Show Unmatched Record" style=" float: left; ">'+VIS.Msg.getMsg("VA012_Unmatch")+'<\/a>                              <a id="VA012_btnProcess_'+$self.windowNo+'" class="va012-frm-btn va012-btn-blue" title="Clear Matched Record" style=" float: left; margin-left: 5px; ">'+VIS.Msg.getMsg("VA012_Process")+'<\/a>                             <a id="VA012_btnDelete_'+$self.windowNo+'" class="va012-frm-btn va012-btn-blue" title="Delete Selected Record" style=" float: left; margin-left: 5px; ">'+VIS.Msg.getMsg("VA012_Delete")+'<\/a>                       <\/div>                           <\/div>                          <!-- end of col -->                      <\/div>                      <!-- end of row -->                     <div class="row">                          <div class="col-md-12 col-sm-12" style=" padding-right: 5px; ">                           <div class="va012-right-search">                            <div class="va012-search-wrap">                               <input id="VA012_txtSearch_'+$self.windowNo+'" value="" placeholder="'+VIS.Msg.getMsg("VA012_Search")+'..." type="text">                               <a id="VA012_btnSearch_'+$self.windowNo+'" class="va012-search-icon"><span class="glyphicon glyphicon-search"><\/span><\/a>                          <\/div>                      <!-- end of search-wrap -->                         <\/div>                  <!-- end of right-search -->                        <\/div>                       <!-- end of col -->                      <\/div>                      <!-- end of row -->                     <\/div>                  <!-- end of right-top -->                    <div class="va012-right-content" id="VA012_lstStatement_'+$self.windowNo+'">                  <\/div>                  <!-- end of right-content -->              <\/div>'),row2Col2divAmt.append(row2Col2Lble).append(row2Col2btnIn).append(row2Col2btnOut).append(i.getControl()).append(row2Col2btnIcon),row2Col2.append(row2Col2divAmt),divRow2.append(row2Col1).append(row2Col2).append(row2Col3),divformWrap.append(divRow1).append(divRow2).append(divRow3).append(divRow4).append(divRow5).append(divRow6).append(divRow7).append(divRow8).append(divRow9),divMidWrap.append(divtopWrap).append(divformWrap).append(payHeaderWrap),contentDiv.append(divMidWrap).append(rightWrap),tableTd1.append(contentDiv),tableTr.append(tableTd).append(tableTd1),eu=t('<div  id="VA012_gridMatchStatePopUp_'+$self.windowNo+'"" style="display:block;width:auto;height:auto"><div  style="    width: 50%;float: left;" ><label>'+VIS.Msg.getMsg("VA012_ChargeType")+'<\/label><div  id="VA012_ChargeSrch_'+$self.windowNo+'"><\/div><\/div><div ><label>'+VIS.Msg.getMsg("VA012_Taxrate")+'<\/label><select  id="VA012_cmbTaxRate_'+$self.windowNo+'"><\/select><\/div><div style="width:auto;height:270px" id="VA012_gridMatchState_'+$self.windowNo+'""><\/div><\/div>'),ce=eu.find("#VA012_gridMatchState_"+$self.windowNo),ue=eu.find("#VA012_ChargeSrch_"+$self.windowNo),le=eu.find("#VA012_cmbTaxRate_"+$self.windowNo),_ChargeLookUp=VIS.MLookupFactory.getMLookUp(VIS.Env.getCtx(),$self.windowNo,3787,VIS.DisplayType.Search),$ChargeControl=new VIS.Controls.VTextBoxButton("C_Charge_ID",!0,!1,!0,VIS.DisplayType.Search,_ChargeLookUp),ue.append($ChargeControl.getControl().css("width","93%")).append($ChargeControl.getBtn(0).css("width","30px").css("height","30px").css("padding","0px").css("border-color","#BBBBBB")),divTable.append(tableTr),_formDesign.append(divContainer).append(divTable),_formDesign},setBankAndAccount:function(){t.ajax({url:VIS.Application.contextUrl+"BankStatement/SetBankAndAccount",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",success:function(n){n!=null&&n!=""&&(n=t.parseJSON(n),n!=null&&(vu=n.Table[0].C_BANK_ID,au=n.Table[0].C_BANKACCOUNT_ID));e.loadBank()}})},addEffect:function(n,t,i){var r={to:t,className:"wsp-ui-effects-transfer"};n.effect("transfer",r,600,i)},setInvoiceAndBPartner:function(n,i){t.ajax({url:VIS.Application.contextUrl+"BankStatement/SetInvoiceAndBPartner",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",data:{_paymentID:n,_cmbTransactionType:i},success:function(n){if(n!=null&&n!="")if(n=t.parseJSON(t.parseJSON(n)),i=="PY"){n._invoiceID>0?lt.setValue(n._invoiceID,!1,!0):lt.setValue();n._bPartnerID>0?y.setValue(n._bPartnerID,!1,!0):y.setValue();var r=VIS.DB.executeScalar("SELECT COUNT(*) FROM AD_ModuleInfo WHERE Prefix='VA034_' AND IsActive='Y'");r==1&&n.VA034_DepositSlipNo!=""&&fr.val(n.VA034_DepositSlipNo)}else i=="PO"?y.value||y.setValue(n._bPartnerID,!1,!0):i=="IS"&&(y.value||y.setValue(n._bPartnerID,!1,!0))}})},setBPartner:function(n){t.ajax({url:VIS.Application.contextUrl+"BankStatement/SetBPartner",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",data:{_invoiceID:n},success:function(n){n!=null&&n!=""&&(n=t.parseJSON(n),n>0?y.setValue(n,!1,!0):y.setValue())}})},getMaxStatement:function(n){t.ajax({url:VIS.Application.contextUrl+"BankStatement/MaxStatement",type:"GET",datatype:"json",data:{_bankAccount:s.val()==null?0:s.val(),_origin:n},contentType:"application/json; charset=utf-8",success:function(n){n!=null&&n!=""&&(n=t.parseJSON(t.parseJSON(n)),at.val(n.statementNo),ur.val(n.pageno),hi.val(n.lineno))}})},getOverUnderPayment:function(n){t.ajax({url:VIS.Application.contextUrl+"BankStatement/getOverUnderPayment",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",data:{_paymentID:n},success:function(n){n!=null&&n!=""&&(n=t.parseJSON(t.parseJSON(n)),n._difference!=0&&(p.setValue(VIS.Utility.Util.getValueOfDecimal(Math.abs(n._difference))),li.find("*").prop("disabled",!1),ct.val(n._differenceType).prop("selected",!0),p.getControl().attr("vchangable","N"),w.val()=="M"&&l.setValue(VIS.Utility.Util.getValueOfDecimal(n._payamt.toFixed(c)))))}})},getControls:function(){fi=o.find("#VA012_cmbBank_"+$self.windowNo);s=o.find("#VA012_cmbBankAccount_"+$self.windowNo);su=o.find("#VA012_STAT_cmbBankAccountClassName_"+$self.windowNo);rt=o.find("#VA012_statementDate_"+$self.windowNo);gf=o.find("#VA012_BankChargeDiv"+$self.windowNo);ut=o.find("#VA012_cmbSearchPaymentMethod_"+$self.windowNo);b=o.find("#VA012_cmbTransactionType_"+$self.windowNo);tf=o.find("#VA012_btnLoadStatement_"+$self.windowNo);rf=o.find("#VA012_btnMatchStatement_"+$self.windowNo);nt=o.find("#VA012_lstStatement_"+$self.windowNo);gt=o.find("#VA012_lstPayments_"+$self.windowNo);hu=o.find("#VA012_paymentList_"+$self.windowNo);ar=o.find("#VA012_secReconciled_"+$self.windowNo);vr=o.find("#VA012_secUnreconciled_"+$self.windowNo);bt=o.find("#VA012_txtSearch_"+$self.windowNo);vf=o.find("#VA012_btnSearch_"+$self.windowNo);uf=o.find("#VA012_btnUnmatch_"+$self.windowNo);ff=o.find("#VA012_btnProcess_"+$self.windowNo);ef=o.find("#VA012_btnHide_"+$self.windowNo);cu=o.find("#VA012_tdLeft_"+$self.windowNo);lu=o.find("#VA012_table_"+$self.windowNo);ai=o.find("#VA012_btnMore_"+$self.windowNo);te=o.find("#VA012_divMore_"+$self.windowNo);bi=o.find("#VA012_divContraType_"+$self.windowNo);or=o.find("#VA012_divCashBook_"+$self.windowNo);_divCtrlCashLine=o.find("#VA012_divCtrlCashLine_"+$self.windowNo);ki=o.find("#VA012_divTransferType_"+$self.windowNo);sr=o.find("#VA012_divCheckNo_"+$self.windowNo);vt=o.find("#VA012_divVoucherNo_"+$self.windowNo);ne=o.find("#VA012_divTrxAmt_"+$self.windowNo);br=o.find("#VA012_divDifference_"+$self.windowNo);li=o.find("#VA012_divDifferenceType_"+$self.windowNo);yt=o.find("#VA012_divCharge_"+$self.windowNo);af=o.find("#VA012_btnCharge_"+$self.windowNo);pt=o.find("#VA012_divTaxRate_"+$self.windowNo);wt=o.find("#VA012_divTaxAmount_"+$self.windowNo);di=o.find("#VA012_divCtrlPayment_"+$self.windowNo);gi=o.find("#VA012_divCtrlInvoice_"+$self.windowNo);nr=o.find("#VA012_divCtrlBusinessPartner_"+$self.windowNo);tr=o.find("#VA012_divPrepayOrder_"+$self.windowNo);ir=o.find("#VA012_divPaymentSchedule_"+$self.windowNo)},getBaseCurrency:function(){t.ajax({url:VIS.Application.contextUrl+"BankStatement/GetBaseCurrency",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",success:function(n){n!=null&&n!=""&&(n=t.parseJSON(t.parseJSON(n)),dr=n._code,kf=n._id,t(".va012-base-curr").text(dr))}})},loadBank:function(){function n(n){if(fi.html(""),fi.append("<option value=0 ><\/option>"),n!=null)for(var t=0;t<n.length;t++)fi.append("<option value="+VIS.Utility.Util.getValueOfInt(n[t].Value)+">"+n[t].Name+"<\/option>");fi.prop("selectedIndex",0);vu>0&&(fi.val(vu).prop("selected",!0),vu=0);e.loadBankAccount()}t.ajax({url:VIS.Application.contextUrl+"BankStatement/GetBank",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",success:function(i){i!=null&&i!=""&&(_ds=t.parseJSON(i),n(_ds))}})},loadBankAccount:function(){function t(t){if(s.html(""),s.append("<option value=0 ><\/option>"),t!=null)for(var i=0;i<t.tables[0].rows.length;i++)s.append("<option value="+VIS.Utility.Util.getValueOfInt(t.tables[0].rows[i].cells.c_bankaccount_id)+">"+VIS.Utility.encodeText(t.tables[0].rows[i].cells.accountno)+"<\/option>");t.dispose();t=null;n=null;s.prop("selectedIndex",0);au>0&&(s.val(au).prop("selected",!0),au=0);e.getMaxStatement("LO");e.loadSearchPaymentMethod()}var n="SELECT ACCOUNTNO,C_BANKACCOUNT_ID FROM C_BANKACCOUNT WHERE ISACTIVE='Y' AND C_BANK_ID="+fi.val(),i=VIS.DB.executeDataSet(n.toString(),null,t)},LoadPaymentsPages:function(n,i,r){oi=bt.val()!=null&&bt.val()!=""?!0:!1;t.ajax({url:VIS.Application.contextUrl+"BankStatement/LoadPaymentsPages",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:{_accountID:n,_paymentPageNo:ei,_PAGESIZE:df,_paymentMethodID:i,_transactionType:r},success:function(n){n!=null&&n!=""&&(bu=JSON.parse(n))}})},loadPayments:function(n,i,r,u){function f(n){var u,i,f,o,s;if(n=t.parseJSON(n),n.length>0&&(storepaymentdata=storepaymentdata.concat(n)),n=storepaymentdata,u="",gt.html(""),n!=null&&n.length>0)for(i=0;i<n.length;i++)f=new Date(n[i].DateAcct).toLocaleDateString(),o="va012-red-color",o=n[i].c_bankstatementline_id==null||n[i].c_bankstatementline_id=="0"||n[i].c_bankstatementline_id==0?"va012-red-color":"va012-green-color",u="",u='<div class="drag-no-drag"><div draggable="true" class="va012-mid-data-wrap ',(r=="PY"||r=="CO")&&(u+=o),u+=' " paymentdata="'+VIS.Utility.encodeText(new Date(n[i].DueDate).toLocaleDateString())+"_"+VIS.Utility.encodeText(n[i].DueAmt)+'" data-uid="'+n[i].c_payment_id,u+=' " paymentamount = " '+VIS.Utility.Util.getValueOfDecimal(n[i].convertedamount,"N")+'"><div class="va012-payment-wrap" ><div class="row"> <div class="col-md-3 col-sm-3">    <div class="va012-form-check">        <input type="checkbox" data-uid="'+n[i].c_payment_id+'"  >    <div title="'+VIS.Msg.getMsg("VA012_PaymentAmount")+'" class="va012-inside-form-check" style=" float: left; width: 85%; ">      <label style=" width: 100%; ">'+n[i].currency+" "+parseFloat(n[i].paymentamount).toLocaleString(navigator.language,{minimumFractionDigits:c,maximumFractionDigits:c})+"<\/label>",n[i].isconverted=="Y"&&(u+="      <span>"+n[i].basecurrency+" "+parseFloat(n[i].convertedamount).toLocaleString(navigator.language,{minimumFractionDigits:c,maximumFractionDigits:c})+"<\/span>"),u+='   <\/div><\/div>    <!-- end of form-group -->  <\/div>  <!-- end of col -->  <div class="col-md-4 col-sm-4">     <div class="va012-form-check">         <div class="va012-pay-text">           <p title="Business Partner">'+VIS.Utility.encodeText(n[i].businesspartner)+'<\/p>         <span title="'+VIS.Msg.getMsg("VA012_InvReference")+'">'+VIS.Utility.encodeText(n[i].bpgroup)+'<\/span>       <span title="Document No.">'+VIS.Utility.encodeText(n[i].paymentno)+'<\/span>  <\/div> <\/div><!-- end of form-group --><\/div><!-- end of col --> <div class="col-md-2 col-sm-2">     <div class="va012-form-check">         <div class="va012-pay-text"><p title="Payment Type">'+VIS.Utility.encodeText(n[i].paymenttype)+"<\/p><\/div><\/div><!-- end of form-group --><\/div><!-- end of col -->",s=VIS.Utility.Util.getValueOfInt(VIS.DB.executeScalar("SELECT Count(AD_ModuleInfo_ID) FROM AD_ModuleInfo WHERE PREFIX='VA034_' AND IsActive = 'Y'")),u+=r=="PY"&&s>0?'  <div class="col-md-2 col-sm-2">     <div class="va012-form-check">         <div class="va012-pay-text">           <p title="Deposit Slip No">'+VIS.Utility.encodeText(n[i].depositslipno)+'<\/p>           <p title="Authentication Code">'+VIS.Utility.encodeText(n[i].authcode)+'<\/p>           <p title="Account Date">'+f+'<\/p>           <p title="Payment Method">'+n[i].PaymentMethod+"<\/p>  <\/div> <\/div><!-- end of form-group --><\/div><!-- end of col -->":'  <div class="col-md-2 col-sm-2">     <div class="va012-form-check">         <div class="va012-pay-text">           <p title="Authentication Code">'+VIS.Utility.encodeText(n[i].authcode)+'<\/p>           <p title="Account Date">'+f+'<\/p>           <p title="Payment Method">'+n[i].PaymentMethod+"<\/p>  <\/div> <\/div><!-- end of form-group --><\/div><!-- end of col -->",u+="<\/div><!-- end of row --><\/div> <!-- end of payment-wrap --><\/div> <!-- end of mid-data-wrap -->",gt.append(u);_sql=null;e.setPaymentListHeight();e.dragPayments()}ht(t(hu),!0,"inherit");window.setTimeout(function(){t.ajax({url:VIS.Application.contextUrl+"BankStatement/LoadPayments",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",data:{_accountID:n,_paymentPageNo:ei,_PAGESIZE:of,_paymentMethodID:i,_transactionType:r,statementDate:u==null||u==""?new Date:u},success:function(n){n!=null&&n!=""&&(f(n),ht(t(hu),!1,"inherit"))},error:function(){ht(t(hu),!1,"inherit")}})},2)},setPaymentListHeight:function(){var n;clearTimeout(n);n=setTimeout(function(){t("#VA012-content-area"+$self.windowNo).height(t("#VA012_mainContainer_"+$self.windowNo).height()-20);it.attr("activestatus")=="1"?t("#VA012_paymentList_"+$self.windowNo).height(t("#VA012_middleWrap_"+$self.windowNo).height()-t("#VA012_formBtnNewRecord_"+$self.windowNo).height()-t("#VA012_formNewRecord_"+$self.windowNo).height()-t("#VA012_paymentHeaderWrap_"+$self.windowNo).height()-42):t("#VA012_paymentList_"+$self.windowNo).height(t("#VA012_middleWrap_"+$self.windowNo).height()-t("#VA012_formBtnNewRecord_"+$self.windowNo).height()-t("#VA012_paymentHeaderWrap_"+$self.windowNo).height()-27)},2)},loadSearchPaymentMethod:function(){function i(t){if(ut.html(""),ut.append("<option value=0 >"+VIS.Msg.getMsg("VA012_SelectPaymentMethod")+"<\/option>"),t!=null)for(var i=0;i<t.tables[0].rows.length;i++)ut.append("<option value="+VIS.Utility.Util.getValueOfInt(t.tables[0].rows[i].cells.va009_paymentmethod_id)+">"+VIS.Utility.encodeText(t.tables[0].rows[i].cells.va009_name)+"<\/option>");t.dispose();t=null;n=null;ut.prop("selectedIndex",0);s.trigger("change")}var n="SELECT VA009_NAME,VA009_PAYMENTMETHOD_ID FROM VA009_PAYMENTMETHOD WHERE ISACTIVE='Y' AND VA009_PAYMENTBASETYPE!='B' AND AD_CLIENT_ID="+VIS.Env.getCtx().getAD_Client_ID(),t;VIS.Env.getCtx().getAD_Org_ID()!=0&&(n+=" AND AD_ORG_ID IN( "+VIS.Env.getCtx().getAD_Org_ID()+",0)");t=VIS.DB.executeDataSet(n.toString(),null,i)},paymentScroll:function(){bu=0;t(this).scrollTop()+t(this).innerHeight()+2>=this.scrollHeight&&(e.LoadPaymentsPages(s.val(),ut.val(),b.val()),ei<bu&&(ei++,e.loadPayments(s.val(),ut.val(),b.val(),rt.val())))},statementScroll:function(){yf=0;t(this).scrollTop()>0&&t(this).scrollTop()+t(this).innerHeight()+1>=this.scrollHeight&&(a.LoadStatementsPages(),ii<yf&&(ii++,a.loadStatement(ni)))},dragPayments:function(){gt.find(".va012-mid-data-wrap").draggable({start:function(n,t){t.helper.addClass("va012-dragging")},drag:function(){},stop:function(n,t){t.helper.removeClass("va012-dragging")},cursor:"move",cursorAt:{left:5},revert:"invalid",helper:"clone"})},dropPayments:function(){nt.find(".va012-right-data-wrap").droppable({hoverClass:"va012-dropping",drop:function(n,o){var w,v,y,s,p;if(t(o.draggable).data("uid")>0&&t(this).data("uid")>0){if(b.val()=="PY"){if(s=t(o.draggable).data("uid"),t(o.draggable).hasClass("va012-green-color")){VIS.ADialog.info(VIS.Msg.getMsg("VA012_PaymentAlreadyMatchedOthrStatement"),null,"","");return}p=t(this).data("uid");e.checkPaymentCondition(t(o.draggable).data("uid"),t(this).data("uid"),i.getValue())&&(a.statementOpenEdit(t(this).data("uid"),s),window.setTimeout(function(){ti=!0;g.setValue(s,!1,!0);e.setInvoiceAndBPartner(t(o.draggable).data("uid"),"PY");ti=!1},200))}else if(b.val()=="IS"){if(w=t(o.draggable).data("uid"),parseInt(h.attr("data-uid"))!=t(this).data("uid")&&f.scheduleRefresh(),e.checkScheduleCondition(t(o.draggable).data("uid"),t(this).data("uid"),tt.toString(),i.getValue())){if(nf(parseInt(t(o.draggable).data("uid")),tt))VIS.ADialog.info(VIS.Msg.getMsg("VA012_AlreadySelected"),null,"","");else if(tt.push(parseInt(t(o.draggable).data("uid"))),ri.push(t(o.draggable).attr("paymentdata")),d.push(t(o.draggable).attr("paymentamount")),Number(d[0])=="0"){for(v=0,y=0;y<d.length;y++)v+=VIS.Utility.Util.getValueOfDecimal(d[y]);v<0?(u.removeClass("va012-inactive"),u.addClass("va012-active"),u.attr("v_active","1"),r.removeClass("va012-active"),r.addClass("va012-inactive"),r.attr("v_active","0")):(r.removeClass("va012-inactive"),r.addClass("va012-active"),r.attr("v_active","1"),u.removeClass("va012-active"),u.addClass("va012-inactive"),u.attr("v_active","0"));i.setValue(VIS.Utility.Util.getValueOfDecimal(v.toFixed(c)))}ti=!0;a.statementOpenEdit(t(this).data("uid"),w);e.setInvoiceAndBPartner(t(o.draggable).data("uid"),"IS");ci.val(ri.toString());window.setTimeout(function(){for(var t=0,n=0;n<d.length;n++)t+=VIS.Utility.Util.getValueOfDecimal(d[n]);l.setValue(VIS.Utility.Util.getValueOfDecimal(t.toFixed(c)));l.getControl().trigger("blur")},200)}}else b.val()=="PO"&&(parseInt(h.attr("data-uid"))!=t(this).data("uid")&&f.prepayRefresh(),e.checkPrepayCondition(t(o.draggable).data("uid"),t(this).data("uid"),rr.toString(),i.getValue())&&(a.statementOpenEdit(t(this).data("uid")),window.setTimeout(function(){ti=!0;kt.setValue(t(o.draggable).data("uid"),!1,!0);e.setInvoiceAndBPartner(t(o.draggable).data("uid"),"PO");ti=!1},200)));if(b.val()=="CO"){if(s=t(o.draggable).data("uid"),t(o.draggable).hasClass("va012-green-color")){VIS.ADialog.info(VIS.Msg.getMsg("VA012_CashLineAlreadyMatchedOthrStmt"),null,"","");return}p=t(this).data("uid");e.checkContraCondition(t(o.draggable).data("uid"),t(this).data("uid"),i.getValue())&&(a.statementOpenEdit(t(this).data("uid")),window.setTimeout(function(){ti=!0;dt.setValue(s,!1,!0);ti=!1},200))}}}});h.droppable({hoverClass:"va012-dropping",drop:function(n,f){var h,o,a;if(t(f.draggable).data("uid")>0){if(b.val()=="CO")if(w.val()=="C"){if(ot.val()!="CB"){VIS.ADialog.info(VIS.Msg.getMsg("VA012_ContraSelectCashToBank"),null,"","");return}}else{VIS.ADialog.info(VIS.Msg.getMsg("VA012_SelectVoucherContra"),null,"","");return}else if(w.val()!="M"){VIS.ADialog.info(VIS.Msg.getMsg("VA012_SelectVoucherPayment"),null,"","");return}if(b.val()=="PY"){if(t(f.draggable).hasClass("va012-green-color")){VIS.ADialog.info(VIS.Msg.getMsg("VA012_PaymentAlreadyMatchedOthrStatement"),null,"","");return}t(f.draggable).data("uid")>0&&e.checkPaymentCondition(t(f.draggable).data("uid"),t(this).attr("data-uid"),i.getValue())&&g.setValue(t(f.draggable).data("uid"),!1,!0)}if(b.val()=="IS"&&e.checkScheduleCondition(t(f.draggable).data("uid"),t(this).attr("data-uid"),tt.toString(),i.getValue())){if(o=0,nf(parseInt(t(f.draggable).data("uid")),tt)){VIS.ADialog.info("VA012_AlreadySelected",null,"","");return}if(h=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"BankStatement/GetConvtAmount",{recordID:parseInt(t(f.draggable).data("uid")),bnkAct_Id:s.val(),transcType:b.val(),stmtDate:ft.val()}),h.length==0||h[0].DueAmount==0){VIS.ADialog.info("VA012_ConversionRateNotFound",null,"","");return}if(tt.push(parseInt(t(f.draggable).data("uid"))),ri.push(t(f.draggable).attr("paymentdata")),d.push(h[0].DueAmount),o=0,Number(d.length)>0)for(a=0;a<d.length;a++)o+=VIS.Utility.Util.getValueOfDecimal(d[a]);o<0?(u.removeClass("va012-inactive"),u.addClass("va012-active"),u.attr("v_active","1"),r.removeClass("va012-active"),r.addClass("va012-inactive"),r.attr("v_active","0")):(r.removeClass("va012-inactive"),r.addClass("va012-active"),r.attr("v_active","1"),u.removeClass("va012-active"),u.addClass("va012-inactive"),u.attr("v_active","0"));i.setValue(VIS.Utility.Util.getValueOfDecimal(o.toFixed(c)));e.setInvoiceAndBPartner(t(f.draggable).data("uid"),"IS");ci.val(ri.toString());l.setValue(VIS.Utility.Util.getValueOfDecimal(o.toFixed(c)));l.getControl().trigger("blur")}if(b.val()=="PO"&&e.checkPrepayCondition(t(f.draggable).data("uid"),t(this).attr("data-uid"),rr.toString(),i.getValue())&&(kt.setValue(t(f.draggable).data("uid"),!1,!0),e.setInvoiceAndBPartner(t(f.draggable).data("uid"),"PO")),b.val()=="CO"&&t(f.draggable).data("uid")>0){if(t(f.draggable).hasClass("va012-green-color")){VIS.ADialog.info("VA012_CashLineAlreadyMatchedOthrStmt",null,"","");return}e.checkContraCondition(t(f.draggable).data("uid"),t(this).attr("data-uid"),i.getValue())&&dt.setValue(t(f.draggable).data("uid"),!1,!0)}}ti=!1}})},checkFormPaymentCondition:function(n,f){var e=!1;return t.ajax({url:VIS.Application.contextUrl+"BankStatement/CheckFormPaymentCondition",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:{_paymentID:n,_amount:f},success:function(n){n=t.parseJSON(n);n._status=="Success"?(e=!0,n._amount!=null&&n._amount!=0&&(i.setValue(VIS.Utility.Util.getValueOfDecimal(n._amount.toFixed(c))),i.getValue()<0?(u.removeClass("va012-inactive"),u.addClass("va012-active"),u.attr("v_active","1"),r.removeClass("va012-active"),r.addClass("va012-inactive"),r.attr("v_active","0")):(r.removeClass("va012-inactive"),r.addClass("va012-active"),r.attr("v_active","1"),u.removeClass("va012-active"),u.addClass("va012-inactive"),u.attr("v_active","0")))):(VIS.ADialog.info(n._status,null,"",""),e=!1)},error:function(){VIS.ADialog.info("error",null,"","");e=!1}}),e},checkFormPrepayCondition:function(n,f){var o=0,e;return y.value&&(o=y.value),e=!1,t.ajax({url:VIS.Application.contextUrl+"BankStatement/CheckFormPrepayCondition",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:{_orderID:n,_amount:f,_currencyId:ui,_formBPartnerID:o},success:function(n){n=t.parseJSON(n);n._status=="Success"?(e=!0,n._amount>0&&(i.setValue(VIS.Utility.Util.getValueOfDecimal(n._amount.toFixed(c))),i.getValue()<0?(u.removeClass("va012-inactive"),u.addClass("va012-active"),u.attr("v_active","1"),r.removeClass("va012-active"),r.addClass("va012-inactive"),r.attr("v_active","0")):(r.removeClass("va012-inactive"),r.addClass("va012-active"),r.attr("v_active","1"),u.removeClass("va012-active"),u.addClass("va012-inactive"),u.attr("v_active","0")))):(VIS.ADialog.info(n._status,null,"",""),e=!1)},error:function(){VIS.ADialog.info("error",null,"","");e=!1}}),e},checkInvoiceCondition:function(n,i){var r=!1;return t.ajax({url:VIS.Application.contextUrl+"BankStatement/CheckInvoiceCondition",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:{_invoiceID:n,_amount:i},success:function(n){n=t.parseJSON(n);n=="Success"?r=!0:(VIS.ADialog.info(n,null,"",""),r=!1)},error:function(){VIS.ADialog.info("error",null,"","");r=!1}}),r},checkPaymentCondition:function(n,f,e){var o=!1;return t.ajax({url:VIS.Application.contextUrl+"BankStatement/CheckPaymentCondition",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:{_dragSourceID:n,_dragDestinationID:f,_amount:e,statmtDate:ft.val(),accountID:s.val()},success:function(n){n=t.parseJSON(n);n._status=="Success"?(o=!0,n._amount!=null&&n._amount!=0&&(i.setValue(VIS.Utility.Util.getValueOfDecimal(n._amount.toFixed(c))),i.getValue()<0?(u.removeClass("va012-inactive"),u.addClass("va012-active"),u.attr("v_active","1"),r.removeClass("va012-active"),r.addClass("va012-inactive"),r.attr("v_active","0")):(r.removeClass("va012-inactive"),r.addClass("va012-active"),r.attr("v_active","1"),u.removeClass("va012-active"),u.addClass("va012-inactive"),u.attr("v_active","0")),l.setValue(VIS.Utility.Util.getValueOfDecimal(n._trxamount.toFixed(c))))):(VIS.ADialog.info(n._status,null,"",""),o=!1)},error:function(){VIS.ADialog.info("error",null,"","");o=!1}}),o},checkScheduleCondition:function(n,i,r,u){var e,f;if(ui==null||ui==0){VIS.ADialog.info("VA012_SelectBankAccountFirst",null,"","");return}return e=0,y.value&&(e=y.value),f=!1,t.ajax({url:VIS.Application.contextUrl+"BankStatement/CheckScheduleCondition",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:{_dragSourceID:n,_dragDestinationID:i,_listToCheck:r,_amount:u,_currencyId:ui,_formBPartnerID:e},success:function(n){n=t.parseJSON(n);n=="Success"?f=!0:(VIS.ADialog.info(n,null,"",""),f=!1)},error:function(){VIS.ADialog.info("error",null,"","");f=!1}}),f},checkScheduleTotal:function(n,i,r){var u=!1;return t.ajax({url:VIS.Application.contextUrl+"BankStatement/CheckScheduleTotal",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:{_listToCheck:n,_amount:i,_currencyId:ui,_destinationID:r},success:function(n){n=t.parseJSON(n);n=="Success"?u=!0:(VIS.ADialog.info(n,null,"",""),u=!1)},error:function(){VIS.ADialog.info("error",null,"","");u=!1}}),u},checkPrepayCondition:function(n,f,e,o){var h=0,s;return y.value&&(h=y.value),s=!1,t.ajax({url:VIS.Application.contextUrl+"BankStatement/CheckPrepayCondition",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:{_dragSourceID:n,_dragDestinationID:f,_listToCheck:e,_amount:o,_currencyId:ui,_formBPartnerID:h,stateDate:ft.val()},success:function(n){n=t.parseJSON(n);n._status=="Success"?(s=!0,n._amount>0&&(i.setValue(VIS.Utility.Util.getValueOfDecimal(n._amount.toFixed(c))),i.getValue()<0?(u.removeClass("va012-inactive"),u.addClass("va012-active"),u.attr("v_active","1"),r.removeClass("va012-active"),r.addClass("va012-inactive"),r.attr("v_active","0")):(r.removeClass("va012-inactive"),r.addClass("va012-active"),r.attr("v_active","1"),u.removeClass("va012-active"),u.addClass("va012-inactive"),u.attr("v_active","0")))):(VIS.ADialog.info(n._status,null,"",""),s=!1)},error:function(){VIS.ADialog.info("error",null,"","");s=!1}}),s},checkContraCondition:function(n,f,e){var s=0,o;return y.value&&(s=y.value),o=!1,t.ajax({url:VIS.Application.contextUrl+"BankStatement/CheckContraCondition",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:{_dragSourceID:n,_dragDestinationID:f,_amount:e,_currencyId:ui,_formBPartnerID:s,stateDate:ft.val()},success:function(n){n=t.parseJSON(n);n._status=="Success"?(o=!0,i.setValue(VIS.Utility.Util.getValueOfDecimal(n._amount.toFixed(c))),i.getValue()<0?(u.removeClass("va012-inactive"),u.addClass("va012-active"),u.attr("v_active","1"),r.removeClass("va012-active"),r.addClass("va012-inactive"),r.attr("v_active","0")):(r.removeClass("va012-inactive"),r.addClass("va012-active"),r.attr("v_active","1"),u.removeClass("va012-active"),u.addClass("va012-inactive"),u.attr("v_active","0"))):(VIS.ADialog.info(n._status,null,"",""),o=!1)},error:function(){VIS.ADialog.info("error",null,"","");o=!1}}),o},matchByDrag:function(n,f){var e=!1;return t.ajax({url:VIS.Application.contextUrl+"BankStatement/MatchByDrag",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:{_dragPaymentID:n,_dragStatementID:f},success:function(n){n=t.parseJSON(n);n._status=="Success"?(e=!0,n._amount!=null&&n._amount!=0&&(i.setValue(VIS.Utility.Util.getValueOfDecimal(n._amount.toFixed(c))),i.getValue()<0?(u.removeClass("va012-inactive"),u.addClass("va012-active"),u.attr("v_active","1"),r.removeClass("va012-active"),r.addClass("va012-inactive"),r.attr("v_active","0")):(r.removeClass("va012-inactive"),r.addClass("va012-active"),r.attr("v_active","1"),u.removeClass("va012-active"),u.addClass("va012-inactive"),u.attr("v_active","0")),v.trigger("focus"))):(VIS.ADialog.info(n._status,null,"",""),e=!1)},error:function(){VIS.ADialog.info("error",null,"","");e=!1}}),e}};this.vetoablechange=function(n){n.propertyName=="VA012_txtDifference_"+$self.windowNo+""?p.setValue(VIS.Utility.Util.getValueOfDecimal(n.newValue.toFixed(c))):n.propertyName=="VA012_txtTaxAmount_"+$self.windowNo+""?et.setValue(VIS.Utility.Util.getValueOfDecimal(n.newValue.toFixed(c))):n.propertyName=="VA012_txtTrxAmt_"+$self.windowNo+""?l.setValue(VIS.Utility.Util.getValueOfDecimal(n.newValue.toFixed(c))):n.propertyName=="VA012_txtAmount_"+$self.windowNo+""&&i.setValue(VIS.Utility.Util.getValueOfDecimal(n.newValue.toFixed(c)))};a={statementDialog:function(){function w(){c=$statement.find("#VA012_STAT_cmbBank_"+$self.windowNo);r=$statement.find("#VA012_STAT_cmbBankAccount_"+$self.windowNo);e=$statement.find("#VA012_STAT_cmbBankAccountClassName_"+$self.windowNo);y=$statement.find("#VA012_STAT_statementDate_"+$self.windowNo);l=$statement.find("#VA012_STAT_txtStatementNo_"+$self.windowNo);h=$statement.find("#VA012_ctrlLoadFile_"+$self.windowNo);STAT_ctrlLoadFileTxt=$statement.find("#VA012_ctrlLoadFileTxt_"+$self.windowNo);_tabFile=$statement.find("#VA012_STAT_tabFile_"+$self.windowNo);_tabSchedule=$statement.find("#VA012_STAT_tabSchedule_"+$self.windowNo);su=$statement.find("#VA012_STAT_cmbBankAccountClassName_"+$self.windowNo)}function b(){c.html("");c.append("<option value="+fi.val()+">"+fi.children()[fi[0].selectedIndex].text+"<\/option>");c.prop("selectedIndex",0)}function k(){r.html("");r.append("<option value="+s.val()+">"+s.children()[s[0].selectedIndex].text+"<\/option>");r.prop("selectedIndex",0)}function d(){function t(t){var i,r;if(e.html(""),e.append("<option value=0 ><\/option>"),t!=null)for(i=0;i<t.tables[0].rows.length;i++)r=t.tables[0].rows[i].cells.va012_bankstatementclass_id,e.append("<option value="+r+">"+VIS.Utility.encodeText(t.tables[0].rows[i].cells.name)+"<\/option>");t.dispose();t=null;n=null;e.prop("selectedIndex",0)}var n=" SELECT BSC.VA012_BANKSTATEMENTCLASSNAME AS NAME, CONCAT(CONCAT(SC.NAME,'_'),VA012_BANKSTATEMENTCLASS_ID) AS VA012_BANKSTATEMENTCLASS_ID FROM VA012_BANKSTATEMENTCLASS BSC INNER JOIN VA012_STATEMENTCLASS SC ON BSC.VA012_STATEMENTCLASS_ID=SC.VA012_STATEMENTCLASS_ID WHERE C_BANKACCOUNT_ID = "+s.val(),i=VIS.DB.executeDataSet(n.toString(),null,t)}function g(){function t(t){if(t!=null)for(var i=0;i<t.tables[0].rows.length;i++)p=VIS.Utility.Util.getValueOfInt(t.tables[0].rows[i].cells.c_charge_id);t.dispose();t=null;n=null}var n="SELECT C_CHARGE_ID, NAME FROM C_CHARGE WHERE ISACTIVE = 'Y' AND AD_CLIENT_ID = "+VIS.Env.getCtx().getAD_Client_ID()+" AND ROWNUM = 1 ORDER BY NAME  ",i=VIS.DB.executeDataSet(n.toString(),null,t)}function tt(){v=null;$statement=null;c=null;r=null;l=null;h=null;STAT_ctrlLoadFileTxt=null;_tabSchedule=null;_tabFile=null;i=null}var c=null,r=null,e=null,y=null,p=null,l=null,h=null,i=null,v,u;$statement=t("<div class='va012-popform-content'>");v="";v="<div><div class='va012-left-btn'><a id='VA012_STAT_tabFile_"+$self.windowNo+"' class='btn va012-blueBtn' activestatus='1'>"+VIS.Msg.getMsg("VA012_File")+"<\/a><\/div><\/div><div style='border: 2px solid rgba(var(--v-c-primary), 1);padding: 10px; float: left;'><div class='va012-popform-data'><label>"+VIS.Msg.getMsg("VA012_Bank")+"<\/label><select id='VA012_STAT_cmbBank_"+$self.windowNo+"' class='vis-ev-col-readonly' disabled><\/select><\/div> <div class='va012-popform-data'><label>"+VIS.Msg.getMsg("VA012_BankAccount")+"<\/label><select id='VA012_STAT_cmbBankAccount_"+$self.windowNo+"' class='vis-ev-col-readonly' disabled><\/select><\/div><div class=va012-popform-data><label id=VA012_STAT_lblStatementDate_"+$self.windowNo+">"+VIS.Msg.getMsg("VA012_StatementDate")+'<\/label><input type=date max="9999-12-31" class=vis-ev-col-readonly disabled id=VA012_STAT_statementDate_'+$self.windowNo+"><\/div><div class='va012-popform-data'><label>"+VIS.Msg.getMsg("VA012_ClassName")+'<sup style="color: red;">*<\/sup><\/label><select id=\'VA012_STAT_cmbBankAccountClassName_'+$self.windowNo+"'><\/select><\/div><div class='va012-popform-data'><label>"+VIS.Msg.getMsg("VA012_StatementNumber")+"<sup style=\"color: red;\">*<\/sup><\/label><input type='text' id='VA012_STAT_txtStatementNo_"+$self.windowNo+"' /> <\/div><div class='va012-popform-data va012-pop-file'><label>"+VIS.Msg.getMsg("VA012_SelectFile")+"<sup style=\"color: red;\">*<\/sup><\/label><input type='text' id='VA012_ctrlLoadFileTxt_"+$self.windowNo+"' disabled><div class='va012-file-upload'><label for='file-input' class='va012-file-label'>"+VIS.Msg.getMsg("VA012_Browse")+"<\/label><input id='VA012_ctrlLoadFile_"+$self.windowNo+"' type='file' accept='.csv,text/plain,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel'/><\/div><\/div><\/div>";$statement.append(v);w();b();k();d();y.val(Globalize.format(new Date(rt.val()),"yyyy-MM-dd"));g();u=new VIS.ChildDialog;u.setContent($statement);u.setTitle(VIS.Msg.getMsg("VA012_LoadStatement"));u.setWidth("500px");u.setEnableResize(!1);u.setModal(!0);u.show();h.on("change",function(){var u=this;r.val()!=null&&r.val()>0?(i=t.parseJSON(n.UploadExcel(u,null,null)),STAT_ctrlLoadFileTxt.val(i._orgfilename)):(h=null,VIS.ADialog.info("VA012_SelectBankAccountFirst",null,"",""))});u.onOkClick=function(){if(bt.val(""),_tabFile.attr("activestatus")=="1"){if(r.val()==null||r.val()==""||r.val()=="0")return VIS.ADialog.info("VA012_SelectBankAccountFirst",null,"",""),!1;if(e.val()==null||e.val()==""||e.val()=="0")return VIS.ADialog.info("VA012_PleaseSelectClassFirst",null,"",""),!1;if(l.val()==null||l.val()=="")return VIS.ADialog.info("VA012_PleaseEnterStatementNo",null,"",""),!1;if(h.val()==""==null||h.val()=="")return VIS.ADialog.info("VA012_SelectFileFirst",null,"",""),!1;if(i!=null){if(i._filename==null||i._filename==""||i._path==null||i._path==""){VIS.ADialog.info("VA012_ErrorInGettingFile",null,"","");return}if(i._error!=null&&i._error!=""){VIS.ADialog.info(i._error,null,"","");return}var n=i._path,u=i._filename,s=r.val(),c=l.val(),b=$statement,v=e.val(),w=p;ht(o,!0,"absolute");window.setTimeout(function(){t.ajax({url:VIS.Application.contextUrl+"BankStatement/ImportStatement",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:{_path:n,_filename:u,_bankaccount:s,_bankAccountCurrency:ui,_statementno:c,_statementClassName:v,_statementCharges:w,statementDate:y.val()},success:function(n){ni=n._statementID;ni!=null&&ni!=""?(st=[],nt.html(""),ii=1,ht(o,!1,"absolute"),a.loadStatement(ni),f.refreshForm()):n._error!=null&&n._error!=""&&(ht(o,!1,"absolute"),VIS.ADialog.info(n._error,null,"",""))},error:function(){ht(o,!1,"absolute");VIS.ADialog.info("error",null,"","")}})},2)}}if(_tabSchedule.attr("activestatus")=="1")return alert("Schedule"),!1};u.onCancelClick=function(){};u.onClose=function(){tt()};_tabFile.on(VIS.Events.onTouchStartOrClick,function(){_tabFile.removeClass("va012-grayBtn");_tabFile.addClass("va012-blueBtn");_tabFile.attr("activestatus","1");_tabSchedule.removeClass("va012-blueBtn");_tabSchedule.addClass("va012-grayBtn");_tabSchedule.attr("activestatus","0")});_tabSchedule.on(VIS.Events.onTouchStartOrClick,function(){_tabSchedule.removeClass("va012-grayBtn");_tabSchedule.addClass("va012-blueBtn");_tabSchedule.attr("activestatus","1");_tabFile.removeClass("va012-blueBtn");_tabFile.addClass("va012-grayBtn");_tabFile.attr("activestatus","0")})},LoadStatementsPages:function(){oi=bt.val()!=null&&bt.val()!=""?!0:!1;t.ajax({url:VIS.Application.contextUrl+"BankStatement/LoadStatementsPages",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:{_cmbBankAccount:s.val(),_txtSearch:bt.val(),_statementPageNo:ii,_PAGESIZE:of,_SEARCHREQUEST:oi},success:function(n){n!=null&&n!=""&&(yf=JSON.parse(n))}})},loadStatement:function(){function i(n){n!=null&&n.length>0?(vr.html(""),ar.html(""),ar.append("<p>"+VIS.Msg.getMsg("VA012_Reconciled")+"<\/p><p style='margin-top: 4px;'>"+VIS.Msg.getMsg("VA012_Unreconciled")+"<\/p>"),vr.append("<span style='padding-bottom: 2px;' class='va012-amount va012-font-green'><span class='va012-base-curr'>"+n[0].basecurrency+"<\/span> "+parseFloat(n[0].reconciled).toLocaleString(navigator.language,{minimumFractionDigits:c,maximumFractionDigits:c})+"<\/span><span style='padding-bottom: 2px;' class='va012-amount va012-font-red'> <span class='va012-base-curr'>"+n[0].basecurrency+"<\/span> "+parseFloat(n[0].unreconciled).toLocaleString(navigator.language,{minimumFractionDigits:c,maximumFractionDigits:c})+"<\/span>")):(vr.html(""),ar.html(""),ar.append("<p>"+VIS.Msg.getMsg("VA012_Reconciled")+"<\/p><p style='margin-top: 4px;'>"+VIS.Msg.getMsg("VA012_Unreconciled")+"<\/p>"),vr.append("<span style='padding-bottom: 2px;' class='va012-amount va012-font-green'><span class='va012-base-curr'>"+dr+"<\/span> 0<\/span><span style='padding-bottom: 2px;' class='va012-amount va012-font-red'><span class='va012-base-curr'>"+dr+"<\/span> 0<\/span>"));a.setStatementListHeight()}function r(i){var u,r;if(i=t.parseJSON(i),u="",i!=null&&i.length>0)for(r=0;r<i.length;r++)u="",n=i[r].docstatus=="CO"||i[r].docstatus=="CL"||i[r].docstatus=="RE"?"va012-gray-color":i[r].c_payment_id==null||i[r].c_payment_id=="0"||i[r].c_payment_id==0?i[r].c_cashline_id!=null&&i[r].c_cashline_id!="0"&&i[r].c_cashline_id!=0?"va012-green-color":i[r].c_charge_id!=null&&i[r].c_charge_id!="0"&&i[r].c_charge_id!=0?i[r].STMTAMT==i[r].trxamount?"va012-green-color":"va012-red-color":(i[r].c_charge_id==null||i[r].c_charge_id=="")&&(i[r].trxno==null||i[r].trxno=="")?"va012-red-color":"va012-red-color":"va012-green-color",u='<div  data-uid="'+i[r].c_bankstatementline_id+'" class="va012-right-data-wrap '+n+'"><div class="va012-statement-wrap"><div class="va012-fl-padd"><div class="col-md-4 col-sm-4 va012-padd-0"><div class="va012-form-check"> <input type="checkbox" data-uid="'+i[r].c_bankstatementline_id+'" > <div class="va012-form-text"> <span style="background: rgba(var(--v-c-on-secondary), .4);color: rgba(var(--v-c-on-primary), 1); padding: 3px;margin-left: 2px;">'+i[r].statementno+"/"+i[r].page+"/"+i[r].line+"<\/span><label>"+i[r].currency+" "+parseFloat(i[r].trxamount).toLocaleString(navigator.language,{minimumFractionDigits:c,maximumFractionDigits:c})+"<\/label>",u+=i[r].trxno==""||i[r].trxno==null?'<\/div><\/div><!-- end of form-group --> <\/div><!-- end of col --><div class="col-md-4 col-sm-4 va012-padd-0 va012-width-sm"><div class="va012-form-check"><div class="va012-pay-text"> <p>'+VIS.Utility.encodeText(i[r].description)+"<\/p><span>"+VIS.Utility.encodeText(i[r].invoiceno)+'<\/span> <\/div><\/div> <!-- end of form-group --><\/div> <!-- end of col --> <div class="col-md-2 col-sm-2 va012-padd-0"><div class="va012-form-check"><div class="va012-pay-text"> <p> <\/p> <\/div><\/div> <!-- end of form-group --> <\/div> <!-- end of col --> <div class="col-md-1 col-sm-1 va012-padd-0"><div class="va012-form-check"><div class="va012-pay-text"> <p><span data-uid="'+i[r].c_bankstatementline_id+'" class="glyphicon glyphicon-edit" title='+VIS.Msg.getMsg("EditRecord")+'><\/span> <span data-uid="'+i[r].c_bankstatement_id+'" class="glyphicon glyphicon-zoom-in" title='+VIS.Msg.getMsg("ZoomToRecord")+'><\/span> <\/p> <\/div><\/div> <!-- end of form-group --> <\/div> <!-- end of col --> <div class="col-md-1 col-sm-1 va012-padd-0 va012-width-xs"><div class="va012-form-data">':'<\/div><\/div><!-- end of form-group --> <\/div><!-- end of col --><div class="col-md-4 col-sm-4 va012-padd-0 va012-width-sm"><div class="va012-form-check"><div class="va012-pay-text"> <p>'+VIS.Utility.encodeText(i[r].description)+"<\/p> <span>"+VIS.Utility.encodeText(i[r].bpgroup)+"<\/span><span>"+VIS.Utility.encodeText(i[r].invoiceno)+'<\/span> <\/div><\/div> <!-- end of form-group --><\/div> <!-- end of col --> <div class="col-md-2 col-sm-2 va012-padd-0"><div class="va012-form-check"><div class="va012-pay-text"> <p>'+VIS.Utility.encodeText(i[r].trxno)+'<\/p> <\/div><\/div> <!-- end of form-group --> <\/div> <!-- end of col --> <div class="col-md-1 col-sm-1 va012-padd-0"><div class="va012-form-check"><div class="va012-pay-text"> <p><span data-uid="'+i[r].c_bankstatementline_id+'" class="glyphicon glyphicon-edit"><\/span> <span data-uid="'+i[r].c_bankstatement_id+'" class="glyphicon glyphicon-zoom-in"><\/span> <\/p> <\/div><\/div> <!-- end of form-group --> <\/div> <!-- end of col --> <div class="col-md-1 col-sm-1 va012-padd-0 va012-width-xs"><div class="va012-form-data">',u+=" <\/div> <!-- end of form-group --> <\/div> <!-- end of col --> <\/div> <!-- end of row --><\/div><!-- end of payment-wrap --><\/div><!-- end of right-data-wrap -->",nt.append(u);_sql=null;a.setStatementListHeight();e.dropPayments()}oi=bt.val()!=null&&bt.val()!=""?!0:!1;ht(t(nt),!0,"inherit");window.setTimeout(function(){t.ajax({url:VIS.Application.contextUrl+"BankStatement/LoadConciledOrUnConciledStatements",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:{_cmbBankAccount:s.val(),_txtSearch:bt.val(),_currencyID:ui!=null?ui:0,_searchRequest:oi},success:function(n){var r=t.parseJSON(n);i(r);ht(t(nt),!1,"inherit")},error:function(){ht(t(nt),!1,"inherit")}})},2);var n="va012-red-color";window.setTimeout(function(){t.ajax({url:VIS.Application.contextUrl+"BankStatement/LoadStatements",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:{_cmbBankAccount:s.val(),_txtSearch:bt.val(),_statementPageNo:ii,_PAGESIZE:of,_SEARCHREQUEST:oi},success:function(n){n!=null&&n!=""&&(r(n),ht(t(nt),!1,"inherit"))},error:function(){ht(t(nt),!1,"inherit")}})},2)},setStatementListHeight:function(){t("#VA012_contentArea_"+$self.windowNo).height(t("#VA012_mainContainer_"+$self.windowNo).height()-20);t("#VA012_lstStatement_"+$self.windowNo).height(t("#VA012_rightWrap_"+$self.windowNo).height()-t("#VA012_rightTop_"+$self.windowNo).height()-18)},statementOpenEdit:function(n,t){return it.attr("activestatus","0"),it.attr("src","Areas/VA012/Images/hide.png"),it.attr("title","Collapse"),it.removeClass("vis vis-plus"),it.addClass("fa fa-minus"),h.show(),e.setPaymentListHeight(),a.statementListRecordEdit(n,t),n=0,!0},statementListEdit:function(n){var i=t(n.target),r=0;i.hasClass("glyphicon-edit")&&(r=i.data("uid"),it.attr("activestatus","0"),it.attr("src","Areas/VA012/Images/hide.png"),it.attr("title","Collapse"),h.show(),it.removeClass("vis vis-plus"),it.addClass("fa fa-minus"),e.setPaymentListHeight(),f.scheduleRefresh(),f.prepayRefresh(),si=!0,a.statementListRecordEdit(r,0),r=0,e.addEffect(i,h))},openStatement:function(n){var e=t(n.target),f=0,o,i,r,u;if(e.hasClass("glyphicon glyphicon-zoom-in")){f=e.data("uid");o="select ad_window_id from ad_window where name = 'Bank Statement'";i=0;try{r=VIS.DB.executeDataReader(o);r.read()&&(i=r.getInt(0));r.dispose();i>0&&(u=new VIS.Query,u.addRestriction("C_BankStatement_ID",VIS.Query.prototype.EQUAL,f),u.setRecordCount(1),VIS.viewManager.startWindow(i,u))}catch(n){console.log(n)}f=0}},selectedStatementLinesList:function(n){var i=t(n.target);n.target.type=="checkbox"&&(i.is(":checked")&&(_bankStatementLineID=parseInt(i.data("uid")),st.push(_bankStatementLineID),_bankStatementLineID=0),i.is(":checked")||(_bankStatementLineID=parseInt(i.data("uid")),st.splice(st.indexOf(_bankStatementLineID),1),_bankStatementLineID=0))},statementListRecordEdit:function(n,t){f.refreshForm();a.getStatementLineForEdit(n,t,a.afterRecordGet)},selectedScheduleList:function(n){var i=t(n.target);n.target.type=="checkbox"&&(i.is(":checked"),!i.is(":checked"))},getStatementLineForEdit:function(n,i,r){t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA012/BankStatement/GetStatementLine",contentType:"application/json; charset=utf-8",data:JSON.stringify({_bankStatementLineID:n,trxType:b.val(),payment_ID:i!=null?i:0,_statementDt:ft.val()}),success:function(n){r(n)},error:function(n){VIS.ADialog.info(n,null,"","")}})},afterRecordGet:function(n){var f,e;n!=null&&n!=""&&(f=t.parseJSON(n),h.attr("data-uid",f._bankStatementLineID),at.val(f._txtStatementNo),ur.val(f._txtStatementPage),hi.val(f._txtStatementLine),ft.val(Globalize.format(new Date(f._dtStatementDate),"yyyy-MM-dd")),yi.val(f._cmbPaymentMethod).prop("selected",!0),f._cmbVoucherMatch!=null&&f._cmbVoucherMatch!=""?w.val(f._cmbVoucherMatch).prop("selected",!0):w.prop("selectedIndex",0),b.val()=="CO"&&w.val("C").prop("selected",!0),w.trigger("change"),f._cmbContraType!=null&&f._cmbContraType!=""?ot.val(f._cmbContraType).prop("selected",!0):ot.prop("selectedIndex",0),w.val()!=null&&w.val()!=""&&ot.val()!=""&&ot.val()!=""&&ot.val("CB").prop("selected",!0),ot.trigger("change"),vi.val(f._cmbCashBook).prop("selected",!0),yr.val(f._txtCheckNo),i.setValue(VIS.Utility.Util.getValueOfDecimal(f._txtAmount.toFixed(c))),l.setValue(VIS.Utility.Util.getValueOfDecimal(f._txtTrxAmt.toFixed(c))),w.val()=="M"&&l.getValue()!=0&&(p.setValue(VIS.Utility.Util.getValueOfDecimal(Math.abs(f._txtDifference.toFixed(c)))),f._txtDifference!=0?(p.getControl().attr("vchangable","N"),li.find("*").prop("disabled",!1)):p.getControl().attr("vchangable","Y")),f._cmbDifferenceType!=null&&f._cmbDifferenceType!=""?(li.find("*").prop("disabled",!1),ct.val(f._cmbDifferenceType).prop("selected",!0)):ct.prop("selectedIndex",0),ct.trigger("change"),i.getValue()<0?(u.removeClass("va012-inactive"),u.addClass("va012-active"),u.attr("v_active","1"),r.removeClass("va012-active"),r.addClass("va012-inactive"),r.attr("v_active","0")):(r.removeClass("va012-inactive"),r.addClass("va012-active"),r.attr("v_active","1"),u.removeClass("va012-active"),u.addClass("va012-inactive"),u.attr("v_active","0")),fr.val(f._txtVoucherNo),gr.val(f._txtDescription),wi.val(f._cmbCharge).prop("selected",!0),v.val(f._txtCharge),v.attr("chargeid",f._cmbCharge),k.val(f._cmbTaxRate).prop("selected",!0),et.setValue(VIS.Utility.Util.getValueOfDecimal(f._txtTaxAmount.toFixed(c))),ru.prop("checked",f._chkUseNextTime),f._ctrlCashLine>0?(dt.setValue(f._ctrlCashLine,!1,!0),si=!1):ti||(dt.setValue(),f._ctrlPayment<=0&&(si=!1)),g&&g.value>0&&f._ctrlPayment==0&&(f._ctrlPayment=g.value),f._ctrlPayment>0?(g.setValue(f._ctrlPayment,!1,!0),fr.val()==""&&(e=VIS.Utility.Util.getValueOfString(VIS.DB.executeScalar("select trxno from C_Payment where C_Payment_ID="+f._ctrlPayment)),fr.val(e)),si=!1):ti||(g.setValue(),si=!1),f._ctrlOrder>0?kt.setValue(f._ctrlOrder,!1,!0):ti||kt.setValue(),f._ctrlBusinessPartner>0?y.setValue(f._ctrlBusinessPartner,!1,!0):ti||y.setValue(),f._ctrlInvoice>0?lt.setValue(f._ctrlInvoice,!1,!0):ti||lt.setValue(),v.trigger("focus"))},matchStatementDialog:function(){function w(){function t(t){if(u.html(""),u.append("<option value=0 >-<\/option>"),t!=null)for(var i=0;i<t.tables[0].rows.length;i++)u.append("<option value="+VIS.Utility.Util.getValueOfInt(t.tables[0].rows[i].cells.c_bankstatement_id)+">"+VIS.Utility.encodeText(t.tables[0].rows[i].cells.name)+"<\/option>");t.dispose();t=null;n=null}var n="Select Cb.C_Bankstatement_Id, CB.NAME,Cb.Docstatus, COUNT(VA012_ISMATCHINGCONFIRMED) FROM C_BANKSTATEMENT CB INNER JOIN C_BANKSTATEMENTLINE CBL ON cbl.C_BANKSTATEMENT_ID = Cb.C_BANKSTATEMENT_ID Where Cb.Isactive = 'Y' And Cb.Ad_Client_Id = "+VIS.Env.getCtx().getAD_Client_ID()+" And Cb.C_Bankaccount_Id = "+s.val()+" And Cb.Docstatus NOT IN  ('CO','CL','VO') GROUP BY CB.C_BANKSTATEMENT_ID,Cb.Docstatus, CB.NAME",i=VIS.DB.executeDataSet(n.toString(),null,t)}function k(){function i(t){if(o.html(""),o.append("<option value=0 >-<\/option>"),t!=null)for(var i=0;i<t.tables[0].rows.length;i++)o.append("<option value="+VIS.Utility.Util.getValueOfInt(t.tables[0].rows[i].cells.c_tax_id)+">"+VIS.Utility.encodeText(t.tables[0].rows[i].cells.name)+"<\/option>");t.dispose();t=null;n=null}var n="SELECT Name,C_Tax_ID FROM C_Tax WHERE IsActive='Y'AND IsSurcharge='N' AND NVL(Parent_Tax_ID, 0)=0",t;n=VIS.MRole.getDefault().addAccessSQL(n,"C_Tax",!0,!1);t=VIS.DB.executeDataSet(n.toString(),null,i)}function d(){n=$match.find("#VA012_cmbMatchingBase_"+$self.windowNo);h=$match.find("#VA012_divMatchingBase_"+$self.windowNo);c=$match.find("#VA012_cmbMatchingCriteria_"+$self.windowNo);u=$match.find("#VA012_cmbStatementNo_"+$self.windowNo);y=$match.find("#VA012_ChargeSrch_"+$self.windowNo);o=$match.find("#VA012_cmbTaxRate_"+$self.windowNo);p=$match.find("#VA012_accept_"+$self.windowNo);_ChargeLookUp=VIS.MLookupFactory.getMLookUp(VIS.Env.getCtx(),$self.windowNo,3787,VIS.DisplayType.Search);l=new VIS.Controls.VTextBoxButton("C_Charge_ID",!0,!1,!0,VIS.DisplayType.Search,_ChargeLookUp);y.append(l.getControl().css("width","93%")).append(l.getBtn(0).css("width","30px").css("height","30px").css("padding","0px").css("border-color","#BBBBBB"))}function g(n){var r=t(n.target);r.hasClass("glyphicon-remove")&&(i.splice(i.indexOf(r.data("uid")),1),r.parent().parent().remove())}function tt(){n=null;h=null;i=[];c=null;w2ui["VA012_gridPayment_"+$self.windowNo]!=null&&w2ui["VA012_gridPayment_"+$self.windowNo].destroy()}var n=null,h=null,i=[],c=null,u=null,y=null,l=null,o=null,p=null,v,r;$match=t("<div class='va012-popform-content'>");v="";v="<div class='va012-popform-data'><label>"+VIS.Msg.getMsg("VA012_StatementNo")+'<sup style="color: red;">*<\/sup><\/label><select id=\'VA012_cmbStatementNo_'+$self.windowNo+"'><\/select><\/div> <div class='va012-popform-data'><label>"+VIS.Msg.getMsg("VA012_MatchingBase")+'<sup style="color: red;">*<\/sup><\/label><select id=\'VA012_cmbMatchingBase_'+$self.windowNo+"'><\/select><\/div> <div id='VA012_divMatchingBase_"+$self.windowNo+"' style='width:100%;border: 2px solid rgba(var(--v-c-primary), 1);padding: 10px; float: left; margin-bottom: 10px; min-height: 150px; max-height: 200px; overflow:auto'><\/div><div class='va012-popform-data'><label>"+VIS.Msg.getMsg("VA012_MatchingCriteria")+'<sup style="color: red;">*<\/sup><\/label><select id=\'VA012_cmbMatchingCriteria_'+$self.windowNo+"'><option value='0'><\/option><option value='AT'>"+VIS.Msg.getMsg("VA012_MatchAnyTwo")+"<\/option><option value='AR'>"+VIS.Msg.getMsg("VA012_MatchAnyThree")+"<\/option><option value='AL'>"+VIS.Msg.getMsg("VA012_MatchAll")+"<\/option><\/select><\/div> <div class='va012-popform-data'><label title = '"+VIS.Msg.getMsg("VA012_SetChargeType")+"' > "+VIS.Msg.getMsg("VA012_Charge")+'<sup style="color: red;">*<\/sup><\/label><div id=\'VA012_ChargeSrch_'+$self.windowNo+"'><\/div><\/div> <div class='va012-popform-data'><label title =' "+VIS.Msg.getMsg("VA012_SetTaxRate")+"' >"+VIS.Msg.getMsg("VA012_TaxRate")+'<sup style="color: red;">*<\/sup><\/label><select id=\'VA012_cmbTaxRate_'+$self.windowNo+"'><\/select><\/div> <div class='va012-frm-btn va012-btn-blue' style='float: right;'><label style='font-weight: normal;' id ='VA012_accept_"+$self.windowNo+"'>"+VIS.Msg.getMsg("VA012_Accept")+"<\/label><\/div> <\/div>";$match.append(v);d();ye(n);w();k();r=new VIS.ChildDialog;r.setContent($match);r.setTitle(VIS.Msg.getMsg("VA012_MatchStatement"));r.setWidth(700);r.setHeight(650);r.setEnableResize(!1);r.setModal(!0);r.show();r.hideButtons();p.click(function(){if(i.length>0){if(u.val()==null||u.val()==""||u.val()=="0")return VIS.ADialog.info("VA012_NoLinesFoundToMatch",null,"",""),!1;if(s.val()==null||s.val()==""||s.val()=="0")return VIS.ADialog.info("VA012_SelectBankAccountFirst",null,"",""),!1;if(c.val()==null||c.val()==""||c.val()=="0")return VIS.ADialog.info("VA012_SelectMatchingCriteria",null,"",""),!1;if(c.val()=="AT"&&i.length<2)return VIS.ADialog.info("VA012_SelectMin2MatchingBase",null,"",""),!1;if(c.val()=="AR"&&i.length<3)return VIS.ADialog.info("VA012_SelectMin3MatchingBase",null,"",""),!1;if(l.value==null||VIS.Utility.Util.getValueOfInt(l.value)==0)return VIS.ADialog.info("VA012_NoChargeSelected",null,"",""),!1;if(o.val()==null||o.val()==""||o.val()=="0")return VIS.ADialog.info("VA012_NoTaxRateSelected",null,"",""),!1;ht($match,!0,"absolute");window.setTimeout(function(){t.ajax({url:VIS.Application.contextUrl+"BankStatement/MatchStatementGridData",type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",async:!1,data:{_matchingBaseItemList:i.toString(),_cmbMatchingCriteria:c.val(),_BankAccount:s.val(),_StatementNo:u.val(),_BankCharges:VIS.Utility.Util.getValueOfInt(l.value),_TaxRate:o.val()},success:function(r){if(r!=null&&r!=""){r=t.parseJSON(r);n.prop("selectedIndex",0);u.prop("selectedIndex",0);l.value=null;o.prop("selectedIndex",0);i=[];var c="";h.html("");r.length>0?(fe(h,r),_statementlineslist=[],nt.html(""),ii=1,a.loadStatement(ni),gt.html(""),f.scheduleRefresh(),f.prepayRefresh(),ei=1,e.loadPayments(s.val(),ut.val(),b.val(),rt.val())):(c="<div> <p> <b>"+VIS.Msg.getMsg("va012_norecordmatched")+"<\/b> <\/div>",h.append(c));ht($match,!1,"absolute")}else ht($match,!1,"absolute"),VIS.ADialog.info(r.toString(),null,"","")},error:function(){ht($match,!1,"absolute");VIS.ADialog.info("error",null,"","")}})},2)}else return VIS.ADialog.info("VA012_NoMatchingBaseSelected",null,"",""),!1;return!1});r.onCancelClick=function(){w2ui["VA012_gridPayment_"+$self.windowNo]!=null&&w2ui["VA012_gridPayment_"+$self.windowNo].destroy()};r.onClose=function(){tt()};n.on("change",function(){if(i.length<=0&&h.html(""),!nf(n.val(),i)&&n.val()!="0"&&n.val()!=""){i.push(n.val());var t="<div class='va012-matchingbaselist'>  <a class='va012-remove-icon'> <span data-uid='"+n.val()+"'class='glyphicon glyphicon-remove'><\/span><\/a> <span>"+n.children()[n[0].selectedIndex].text;h.append(t)}});h.on(VIS.Events.onTouchStartOrClick,g)},matchStatementGridDialog:function(){var n=new VIS.ChildDialog;n.setContent(eu);n.setTitle(VIS.Msg.getMsg("VA012_MatchStatementGrid"));n.setWidth("780px");n.setHeight(450);n.setEnableResize(!0);n.setModal(!0);n.show();fe()},paymentScheduleDialog:function(){function rt(){var u="",t=0,n;for($_divPaymentSchedules.html(""),n=0;n<tt.length;n++)u="<div class='va012-matchingbaselist'>  <a class='va012-remove-icon'> <span data-uid='"+tt[n]+"'  data-udata='"+ri[n]+"' class='glyphicon glyphicon-remove'><\/span><\/a> <span>"+ri[n]+"<\/span> <\/div>",$_divPaymentSchedules.append(u),d.length>0&&(t+=VIS.Utility.Util.getValueOfDecimal(d[n]));i.setValue(VIS.Utility.Util.getValueOfDecimal(t.toFixed(c)));l.setValue(VIS.Utility.Util.getValueOfDecimal(t.toFixed(c)));i.getValue()<0&&r.attr("v_active","0");i.getControl().trigger("blur")}function et(n){var o=t(n.target),f,e;if(o.hasClass("glyphicon-remove")){if(d!=null&&d.length>0){if(d.length>tt.length?d.splice(tt.indexOf(o.data("uid"))+1,1):d.length==tt.length&&d.splice(tt.indexOf(o.data("uid")),1),f=0,Number(d.length)>0)for(e=0;e<d.length;e++)f+=VIS.Utility.Util.getValueOfDecimal(d[e]);f<0?(u.removeClass("va012-inactive"),u.addClass("va012-active"),u.attr("v_active","1"),r.removeClass("va012-active"),r.addClass("va012-inactive"),r.attr("v_active","0")):(r.removeClass("va012-inactive"),r.addClass("va012-active"),r.attr("v_active","1"),u.removeClass("va012-active"),u.addClass("va012-inactive"),u.attr("v_active","0"));i.setValue(VIS.Utility.Util.getValueOfDecimal(f.toFixed(c)))}for(tt.splice(tt.indexOf(o.data("uid")),1),ri.splice(ri.indexOf(o.data("udata")),1),o.parent().parent().remove(),ci.val(ri.toString()),f=0,e=0;e<d.length;e++)f+=VIS.Utility.Util.getValueOfDecimal(d[e]);i.setValue(VIS.Utility.Util.getValueOfDecimal(f.toFixed(c)));l.setValue(VIS.Utility.Util.getValueOfDecimal(f.toFixed(c)));i.getControl().trigger("blur");f==0&&y.setValue()}}function ot(){$_divPaymentSchedules=$paymentSchedule.find("#VA012_divPaymentSchedules_"+$self.windowNo);p=$paymentSchedule.find("#VA012_ctrlPSInvoice_"+$self.windowNo);w=$paymentSchedule.find("#VA012_ctrlPSBP_"+$self.windowNo);n=$paymentSchedule.find("#VA012_cmbPaymentSchedule_"+$self.windowNo)}function ut(){g=VIS.MLookupFactory.get(VIS.Env.getCtx(),$self.windowNo,3484,VIS.DisplayType.Search,"C_Invoice_ID",0,!1,"DocStatus IN ('CO','CL') AND C_BPartner_ID="+nt);o=new VIS.Controls.VTextBoxButton("C_Invoice_ID",!1,!1,!0,VIS.DisplayType.Search,g);o.getControl().addClass("va012-input-size-2");p.append(o.getControl());p.append(o.getBtn(0));p.append(o.getBtn(1));o.fireValueChanged=function(){k=0;k=o.value;n.html("");ht()}}function st(){it=VIS.MLookupFactory.get(VIS.Env.getCtx(),$self.windowNo,2893,VIS.DisplayType.Search,"C_BPartner_ID",0,!1,null);a=new VIS.Controls.VTextBoxButton("C_BPartner_ID",!1,!1,!0,VIS.DisplayType.Search,du);a.getControl().addClass("va012-input-size-2");w.append(a.getControl());w.append(a.getBtn(0));w.append(a.getBtn(1));a.fireValueChanged=function(){nt=0;nt=a.value;g=null;o=null;p.html("");k=null;ut()}}function ht(){function i(t){if(n.html(""),n.append("<option value=0 ><\/option>"),t!=null)for(var i=0;i<t.length;i++){if(t[i].DueAmount==0){VIS.ADialog.info("VA012_ConversionRateNotFound",null,"","");return}n.append("<option paymentamount="+t[i].DueAmount+" paymentdata='"+VIS.Utility.encodeText(new Date(t[i].DueDate).toLocaleDateString())+"_"+VIS.Utility.encodeText(t[i].DueAmt)+"' value="+VIS.Utility.Util.getValueOfInt(t[i].c_invoicepayschedule_id)+">"+VIS.Utility.encodeText(new Date(t[i].DueDate).toLocaleDateString()+"_"+t[i].DueAmt)+"<\/option>")}n.prop("selectedIndex",0)}t.ajax({url:VIS.Application.contextUrl+"BankStatement/GetInvPaySchedule",dataType:"json",data:{seltdInvoice:k,accountID:s.val(),statemtDate:ft.val()},success:function(n){var t=JSON.parse(n);(t!=null||t!="")&&i(t)}})}function ct(){g=null;o=null;k=null;p=null;it=null;a=null;nt=null;w=null;n=null}var b,v;if(tt.length==0&&ri.length==0)var g=null,o=null,k=null,p=null,it=null,a=null,nt=null,w=null,n=null;$paymentSchedule=t("<div class='va012-popform-content'>");b="";b="<div> <label>"+VIS.Msg.getMsg("VA012_BusinessPartner")+"<\/label> <div id='VA012_ctrlPSBP_"+$self.windowNo+"' ><\/div> <\/div>";b+="<div> <label>"+VIS.Msg.getMsg("VA012_Invoice")+"<\/label> <div id='VA012_ctrlPSInvoice_"+$self.windowNo+"' ><\/div> <\/div>";b+="<div> <label>"+VIS.Msg.getMsg("VA012_PaymentSchedules")+"<\/label> <select id='VA012_cmbPaymentSchedule_"+$self.windowNo+"'  style=' width: 100%; ' ><\/select> <\/div>";b+="<div id='VA012_divPaymentSchedules_"+$self.windowNo+"' style='width:100%;border: 2px solid rgba(var(--v-c-primary), 1);padding: 10px; float: left; margin-bottom: 10px;margin-top: 10px; min-height: 150px; max-height: 200px; overflow:auto'><\/div> <\/div>";$paymentSchedule.append(b);ot();v=new VIS.ChildDialog;v.setContent($paymentSchedule);v.setTitle(VIS.Msg.getMsg("VA012_PaymentSchedules"));v.setWidth("500px");rt();v.setEnableResize(!1);v.setModal(!0);v.show();st();ut();y.value&&(a.setValue(y.value,!1,!0),w.find("*").prop("disabled",!0));lt.value&&(o.setValue(lt.value,!1,!0),p.find("*").prop("disabled",!0));n.on("change",function(){n.val()>0&&e.checkScheduleCondition(n.val(),parseInt(h.attr("data-uid")),tt.toString(),i.getValue())&&(nf(parseInt(n.val()),tt)?VIS.ADialog.info("VA012_AlreadySelected",null,"",""):(tt.push(parseInt(n.val())),ri.push(this.options[this.selectedIndex].getAttribute("paymentdata")),d.push(this.options[this.selectedIndex].getAttribute("paymentamount")),rt(),e.setInvoiceAndBPartner(n.val(),"IS")),ci.val(ri.toString()))});$_divPaymentSchedules.on(VIS.Events.onTouchStartOrClick,et);v.onOkClick=function(){};v.onCancelClick=function(){f.scheduleRefresh();f.refreshForm();ct()}},prepayOrderDialog:function(){function r(){var t="",n;for($_divPrepayOrders.html(""),n=0;n<rr.length;n++)t="<div class='va012-matchingbaselist'>  <a class='va012-remove-icon'> <span data-uid='"+rr[n]+"'  data-udata='"+hr[n]+"' class='glyphicon glyphicon-remove'><\/span><\/a> <span>"+hr[n]+"<\/span> <\/div>",$_divPrepayOrders.append(t)}function u(n){var i=t(n.target);i.hasClass("glyphicon-remove")&&(rr.splice(rr.indexOf(i.data("uid")),1),hr.splice(hr.indexOf(i.data("udata")),1),i.parent().parent().remove(),pu.val(hr.toString()))}function f(){$_divPrepayOrders=$prepayOrder.find("#VA012_divPrepayOrders_"+$self.windowNo)}var i,n;$prepayOrder=t("<div class='va012-popform-content'>");i="";i="<div id='VA012_divPrepayOrders_"+$self.windowNo+"' style='width:100%;border: 2px solid rgba(var(--v-c-primary), 1);padding: 10px; float: left; margin-bottom: 10px; min-height: 150px; max-height: 200px; overflow:auto'><\/div> <\/div>";$prepayOrder.append(i);f();n=new VIS.ChildDialog;n.setContent($prepayOrder);n.setTitle(VIS.Msg.getMsg("VA012_PrepayOrders"));n.setWidth("500px");r();n.setEnableResize(!1);n.setModal(!0);n.show();$_divPrepayOrders.on(VIS.Events.onTouchStartOrClick,u)}};f={newRecord:function(){function n(n){datasource=[];for(var t=0;t<n.length;t++)datasource.push({label:n[t].name,value:n[t].name,ids:n[t].chargeID});v.autocomplete("option","source",datasource);v.autocomplete("search","");v.trigger("focus")}function a(n,i){v.attr("chargeid",0);t.ajax({url:VIS.Application.contextUrl+"BankStatement/GetCharge",dataType:"json",data:{searchText:n},success:function(n){var r=JSON.parse(n);datasource=[];i(t.map(r,function(n){return{label:n.name,value:n.name,ids:n.chargeID}}));t(self.div).autocomplete("search","");t(self.div).trigger("focus")}})}h=o.find("#VA012_formNewRecord_"+$self.windowNo);yu=o.find("#VA012_formBtnNewRecord_"+$self.windowNo);f.getNewRecordDesign();f.getNewRecordControls();f.loadCurrency();f.loadPaymentMethod();f.loadVoucherMatch();f.loadContraType();f.loadCashBook();f.loadDifferenceType();f.loadTransferType();f.loadCharge();f.loadTaxRate();f.loadPayment();f.loadOrder();f.loadBusinessPartner();f.loadInvoice();f.loadCashLine();i.getValue()<=0&&i.getControl().addClass("va012-mandatory");at.val()!=""&&at.removeClass("va012-mandatory");ft.val()!=""&&ft.removeClass("va012-mandatory");v.on("blur",function(){(v.val()==""||v.val()==null)&&v.attr("chargeid",0)});af.on(VIS.Events.onTouchStartOrClick,function(){VIS.dataContext.getJSONData(VIS.Application.contextUrl+"BankStatement/GetCharge",{searchText:""},n)});v.autocomplete({minLength:0,scroll:!0,source:function(n,t){n.term.trim().length!=0&&a(n.term,t)},select:function(n,i){t(this).val(i.item.ids);t(this).attr("chargeid",i.item.ids);parseInt(t(this).val())&&v.removeClass("va012-mandatory")}});it.on(VIS.Events.onTouchStartOrClick,function(){it.attr("activestatus")=="0"?(h.show(),it.attr("activestatus","1"),it.removeClass("vis vis-plus"),it.addClass("fa fa-minus"),it.attr("title","Collapse")):(h.hide(),it.attr("activestatus","0"),it.addClass("vis vis-plus"),it.removeClass("fa fa-minus"),it.attr("title","Expand"));i.getValue()<=0&&i.getControl().addClass("va012-mandatory");at.val()!=""&&at.removeClass("va012-mandatory");ft.val()!=""&&ft.removeClass("va012-mandatory");f.scheduleRefresh();f.prepayRefresh();f.refreshForm();e.setPaymentListHeight()});cf.on(VIS.Events.onTouchStartOrClick,function(){f.scheduleRefresh();f.prepayRefresh();f.refreshForm()});h.hide();w.on("change",function(){if(w.val()=="M"){_divCtrlCashLine.find("*").prop("disabled",!0);_divCtrlCashLine.hide();bi.find("*").prop("disabled",!0);or.find("*").prop("disabled",!0);ki.find("*").prop("disabled",!0);sr.find("*").prop("disabled",!0);bi.hide();or.hide();ki.hide();sr.hide();var n=VIS.Utility.Util.getValueOfInt(VIS.DB.executeScalar("SELECT Count(AD_ModuleInfo_ID) FROM AD_ModuleInfo WHERE PREFIX='VA034_' AND IsActive = 'Y'"));n>0?(vt.show(),vt.find("*").prop("disabled",!1)):(vt.find("*").prop("disabled",!0),vt.hide());yt.find("*").prop("disabled",!0);pt.find("*").prop("disabled",!0);wt.find("*").prop("disabled",!0);yt.hide();pt.hide();wt.hide();divRow4Col1TrxAmt.show();br.show();li.show();di.show();gi.show();nr.show();tr.show();ir.show();di.find("*").prop("disabled",!1);gi.find("*").prop("disabled",!1);nr.find("*").prop("disabled",!1);tr.find("*").prop("disabled",!1);ir.find("*").prop("disabled",!1);ci.prop("disabled",!0);wr.css("pointer-events","auto");k.removeClass("va012-mandatory");v.removeClass("va012-mandatory")}else w.val()=="V"?(_divCtrlCashLine.find("*").prop("disabled",!0),_divCtrlCashLine.hide(),bi.find("*").prop("disabled",!0),or.find("*").prop("disabled",!0),ki.find("*").prop("disabled",!0),sr.find("*").prop("disabled",!0),bi.hide(),or.hide(),ki.hide(),sr.hide(),vt.show(),yt.show(),pt.show(),wt.show(),vt.find("*").prop("disabled",!1),yt.find("*").prop("disabled",!1),pt.find("*").prop("disabled",!1),wt.find("*").prop("disabled",!1),v.addClass("va012-mandatory"),k.addClass("va012-mandatory"),di.find("*").prop("disabled",!0),gi.find("*").prop("disabled",!0),nr.find("*").prop("disabled",!1),tr.find("*").prop("disabled",!0),ir.find("*").prop("disabled",!0),wr.css("pointer-events","none"),divRow4Col1TrxAmt.hide(),br.hide(),li.hide(),di.hide(),gi.hide(),nr.hide(),tr.hide(),ir.hide()):w.val()=="C"&&(bi.show(),ki.show(),bi.find("*").prop("disabled",!1),ki.find("*").prop("disabled",!1),vt.find("*").prop("disabled",!0),yt.find("*").prop("disabled",!0),pt.find("*").prop("disabled",!0),wt.find("*").prop("disabled",!0),vt.hide(),yt.hide(),pt.hide(),wt.hide(),di.find("*").prop("disabled",!0),gi.find("*").prop("disabled",!0),nr.find("*").prop("disabled",!0),tr.find("*").prop("disabled",!0),ir.find("*").prop("disabled",!0),wr.css("pointer-events","none"),divRow4Col1TrxAmt.hide(),br.hide(),li.hide(),di.hide(),gi.hide(),nr.hide(),tr.hide(),ir.hide(),k.removeClass("va012-mandatory"),v.removeClass("va012-mandatory"));ot.prop("selectedIndex",0);v.attr("chargeid",0);v.val("");k.prop("selectedIndex",0);ai.text(VIS.Msg.getMsg("VA012_More"));e.setPaymentListHeight()});ct.on("change",function(){ct.val()=="CH"?(vt.show(),yt.show(),pt.show(),wt.show(),vt.find("*").prop("disabled",!1),yt.find("*").prop("disabled",!1),pt.find("*").prop("disabled",!1),wt.find("*").prop("disabled",!1),v.addClass("va012-mandatory"),k.addClass("va012-mandatory")):w.val()=="M"&&(yt.find("*").prop("disabled",!0),pt.find("*").prop("disabled",!0),wt.find("*").prop("disabled",!0),yt.hide(),pt.hide(),wt.hide(),wi.prop("selectedIndex",0),v.attr("chargeid",0),v.val(""),k.prop("selectedIndex",0),et.setValue(0),v.removeClass("va012-mandatory"),k.removeClass("va012-mandatory"));e.setPaymentListHeight()});ot.on("change",function(){ot.val()=="CB"?(or.find("*").prop("disabled",!1),sr.find("*").prop("disabled",!1)):(vi.prop("selectedIndex",0),yr.val(""),or.find("*").prop("disabled",!0),sr.find("*").prop("disabled",!0));ot.val()=="BB"?(_divCtrlCashLine.find("*").prop("disabled",!0),_divCtrlCashLine.hide(),vt.show(),yt.show(),pt.show(),wt.show(),vt.find("*").prop("disabled",!1),yt.find("*").prop("disabled",!1),pt.find("*").prop("disabled",!1),wt.find("*").prop("disabled",!1),v.addClass("va012-mandatory"),k.addClass("va012-mandatory")):w.val()=="C"&&(_divCtrlCashLine.show(),_divCtrlCashLine.find("*").prop("disabled",!1),vt.find("*").prop("disabled",!0),yt.find("*").prop("disabled",!0),pt.find("*").prop("disabled",!0),wt.find("*").prop("disabled",!0),vt.hide(),yt.hide(),pt.hide(),wt.hide());e.setPaymentListHeight()});k.on("change",function(){if(et.setValue(0),k.val()>0){var n=VIS.DB.executeScalar("SELECT RATE FROM C_TAX WHERE C_TAX_ID="+k.val());et.setValue(VIS.Utility.Util.getValueOfDecimal(i.getValue()-i.getValue()/(n/100+1)).toFixed(c));k.removeClass("va012-mandatory")}l.getControl().trigger("blur")});ai.on(VIS.Events.onTouchStartOrClick,function(){ai.attr("visiblestatus")=="0"?(ai.attr("visiblestatus","1"),ai.text(VIS.Msg.getMsg("VA012_Hide")),bi.show(),ki.show(),_divCtrlCashLine.show(),vt.show(),yt.show(),pt.show(),wt.show(),divRow4Col1TrxAmt.show(),br.show(),li.show(),di.show(),gi.show(),nr.show(),tr.show(),ir.show()):(ai.attr("visiblestatus","0"),ai.text(VIS.Msg.getMsg("VA012_More")),w.trigger("change"));e.setPaymentListHeight()});h.on("keyup",function(n){n.which==32&&(r.is(":focus")&&r.trigger("click"),u.is(":focus")&&u.trigger("click"),ai.is(":focus")&&ai.trigger("click"));n.which==13&&uu.is(":focus")&&uu.trigger("click")});uu.on(VIS.Events.onTouchStartOrClick,function(){var n=f.getFormData();if(n[0]._cmbBankAccount==null||n[0]._cmbBankAccount==""||n[0]._cmbBankAccount=="0"){VIS.ADialog.info("VA012_SelectBankAccountFirst",null,"","");return}if(n[0]._txtStatementNo==null||n[0]._txtStatementNo==""||n[0]._txtStatementNo=="0"){VIS.ADialog.info("VA012_PleaseEnterStatementNo",null,"","");return}if(n[0]._dtStatementDate==null||n[0]._dtStatementDate==""||n[0]._dtStatementDate=="0"){VIS.ADialog.info("VA012_PleaseEnterStatementDate",null,"","");return}if(n[0]._txtAmount==null||n[0]._txtAmount==""||n[0]._txtAmount=="0"||n[0]._txtAmount=="0.00"){VIS.ADialog.info("VA012_PleaseEnterAmount",null,"","");return}if(!(n[0]._ctrlInvoice==null||n[0]._ctrlInvoice==""||n[0]._ctrlInvoice=="0")&&!(n[0]._ctrlBusinessPartner==null||n[0]._ctrlBusinessPartner==""||n[0]._ctrlBusinessPartner=="0")&&(n[0]._ctrlPayment==null||n[0]._ctrlPayment==""||n[0]._ctrlPayment=="0")&&(n[0]._scheduleList==null||n[0]._scheduleList=="")){VIS.ADialog.info("VA012_PleaseSelectPaySchedule",null,"","");return}if(!(n[0]._ctrlBusinessPartner==null||n[0]._ctrlBusinessPartner==""||n[0]._ctrlBusinessPartner=="0")&&(n[0]._ctrlInvoice==null||n[0]._ctrlInvoice==""||n[0]._ctrlInvoice=="0")&&(n[0]._ctrlPayment==null||n[0]._ctrlPayment==""||n[0]._ctrlPayment=="0")&&(n[0]._scheduleList==null||n[0]._scheduleList=="")&&(n[0]._ctrlOrder==null||n[0]._ctrlOrder==""||n[0]._ctrlOrder=="0")&&(n[0]._cmbCharge==null||n[0]._cmbCharge==""||n[0]._cmbCharge=="0")){VIS.ADialog.info("VA012_PleaseSelectAnyOne",null,"","");return}if(n[0]._cmbVoucherMatch=="C")if(n[0]._cmbContraType=="BB"){if(n[0]._cmbCharge==null||n[0]._cmbCharge==""||n[0]._cmbCharge=="0"){VIS.ADialog.info("VA012_PleaseSelectCharge",null,"","");v.addClass("va012-mandatory");return}if(n[0]._cmbTaxRate==null||n[0]._cmbTaxRate==""||n[0]._cmbTaxRate=="0"){VIS.ADialog.info("VA012_PleaseSelectTaxRate",null,"","");k.addClass("va012-mandatory");return}}else if(n[0]._cmbContraType=="CB"){if(n[0]._ctrlCashLine==null||n[0]._ctrlCashLine==""||n[0]._ctrlCashLine=="0"){VIS.ADialog.info("VA012_PleaseSelectCashJournalLine",null,"","");return}}else{VIS.ADialog.info("VA012_PleaseSelectContraType",null,"","");return}if(n[0]._cmbVoucherMatch=="V"){if(n[0]._cmbCharge==null||n[0]._cmbCharge==""||n[0]._cmbCharge=="0"){VIS.ADialog.info("VA012_PleaseSelectCharge",null,"","");v.addClass("va012-mandatory");return}if(n[0]._cmbTaxRate==null||n[0]._cmbTaxRate==""||n[0]._cmbTaxRate=="0"){VIS.ADialog.info("VA012_PleaseSelectTaxRate",null,"","");k.addClass("va012-mandatory");return}}if(parseFloat(n[0]._txtDifference)!=0&&n[0]._cmbVoucherMatch=="M"&&(n[0]._cmbDifferenceType==null||n[0]._cmbDifferenceType==""||n[0]._cmbDifferenceType=="0")){VIS.ADialog.info("VA012_PleaseSelectDifferenceType",null,"","");return}ht(o,!0,"absolute");f.insertNewRecord(n,f.afterInsertion)});at.on("keypress",function(){ur.val("1");hi.val("10")});at.on("change",function(){at.val()==""?at.addClass("va012-mandatory"):at.removeClass("va012-mandatory")});hi.on("keypress",function(n){if(n.which!=8&&n.which!=0&&(n.which<48||n.which>57))return!1});ur.on("keypress",function(n){if(n.which!=8&&n.which!=0&&(n.which<48||n.which>57))return!1;hi.val("10")});sf.on(VIS.Events.onTouchStartOrClick,function(){f.scheduleRefresh();f.prepayRefresh();f.refreshForm();(at.val()==""||at.val()==null)&&at.val("0");e.getMaxStatement("BT");h.attr("data-uid",0);ur.val("1");hi.val("10")});et.getControl().on("change",function(){et.getValue()==0||et.getValue()==null?et.setValue(0):et.setValue(VIS.Utility.Util.getValueOfDecimal(et.getValue().toFixed(c)))});l.getControl().on("blur",function(){if(l.getValue()==0?(l.setValue(0),l.getControl().addClass("va012-mandatory")):(l.setValue(VIS.Utility.Util.getValueOfDecimal(l.getValue().toFixed(c))),l.getControl().removeClass("va012-mandatory")),p.getControl().attr("vchangable")=="Y"&&(p.setValue(0),li.find("*").prop("disabled",!0)),w.val()=="M"&&(p.getControl().attr("vchangable")=="Y"&&(p.setValue(VIS.Utility.Util.getValueOfDecimal((l.getValue()-i.getValue()).toFixed(c))),p.getValue()!=0&&(p.getControl().removeClass("va012-mandatory"),li.find("*").prop("disabled",!1))),k.val()>0&&p.getValue()!=0)){p.getControl().removeClass("va012-mandatory");var n=VIS.DB.executeScalar("SELECT RATE FROM C_TAX WHERE C_TAX_ID="+k.val());et.setValue(VIS.Utility.Util.getValueOfDecimal((p.getValue()-p.getValue()/(n/100+1)).toFixed(c)))}});i.getControl().on("blur",function(){if((i.getValue()==""||i.getValue()==0||i.getValue()==null)&&(i.setValue(0),i.getControl().addClass("va012-mandatory")),u.attr("v_active")=="1"&&i.getValue()>0&&i.setValue(-VIS.Utility.Util.getValueOfDecimal(i.getValue().toFixed(c))),r.attr("v_active")=="1"&&i.getValue()<0&&i.setValue(-1*VIS.Utility.Util.getValueOfDecimal(i.getValue().toFixed(c))),i.getValue()<0?(u.removeClass("va012-inactive"),u.addClass("va012-active"),u.attr("v_active","1"),r.removeClass("va012-active"),r.addClass("va012-inactive"),r.attr("v_active","0"),i.getControl().addClass("va012-mandatory")):i.getValue()>0&&(r.removeClass("va012-inactive"),r.addClass("va012-active"),r.attr("v_active","1"),u.removeClass("va012-active"),u.addClass("va012-inactive"),u.attr("v_active","0"),i.getControl().removeClass("va012-mandatory")),k.val()>0){var n=VIS.DB.executeScalar("SELECT RATE FROM C_TAX WHERE C_TAX_ID="+k.val());et.setValue(VIS.Utility.Util.getValueOfDecimal((i.getValue()-i.getValue()/(n/100+1)).toFixed(c)))}l.getControl().trigger("blur")});wu.hover(function(){$tooltip=t('<div  class="va012-div-tooltip"><h4>'+VIS.Msg.getMsg("VA012_Information")+"<\/h4><p>"+VIS.Msg.getMsg("VA012_InformationText")+"<\/p><\/div>");o.append($tooltip);t(".va012-div-tooltip").show()},function(){o.find(".va012-div-tooltip").remove()});ft.on("change",function(){var r,u,n,t;if(ft.val()=="")ft.addClass("va012-mandatory");else if(ft.removeClass("va012-mandatory"),r=0,w.val()=="M")if(ci.val()!=0&&(g.getValue()==null||g.getValue()==0)){if(tt.length!=0){for(u="IS",n=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"BankStatement/GetConvtAmount",{recordID:tt.join(),bnkAct_Id:s.val(),transcType:u,stmtDate:ft.val()}),t=0;t<n.length;t++){if(n.length==0||n[t].DueAmount==0){i.setValue();l.setValue();p.setValue();VIS.ADialog.info("VA012_ConversionRateNotFound",null,"","");return}r+=n[t].DueAmount}if(r!=0)i.setValue(r),l.setValue(r);else{i.setValue();l.setValue();p.setValue();VIS.ADialog.info("VA012_ConversionRateNotFound",null,"","");return}}}else if((ci.val()==null||ci.val()==0)&&g.getValue()!=null&&g.getValue()!=0){for(u="PY",n=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"BankStatement/GetConvtAmount",{recordID:g.getValue(),bnkAct_Id:s.val(),transcType:u,stmtDate:ft.val()}),t=0;t<n.length;t++){if(n.length==0||n[t].DueAmount==0){i.setValue();l.setValue();VIS.ADialog.info("VA012_ConversionRateNotFound",null,"","");return}r+=n[t].DueAmount}if(r!=0)i.setValue(r),l.setValue(r),p.setValue();else{i.setValue();l.setValue();p.setValue();VIS.ADialog.info("VA012_ConversionRateNotFound",null,"","");return}}});wu.mousemove(function(n){t(".va012-div-tooltip").css("top",n.pageY-50).css("left",n.pageX)});r.on(VIS.Events.onTouchStartOrClick,function(){i.getValue()<0&&i.setValue(VIS.Utility.Util.getValueOfDecimal(i.getValue().toFixed(c))*-1);r.removeClass("va012-inactive");r.addClass("va012-active");r.attr("v_active","1");u.removeClass("va012-active");u.addClass("va012-inactive");u.attr("v_active","0");i.getControl().blur()});u.on(VIS.Events.onTouchStartOrClick,function(){i.getValue()>0&&i.setValue(VIS.Utility.Util.getValueOfDecimal(i.getValue().toFixed(c))*-1);u.removeClass("va012-inactive");u.addClass("va012-active");u.attr("v_active","1");r.removeClass("va012-active");r.addClass("va012-inactive");r.attr("v_active","0");i.getControl().blur()})},getNewRecordDesign:function(){},getNewRecordControls:function(){at=h.find("#VA012_txtStatementNo_"+$self.windowNo);sf=h.find("#VA012_btnStatementNo_"+$self.windowNo);ur=h.find("#VA012_txtStatementPage_"+$self.windowNo);hi=h.find("#VA012_txtStatementLine_"+$self.windowNo);ft=h.find("#VA012_dtStatementDate_"+$self.windowNo);yi=h.find("#VA012_cmbPaymentMethod_"+$self.windowNo);ot=h.find("#VA012_cmbContraType_"+$self.windowNo);vi=h.find("#VA012_cmbCashBook_"+$self.windowNo);pi=h.find("#VA012_cmbTransferType_"+$self.windowNo);yr=h.find("#VA012_txtCheckNo_"+$self.windowNo);w=h.find("#VA012_cmbVoucherMatch_"+$self.windowNo);i.getControl().addClass("va012-mandatory");l.getControl().addClass("va012-mandatory");p.getControl().addClass("va012-mandatory");ct=h.find("#VA012_cmbDifferenceType_"+$self.windowNo);fr=h.find("#VA012_txtVoucherNo_"+$self.windowNo);gr=h.find("#VA012_txtDescription_"+$self.windowNo);wi=h.find("#VA012_cmbCharge_"+$self.windowNo);v=h.find("#VA012_txtCharge_"+$self.windowNo);k=h.find("#VA012_cmbTaxRate_"+$self.windowNo);pr=h.find("#VA012_ctrlCashLine_"+$self.windowNo);er=h.find("#VA012_ctrlPayment_"+$self.windowNo);nu=h.find("#VA012_ctrlOrder_"+$self.windowNo);tu=h.find("#VA012_ctrlInvoice_"+$self.windowNo);iu=h.find("#VA012_ctrlBusinessPartner_"+$self.windowNo);ru=h.find("#VA012_chkUseNextTime_"+$self.windowNo);uu=h.find("#VA012_btnSave_"+$self.windowNo);wr=h.find("#VA012_btnPaymentSchedule_"+$self.windowNo);hf=h.find("#VA012_btnPrepay_"+$self.windowNo);ci=h.find("#VA012_txtPaymentSchedule_"+$self.windowNo);pu=h.find("#VA012_txtPrepayOrder_"+$self.windowNo);it=yu.find("#VA012_btnNewRecord_"+$self.windowNo);cf=yu.find("#VA012_btnUndo_"+$self.windowNo);lf=o.find("#VA012_btnDelete_"+$self.windowNo);wu=h.find("#VA012_btnAmount_"+$self.windowNo);r=h.find("#VA012_btnIn_"+$self.windowNo);u=h.find("#VA012_btnOut_"+$self.windowNo)},loadPaymentMethod:function(){function t(t){if(yi.html(""),yi.append("<option value=0 ><\/option>"),t!=null)for(var i=0;i<t.tables[0].rows.length;i++)yi.append("<option value="+VIS.Utility.Util.getValueOfInt(t.tables[0].rows[i].cells.va009_paymentmethod_id)+">"+VIS.Utility.encodeText(t.tables[0].rows[i].cells.va009_name)+"<\/option>");t.dispose();t=null;n=null;yi.prop("selectedIndex",0)}var n="SELECT VA009_NAME,VA009_PAYMENTMETHOD_ID FROM VA009_PAYMENTMETHOD WHERE ISACTIVE='Y'  AND AD_CLIENT_ID="+VIS.Env.getCtx().getAD_Client_ID()+" AND AD_ORG_ID="+VIS.Env.getCtx().getAD_Org_ID(),i=VIS.DB.executeDataSet(n.toString(),null,t)},loadCurrency:function(){ui=VIS.DB.executeScalar("SELECT C_CURRENCY_ID FROM C_BANKACCOUNT WHERE C_BANKACCOUNT_ID="+s.val());c=VIS.DB.executeScalar("SELECT STDPRECISION FROM C_CURRENCY WHERE C_CURRENCY_ID="+ui)},loadCashBook:function(){function t(t){if(vi.html(""),vi.append("<option value=0 ><\/option>"),t!=null)for(var i=0;i<t.tables[0].rows.length;i++)vi.append("<option value="+VIS.Utility.Util.getValueOfInt(t.tables[0].rows[i].cells.c_cashbook_id)+">"+VIS.Utility.encodeText(t.tables[0].rows[i].cells.name)+"<\/option>");t.dispose();t=null;n=null;vi.prop("selectedIndex",0)}var n="SELECT NAME,C_CashBook_ID FROM C_CashBook WHERE ISACTIVE='Y'  AND AD_CLIENT_ID="+VIS.Env.getCtx().getAD_Client_ID()+" AND AD_ORG_ID="+VIS.Env.getCtx().getAD_Org_ID(),i=VIS.DB.executeDataSet(n.toString(),null,t)},loadContraType:function(){ot.html("");ot.append("<option value=0 ><\/option>");ot.append("<option value='BB' >"+VIS.Msg.getMsg("VA012_BankToBank")+"<\/option>");ot.append("<option value='CB' >"+VIS.Msg.getMsg("VA012_CashToBank")+"<\/option>");ot.prop("selectedIndex",0)},loadTransferType:function(){pi.html("");pi.append("<option value=0 ><\/option>");pi.append("<option value='CH' >"+VIS.Msg.getMsg("VA012_Cash")+"<\/option>");pi.append("<option value='CK' >"+VIS.Msg.getMsg("VA012_Check")+"<\/option>");pi.prop("selectedIndex",0)},loadVoucherMatch:function(){w.html("");w.append("<option value='M' >"+VIS.Msg.getMsg("VA012_Payment")+"<\/option>");w.append("<option value='V' >"+VIS.Msg.getMsg("VA012_Voucher")+"<\/option>");w.append("<option value='C' >"+VIS.Msg.getMsg("VA012_Contra")+"<\/option>");w.prop("selectedIndex",0)},loadDifferenceType:function(){ct.html("");ct.append("<option value=0 ><\/option>");ct.append("<option value='OU' >"+VIS.Msg.getMsg("VA012_OverUnderPayment")+"<\/option>");ct.append("<option value='DA' >"+VIS.Msg.getMsg("VA012_DiscountAmount")+"<\/option>");ct.append("<option value='WO' >"+VIS.Msg.getMsg("VA012_WriteoffAmount")+"<\/option>");ct.append("<option value='CH' >"+VIS.Msg.getMsg("VA012_Charge")+"<\/option>");ct.prop("selectedIndex",0)},loadCharge:function(){function t(t){if(wi.html(""),wi.append("<option value=0 ><\/option>"),t!=null)for(var i=0;i<t.tables[0].rows.length;i++)wi.append("<option value="+VIS.Utility.Util.getValueOfInt(t.tables[0].rows[i].cells.c_charge_id)+">"+VIS.Utility.encodeText(t.tables[0].rows[i].cells.name)+"<\/option>");t.dispose();t=null;n=null;wi.prop("selectedIndex",0)}var n="SELECT NAME,C_CHARGE_ID FROM C_CHARGE WHERE ISACTIVE='Y' AND AD_CLIENT_ID="+VIS.Env.getCtx().getAD_Client_ID()+" AND AD_ORG_ID="+VIS.Env.getCtx().getAD_Org_ID(),i=VIS.DB.executeDataSet(n.toString(),null,t)},loadTaxRate:function(){function i(t){if(k.html(""),k.append("<option value=0 ><\/option>"),t!=null)for(var i=0;i<t.tables[0].rows.length;i++)k.append("<option value="+VIS.Utility.Util.getValueOfInt(t.tables[0].rows[i].cells.c_tax_id)+">"+VIS.Utility.encodeText(t.tables[0].rows[i].cells.name)+"<\/option>");t.dispose();t=null;n=null;k.prop("selectedIndex",0)}var n="SELECT Name,C_Tax_ID FROM C_Tax WHERE IsActive='Y'AND IsSurcharge='N' AND NVL(Parent_Tax_ID, 0)=0",t;n=VIS.MRole.getDefault().addAccessSQL(n,"C_Tax",!0,!1);t=VIS.DB.executeDataSet(n.toString(),null,i)},loadPayment:function(){er!=undefined&&er!=null&&er.empty();var n=s.val()!=null?"DocStatus IN ('CO','CL') AND C_BankAccount_ID = "+s.val():"DocStatus IN ('CO','CL')";wf=VIS.MLookupFactory.get(VIS.Env.getCtx(),$self.windowNo,5043,VIS.DisplayType.Search,"C_Payment_ID",0,!1,n);g=new VIS.Controls.VTextBoxButton("C_Payment_ID",!1,!1,!0,VIS.DisplayType.Search,wf);g.getControl().addClass("va012-input-size-2");g.getControl().attr("tabindex","10");er.append(g.getControl());er.append(g.getBtn(0));er.append(g.getBtn(1));g.fireValueChanged=function(){cr=0;cr=g.value;g.value||f.refreshForm();ti||si||g.value&&(e.checkPaymentCondition(cr,0,i.getValue())?e.setInvoiceAndBPartner(cr,"PY"):g.setValue());si=!1};si=!1},loadOrder:function(){ie=VIS.MLookupFactory.get(VIS.Env.getCtx(),$self.windowNo,5043,VIS.DisplayType.Search,"C_Order_ID",0,!1,"C_ORDER_ID IN (SELECT ORD.C_ORDER_ID  FROM C_ORDER ORD  LEFT JOIN C_DOCTYPE DT  ON ORD.C_DOCTYPETARGET_ID=DT.C_DOCTYPE_ID  INNER JOIN VA009_PAYMENTMETHOD PM  ON (PM.VA009_PAYMENTMETHOD_ID =ORD.VA009_PAYMENTMETHOD_ID )  WHERE DT.DOCSUBTYPESO         ='PR'   AND ORD.DOCSTATUS             ='WP'   AND ORD.ISACTIVE              ='Y'   AND PM.VA009_PAYMENTBASETYPE! ='B')");kt=new VIS.Controls.VTextBoxButton("C_Order_ID",!1,!1,!0,VIS.DisplayType.Search,ie);kt.getControl().addClass("va012-input-size-2");kt.getControl().attr("tabindex","13");nu.append(kt.getControl());nu.append(kt.getBtn(0));nu.append(kt.getBtn(1));kt.fireValueChanged=function(){kr=0;kr=kt.value;kt.value&&(ti||(e.checkPrepayCondition(kt.value,0,null,i.getValue())?e.setInvoiceAndBPartner(kr,"PO"):kt.setValue()))}},loadCashLine:function(){var n=" C_CASHLINE_ID IN (SELECT CSL.C_CASHLINE_ID  FROM C_CASH CS  INNER JOIN C_CASHLINE CSL  ON CS.C_CASH_ID=CSL.C_CASH_ID  INNER JOIN c_charge chrg  ON chrg.c_charge_id        =csl.c_charge_id  WHERE CS.ISACTIVE          ='Y'  AND CSL.CashType           ='C'  AND chrg.dtd001_chargetype ='CON'  AND CS.DOCSTATUS          IN ('CO','CL')  AND CSL.VA012_ISRECONCILED ='N'  AND CSL.C_BankAccount_ID ="+(s.val()==null?0:s.val())+" )";pr.html("");pf=VIS.MLookupFactory.get(VIS.Env.getCtx(),$self.windowNo,1008317,VIS.DisplayType.Search,"C_CashLine_ID",0,!1,n);dt=new VIS.Controls.VTextBoxButton("C_CashLine_ID",!1,!1,!0,VIS.DisplayType.Search,pf);dt.getControl().addClass("va012-input-size-2");dt.getControl().attr("tabindex","10");pr.append(dt.getControl());pr.append(dt.getBtn(0));pr.append(dt.getBtn(1));dt.fireValueChanged=function(){ku=0;ku=dt.value;dt.value&&(ti||si||e.checkContraCondition(dt.value,0,i.getValue())||dt.setValue(),si=!1);si=!1}},loadBusinessPartner:function(){du=VIS.MLookupFactory.get(VIS.Env.getCtx(),$self.windowNo,2893,VIS.DisplayType.Search,"C_BPartner_ID",0,!1,null);y=new VIS.Controls.VTextBoxButton("C_BPartner_ID",!1,!1,!0,VIS.DisplayType.Search,du);y.getControl().addClass("va012-input-size-2");y.getControl().attr("tabindex","12");iu.append(y.getControl());iu.append(y.getBtn(0));iu.append(y.getBtn(1));y.fireValueChanged=function(){fu=0;fu=y.value}},loadInvoice:function(){bf=VIS.MLookupFactory.get(VIS.Env.getCtx(),$self.windowNo,3484,VIS.DisplayType.Search,"C_Invoice_ID",0,!1,"DocStatus IN ('CO','CL')");lt=new VIS.Controls.VTextBoxButton("C_Invoice_ID",!1,!1,!0,VIS.DisplayType.Search,bf);lt.getControl().addClass("va012-input-size-2");lt.getControl().attr("tabindex","11");tu.append(lt.getControl());tu.append(lt.getBtn(0));tu.append(lt.getBtn(1));lt.fireValueChanged=function(){lr=0;lr=lt.value;lt.value&&(e.checkInvoiceCondition(lr,i.getValue())?e.setBPartner(lr):lt.setValue())}},getFormData:function(){var n={},t=[];return n._bankStatementLineID=h.attr("data-uid"),n._txtStatementNo=at.val(),n._txtStatementPage=ur.val(),n._txtStatementLine=hi.val(),n._dtStatementDate=ft.val(),n._cmbPaymentMethod=yi.val(),n._cmbCurrency=ui,n._cmbVoucherMatch=w.val(),n._txtDescription=VIS.Utility.encodeText(gr.val()),n._txtVoucherNo=VIS.Utility.encodeText(fr.val()),n._cmbCharge=v.attr("chargeid"),n._cmbTaxRate=k.val(),n._txtTaxAmount=et.getValue(),n._ctrlPayment=cr,n._ctrlOrder=kr,n._ctrlCashLine=ku,n._ctrlInvoice=lr,n._ctrlBusinessPartner=fu,n._chkUseNextTime=ru.is(":checked"),n._cmbBank=fi.val(),n._cmbBankAccount=s.val(),n._cmbBankAccountClasses=su.val(),n._cmbTransactionType=b.val(),n._scheduleList=tt.toString(),n._cmbContraType=ot.val(),n._cmbCashBook=vi.val(),n._cmbTransferType=pi.val(),n._txtCheckNo=yr.val(),n._cmbDifferenceType=ct.val(),ct.val()=="CH"?(n._txtAmount=l.getValue(),n._txtTrxAmt=i.getValue()):(n._txtAmount=i.getValue(),n._txtTrxAmt=l.getValue()),n._txtDifference=p.getValue(),t.push(n),t},insertNewRecord:function(n,i){t.ajax({type:"POST",url:VIS.Application.contextUrl+"VA012/BankStatement/InsertData",contentType:"application/json; charset=utf-8",data:JSON.stringify({_formData:n}),success:function(n){i(n)},error:function(n){VIS.ADialog.info(n,null,"","")}})},afterInsertion:function(n){if(n!=null&&n!=""){var i=t.parseJSON(n);i=="Success"?(hi.val(parseInt(hi.val())+10),ht(o,!1,"absolute"),VIS.ADialog.info("VA012_RecordSaved",null,"",""),st=[],nt.html(""),ii=1,a.loadStatement(ni),gt.html(""),f.scheduleRefresh(),f.prepayRefresh(),ei=1,storepaymentdata=[],e.loadPayments(s.val(),ut.val(),b.val(),rt.val()),f.scheduleRefresh(),f.prepayRefresh(),f.refreshForm()):(ht(o,!1,"absolute"),VIS.ADialog.info(i,null,"",""))}},refreshForm:function(){h.attr("data-uid",0);e.getMaxStatement("LO");var n=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"BankStatement/GetStatementDate",{bankAcct:s.val()});n!=""&&n!=null?ft.val(Globalize.format(new Date(n),"yyyy-MM-dd")):ft.val(re);yi.prop("selectedIndex",0);w.prop("selectedIndex",0);w.trigger("change");i.setValue(0);l.setValue(0);p.setValue(0);p.getControl().attr("vchangable","Y");ct.prop("selectedIndex",0);gr.val("");fr.val("");wi.prop("selectedIndex",0);v.attr("chargeid",0);v.val("");k.prop("selectedIndex",0);et.setValue(0);ru.attr("checked",!1);g.setValue();kt.setValue();dt.setValue();y.setValue();lt.setValue();fu=0;cr=0;kr=0;lr=0;r.trigger("click");f.loadCurrency();ot.prop("selectedIndex",0);vi.prop("selectedIndex",0);pi.prop("selectedIndex",0);yr.val("")},scheduleRefresh:function(){tt=[];ri=[];d=[];ci.val("")},prepayRefresh:function(){rr=[];hr=[];pu.val("")},newRecordDispose:function(){h=null;yu=null;at=null;sf=null;ur=null;hi=null;ft=null;yi=null;ot=null;vi=null;pi=null;yr=null;ui=null;w=null;i=null;p=null;ct=null;wu=null;r=null;u=null;gr=null;fr=null;wi=null;v=null;k=null;et=null;pr=null;nu=null;er=null;tu=null;iu=null;ru=null;uu=null;wr=null;hf=null;ci=null;pu=null;it=null;cf=null;lf=null;ai=null;te=null;wf=null;kt=null;kr=null;g=null;he=null;cr=null;dt=null;pf=null;ku=null;du=null;y=null;fu=null;bf=null;lt=null;lr=null;re=null;gu=null}};t(window).resize(function(){e.setPaymentListHeight();a.setStatementListHeight();lu.height(t("#VA012_mainContainer_"+$self.windowNo).height())});this.getRoot=function(){return o};this.setSize=function(){lu.height(t("#VA012_mainContainer_"+$self.windowNo).height())};this.disposeComponents=function(){$self=null;o=null;fi=null;s=null;su=null;rt=null;gf=null;ut=null;b=null;tf=null;rf=null;nt=null;gt=null;ni="";ar=null;vr=null;oe=null;se=null;bi=null;or=null;_divCtrlCashLine=null;ki=null;sr=null;vt=null;ne=null;divRow4Col1TrxAmt=null;br=null;li=null;yt=null;af=null;pt=null;wt=null;di=null;gi=null;nr=null;tr=null;ir=null;bt=null;vf=null;uf=null;ff=null;ef=null;cu=null;lu=null;dr=null;kf=null;st=[];tt=[];ri=[];rr=[];hr=[];f.newRecordDispose()}}i.prototype.dispose=function(){this.disposeComponents();this.frame&&this.frame.dispose();this.frame=null};i.prototype.init=function(n,t){this.windowNo=n;this.frame=t;this.Initialize();this.frame.getContentGrid().append(this.getRoot());this.setSize()};n.AForms=n.AForms||{};n.AForms.bankStatement=i}(VA012,jQuery);VA012=window.VA012||{},function(n,t){n.UploadExcel=function(i,r,u){function ut(n){for(u.children().remove(),j=0;j<n.ExcelCol.length;j++)j==1?u.append("<li index="+j+" style='border:none;float:none' >"+n.ExcelCol[j]+"<\/li>"):u.append("<li index="+j+" >"+n.ExcelCol[j]+"<\/li>")}var k=null,f=[],l=[],a=0,o=0,c=Date.now().toString(),s=1048576,v=0,h=0,p=[],e=null,nt=i,ft=t(window).width(),et=t(window).height(),c=Date.now().toString(),ot=r;savedFileName="";var d=t("<div id='progress_bar' class='vis-ui-progress-bar vis-ui-container' style='top:40%;width: 40%;left: 32%;position:absolute;z-index:99999;'>"),w=null,b=null;this.isWait=!1;self=this;var tt=function(){var n=null,i=0,t;for(t in f)i=parseInt(f[t].size/s),e.size%s>0&&i++,v+=i,n={},n.Name=f[t].name,n.Size=f[t].size,p.push(n);g()},g=function(){var t;if(f==null||f.length==0){y(!1);return}if(!(o>=f.length)){var n=new XMLHttpRequest,i=new FormData,r=f[o].name.substring(0,f[o].name.lastIndexOf("."))+c+f[o].name.substring(f[o].name.lastIndexOf("."));savedFileName=r;i.append("file",f[o].slice(h*s,h*s+Number(s)));n.open("POST",VIS.Application.contextUrl+"VA012/UploadExcel/SaveFileinTemp?fileName="+r+"&folderKey="+c+"&orgFileName="+f[o].name,!1);n.send(i);k=n.responseText;a++;h++;t=parseInt(f[o].size/s);f[o].size%s>0&&t++;h==t&&(o++,h=0);a<=v&&rt(parseInt(a/v*80));window.setTimeout(function(){g()},2)}},it=function(n){for(var t=[],i,w,r,b,u=0;u<n.files.length;u++){if(e=n.files[u],e==undefined)return;if(e.size<=0)return f=[],l=[],a=0,o=0,c=null,s=null,v=0,h=0,p=[],e=null,VIS.ADialog.info("VADMS_FileSizeShouldGreaterThan0KB"),y(!1),!1;if(e.name.indexOf("&")>-1||e.name.indexOf("?")>-1||e.name.indexOf("#")>-1||e.name.indexOf("/")>-1||e.name.indexOf("\\")>-1){t.push(e.name);continue}for(i in f)if(e.name==f[i].name){window.setTimeout(function(){y(!1);VIS.ADialog.info("fileAlreadyAttached")},20);return}if(l!=null)for(i in l)if(e.name==l[i].Name&&!l[i].IsDeleted){window.setTimeout(function(){y(!1);VIS.ADialog.info("fileAlreadyAttached")},20);return}w={};w.Name=e.name;w.Size=e.size;f.push(e)}if(t.length>0){r="";for(b in t)r+=t[b].toString()+"\n";r+=t.length==1?"File has":"Files have";r+=" invalid name. Please change the file name and try again.";y(!1);VIS.ADialog.info("",!0,r)}},y=function(n){if(t("body").find("#progressbar").remove(),n){w=t("<div class='vis-ui-progress' style='width: 0%; display: block;position:absolute;height: 35px;'>");b=t("<span class='vis-ui-label'  style='position:absolute;left: 60%;top: 4px;'>").append("0%");w.append(b);d.append(w);var i=t("<div id='progressbar' style='z-index: 999999;' class='vadms-Busy-Progress'><\/div>");i.append(d);i.appendTo("<body>")}else t("body").find("progressbar").remove()},rt=function(n){w.css("width",n+"%");b.empty();b.append(n+"%")};return this.getFolderKey=c,this.getSavedFileName=savedFileName,this.GetUploadedExcelColumns=function(){var t,u,i;if(o>=f.length)return t=[],u=VIS.Application.contextUrl+"VA012/UploadExcel/SaveAttachmentEntries",t.push({Files:JSON.stringify(p)}),t.push({FolderKey:c}),t.push({FileName:savedFileName}),t.push({Mapping:r}),i=n.ControllerRequestAjaxParameter1(u,t,!1),r.ExcelCol=i.ExcelCol,r.FileName=i.FileName,ut(i),i},y(!0),it(i),tt(),k}}(VA012,jQuery);VA012=window.VA012||{},function(n){function t(){VIS.CalloutEngine.call(this,"VA012.VA012_Contra")}var r=VIS.Logging.Level,i=VIS.Utility.Util;VIS.Utility.inheritPrototype(t,VIS.CalloutEngine);t.prototype.SetContra=function(n,t,r,u,f){if(this.isCalloutActive())return"";if(this.setCalloutActive(!0),f==null)r.setValue("VA012_IsContra",!1);else{var e=i.getValueOfString(VIS.DB.executeScalar("SELECT DTD001_ChargeType FROM C_Charge WHERE  C_Charge_ID="+f.toString()));e=="CON"?r.setValue("VA012_IsContra",!0):r.setValue("VA012_IsContra",!1)}return this.setCalloutActive(!1),""};n.Model=n.Model||{};n.Model.VA012_Contra=t}(VA012,jQuery)
